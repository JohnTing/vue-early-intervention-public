var ic=Object.defineProperty,oc=Object.defineProperties;var ac=Object.getOwnPropertyDescriptors;var So=Object.getOwnPropertySymbols;var lc=Object.prototype.hasOwnProperty,uc=Object.prototype.propertyIsEnumerable;var Ao=(t,e,n)=>e in t?ic(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Be=(t,e)=>{for(var n in e||(e={}))lc.call(e,n)&&Ao(t,n,e[n]);if(So)for(var n of So(e))uc.call(e,n)&&Ao(t,n,e[n]);return t},Tt=(t,e)=>oc(t,ac(e));import{d as mt,r as me,o as cc,M as dc,a as J,c as se,b as E,F as Ge,e as ut,f as De,w as pr,g as ie,h as It,v as lr,t as Ne,i as ri,j as hc,k as Ba,u as Bt,n as fc,l as ms,m as bt,p as pc,q as mc}from"./index.31a62f88.js";const _c=E("div",{class:"modal-dialog"},[E("div",{class:"modal-content"},[E("div",{class:"modal-header"},[E("h4",{class:"modal-title"},"\u5831\u540D\u524D\u8ACB\u5BB6\u9577\u8A73\u95B1\u898F\u5B9A"),E("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})]),E("div",{class:"modal-body"},[E("ol",null,[E("li",null,"\u672C\u9580\u8A3A\u770B\u8A3A\u689D\u4EF6\u9700\u70BA\u300C\u591A\u9762\u5411\u767C\u5C55\u9072\u7DE9\u300D\uFF0C\u82E5\u70BA\u55AE\u4E00\u9762\u9805\u767C\u5C55\u9072\u7DE9\uFF0C\u8ACB\u76F4\u63A5\u639B\u55AE\u4E00\u79D1\u5225\u5C31\u8A3A\uFF0C\u8ACB\u52FF\u639B\u865F"),E("ul",null,[E("li",null,"\u55AE\u7D14\u52D5\u4F5C\u3001\u8A9E\u8A00\u554F\u984C\u2192\u8ACB\u639B\u5FA9\u5065\u79D1"),E("li",null,"\u8A8D\u77E5\u3001\u4EBA\u969B\u3001\u60C5\u7DD2\u3001\u5C08\u6CE8\u529B\u3001\u904E\u52D5\u7B49\u2192\u8ACB\u639B\u5152\u7AE5\u5FC3\u667A\u79D1"),E("li",null,"\u751F\u9577\u554F\u984C\uFF08\u8EAB\u9AD8\u3001\u9AD4\u91CD\u3001\u6027\u65E9\u719F\u7B49\uFF09\u2192\u8ACB\u639B\u907A\u50B3\u4EE3\u8B1D\u79D1")]),E("br"),E("li",null,"\u672C\u9580\u8A3A\u7684\u770B\u8A3A\u5E74\u9F61\u70BA\u300C\u5B78\u9F61\u524D\uFF08\u5165\u5C0F\u5B78\u524D\uFF09\u300D\uFF0C\u82E5\u60A8\u7684\u5152\u7AE5\u73FE\u76EE\u524D\u5DF2\u8B80\u5927\u73ED\uFF0C\u82E5\u9580\u8A3A\u53EF\u770B\u8A3A\u65E5\u671F\u5DF2\u8D85\u904E\u4E94\u6708\uFF0C\u5247\u4E0D\u7B26\u5408\u672C\u9662\u770B\u8A3A\u5E74\u9F61\uFF1B\u5EFA\u8B70\u60A8\u8F49\u81F3\u5B83\u9662\u639B\u865F\uFF0C\u6216\u55AE\u4E00\u79D1\u5225\u5C31\u8A3A\u3002"),E("br"),E("li",null,"\u76EE\u524D\u570B\u5065\u7F72\u5DF2\u63D0\u4F9B\u7CFB\u7D71\u53EF\u67E5\u8A62\u5152\u7AE5\u5728\u5404\u5BB6\u91AB\u9662\u5152\u7AE5\u767C\u5C55\u79D1\u662F\u5426\u6709\u5C31\u8A3A\u7D00\u9304\uFF0C\u56E0\u6B64\u82E5\u4E00\u5E74\u5167\u66FE\u7D93\u5C31\u8A3A\u6216\u5230\u671F\u65E5\u672A\u8005\uFF0C\u8ACB\u52FF\u639B\u865F\u3002"),E("br"),E("li",null,"\u7CFB\u7D71\u5A92\u5408\u5230\u7684\u5C31\u8A3A\u65E5\u671F\u70BA\u6700\u9069\u5C31\u8A3A\u65E5\u671F\uFF0C\u8ACB\u52FF\u8981\u6C42\u66F4\u52D5\u3002")])]),E("div",{class:"modal-footer"},[E("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onclick:"sessionStorage.setItem('isReadRegulations', 'true');"},"\u78BA\u8A8D")])])],-1),gc=[_c],yc=mt({__name:"ReadRegulations",setup(t){let e=me(),n=null;return cc(()=>{n=new dc(e.value,{}),sessionStorage.getItem("isReadRegulations")!=="true"&&n.show()}),(r,s)=>(J(),se("div",{class:"modal fade",id:"myModal",tabindex:"-1",ref_key:"myModalRef",ref:e},gc,512))}});var La=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function vc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var xa={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(La,function(){var n=1e3,r=6e4,s=36e5,i="millisecond",o="second",a="minute",u="hour",l="day",d="week",c="month",m="quarter",$="year",v="date",S="Invalid Date",w=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,I={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},D=function(Y,B,L){var X=String(Y);return!X||X.length>=B?Y:""+Array(B+1-X.length).join(L)+Y},O={s:D,z:function(Y){var B=-Y.utcOffset(),L=Math.abs(B),X=Math.floor(L/60),U=L%60;return(B<=0?"+":"-")+D(X,2,"0")+":"+D(U,2,"0")},m:function Y(B,L){if(B.date()<L.date())return-Y(L,B);var X=12*(L.year()-B.year())+(L.month()-B.month()),U=B.clone().add(X,c),ee=L-U<0,Z=B.clone().add(X+(ee?-1:1),c);return+(-(X+(L-U)/(ee?U-Z:Z-U))||0)},a:function(Y){return Y<0?Math.ceil(Y)||0:Math.floor(Y)},p:function(Y){return{M:c,y:$,w:d,d:l,D:v,h:u,m:a,s:o,ms:i,Q:m}[Y]||String(Y||"").toLowerCase().replace(/s$/,"")},u:function(Y){return Y===void 0}},j="en",A={};A[j]=I;var R=function(Y){return Y instanceof ge},M=function Y(B,L,X){var U;if(!B)return j;if(typeof B=="string"){var ee=B.toLowerCase();A[ee]&&(U=ee),L&&(A[ee]=L,U=ee);var Z=B.split("-");if(!U&&Z.length>1)return Y(Z[0])}else{var F=B.name;A[F]=B,U=F}return!X&&U&&(j=U),U||!X&&j},W=function(Y,B){if(R(Y))return Y.clone();var L=typeof B=="object"?B:{};return L.date=Y,L.args=arguments,new ge(L)},H=O;H.l=M,H.i=R,H.w=function(Y,B){return W(Y,{locale:B.$L,utc:B.$u,x:B.$x,$offset:B.$offset})};var ge=function(){function Y(L){this.$L=M(L.locale,null,!0),this.parse(L)}var B=Y.prototype;return B.parse=function(L){this.$d=function(X){var U=X.date,ee=X.utc;if(U===null)return new Date(NaN);if(H.u(U))return new Date;if(U instanceof Date)return new Date(U);if(typeof U=="string"&&!/Z$/i.test(U)){var Z=U.match(w);if(Z){var F=Z[2]-1||0,b=(Z[7]||"0").substring(0,3);return ee?new Date(Date.UTC(Z[1],F,Z[3]||1,Z[4]||0,Z[5]||0,Z[6]||0,b)):new Date(Z[1],F,Z[3]||1,Z[4]||0,Z[5]||0,Z[6]||0,b)}}return new Date(U)}(L),this.$x=L.x||{},this.init()},B.init=function(){var L=this.$d;this.$y=L.getFullYear(),this.$M=L.getMonth(),this.$D=L.getDate(),this.$W=L.getDay(),this.$H=L.getHours(),this.$m=L.getMinutes(),this.$s=L.getSeconds(),this.$ms=L.getMilliseconds()},B.$utils=function(){return H},B.isValid=function(){return this.$d.toString()!==S},B.isSame=function(L,X){var U=W(L);return this.startOf(X)<=U&&U<=this.endOf(X)},B.isAfter=function(L,X){return W(L)<this.startOf(X)},B.isBefore=function(L,X){return this.endOf(X)<W(L)},B.$g=function(L,X,U){return H.u(L)?this[X]:this.set(U,L)},B.unix=function(){return Math.floor(this.valueOf()/1e3)},B.valueOf=function(){return this.$d.getTime()},B.startOf=function(L,X){var U=this,ee=!!H.u(X)||X,Z=H.p(L),F=function(q,Q){var ne=H.w(U.$u?Date.UTC(U.$y,Q,q):new Date(U.$y,Q,q),U);return ee?ne:ne.endOf(l)},b=function(q,Q){return H.w(U.toDate()[q].apply(U.toDate("s"),(ee?[0,0,0,0]:[23,59,59,999]).slice(Q)),U)},k=this.$W,C=this.$M,h=this.$D,p="set"+(this.$u?"UTC":"");switch(Z){case $:return ee?F(1,0):F(31,11);case c:return ee?F(1,C):F(0,C+1);case d:var P=this.$locale().weekStart||0,x=(k<P?k+7:k)-P;return F(ee?h-x:h+(6-x),C);case l:case v:return b(p+"Hours",0);case u:return b(p+"Minutes",1);case a:return b(p+"Seconds",2);case o:return b(p+"Milliseconds",3);default:return this.clone()}},B.endOf=function(L){return this.startOf(L,!1)},B.$set=function(L,X){var U,ee=H.p(L),Z="set"+(this.$u?"UTC":""),F=(U={},U[l]=Z+"Date",U[v]=Z+"Date",U[c]=Z+"Month",U[$]=Z+"FullYear",U[u]=Z+"Hours",U[a]=Z+"Minutes",U[o]=Z+"Seconds",U[i]=Z+"Milliseconds",U)[ee],b=ee===l?this.$D+(X-this.$W):X;if(ee===c||ee===$){var k=this.clone().set(v,1);k.$d[F](b),k.init(),this.$d=k.set(v,Math.min(this.$D,k.daysInMonth())).$d}else F&&this.$d[F](b);return this.init(),this},B.set=function(L,X){return this.clone().$set(L,X)},B.get=function(L){return this[H.p(L)]()},B.add=function(L,X){var U,ee=this;L=Number(L);var Z=H.p(X),F=function(C){var h=W(ee);return H.w(h.date(h.date()+Math.round(C*L)),ee)};if(Z===c)return this.set(c,this.$M+L);if(Z===$)return this.set($,this.$y+L);if(Z===l)return F(1);if(Z===d)return F(7);var b=(U={},U[a]=r,U[u]=s,U[o]=n,U)[Z]||1,k=this.$d.getTime()+L*b;return H.w(k,this)},B.subtract=function(L,X){return this.add(-1*L,X)},B.format=function(L){var X=this,U=this.$locale();if(!this.isValid())return U.invalidDate||S;var ee=L||"YYYY-MM-DDTHH:mm:ssZ",Z=H.z(this),F=this.$H,b=this.$m,k=this.$M,C=U.weekdays,h=U.months,p=function(Q,ne,ve,ze){return Q&&(Q[ne]||Q(X,ee))||ve[ne].slice(0,ze)},P=function(Q){return H.s(F%12||12,Q,"0")},x=U.meridiem||function(Q,ne,ve){var ze=Q<12?"AM":"PM";return ve?ze.toLowerCase():ze},q={YY:String(this.$y).slice(-2),YYYY:this.$y,M:k+1,MM:H.s(k+1,2,"0"),MMM:p(U.monthsShort,k,h,3),MMMM:p(h,k),D:this.$D,DD:H.s(this.$D,2,"0"),d:String(this.$W),dd:p(U.weekdaysMin,this.$W,C,2),ddd:p(U.weekdaysShort,this.$W,C,3),dddd:C[this.$W],H:String(F),HH:H.s(F,2,"0"),h:P(1),hh:P(2),a:x(F,b,!0),A:x(F,b,!1),m:String(b),mm:H.s(b,2,"0"),s:String(this.$s),ss:H.s(this.$s,2,"0"),SSS:H.s(this.$ms,3,"0"),Z};return ee.replace(y,function(Q,ne){return ne||q[Q]||Z.replace(":","")})},B.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},B.diff=function(L,X,U){var ee,Z=H.p(X),F=W(L),b=(F.utcOffset()-this.utcOffset())*r,k=this-F,C=H.m(this,F);return C=(ee={},ee[$]=C/12,ee[c]=C,ee[m]=C/3,ee[d]=(k-b)/6048e5,ee[l]=(k-b)/864e5,ee[u]=k/s,ee[a]=k/r,ee[o]=k/n,ee)[Z]||k,U?C:H.a(C)},B.daysInMonth=function(){return this.endOf(c).$D},B.$locale=function(){return A[this.$L]},B.locale=function(L,X){if(!L)return this.$L;var U=this.clone(),ee=M(L,X,!0);return ee&&(U.$L=ee),U},B.clone=function(){return H.w(this.$d,this)},B.toDate=function(){return new Date(this.valueOf())},B.toJSON=function(){return this.isValid()?this.toISOString():null},B.toISOString=function(){return this.$d.toISOString()},B.toString=function(){return this.$d.toUTCString()},Y}(),le=ge.prototype;return W.prototype=le,[["$ms",i],["$s",o],["$m",a],["$H",u],["$W",l],["$M",c],["$y",$],["$D",v]].forEach(function(Y){le[Y[1]]=function(B){return this.$g(B,Y[0],Y[1])}}),W.extend=function(Y,B){return Y.$i||(Y(B,ge,W),Y.$i=!0),W},W.locale=M,W.isDayjs=R,W.unix=function(Y){return W(1e3*Y)},W.en=A[j],W.Ls=A,W.p={},W})})(xa);var st=xa.exports;function mr(t){const e={},n=new FormData(t.target);for(const r of n.keys())e[r]=n.getAll(r).join("|");return e}const Ec=["onSubmit"],bc=E("h5",null,"1.\u5152\u7AE5\u57FA\u672C\u8CC7\u6599",-1),$c={class:"row"},wc={class:"col-md-4"},Cc=ie(" \u5152\u7AE5\u8EAB\u4EFD\u8B49\u865F\uFF1A "),Sc=["readonly"],Ac={class:"col-md-4"},Tc=ie(" \u5152\u7AE5\u59D3\u540D\uFF1A "),Ic=["readonly"],Nc=E("br",null,null,-1),Dc={class:"row"},Rc={class:"col-md-12"},Pc=ie(" \u586B\u5BEB\u4EBA\u8207\u5152\u7AE5\u95DC\u4FC2\uFF1A "),kc={class:"form-inline"},Oc={class:"form-check-inline"},Fc={class:"form-check-label"},Mc=["value","disabled"],jc=["placeholder","disabled","readonly"],Bc=E("div",{class:"row"},[E("div",{class:"col-md-4"},[E("label",null,[ie(" \u586B\u8868\u4EBA\u806F\u7E6B\u96FB\u8A71\uFF1A "),E("input",{type:"text",class:"form-control",placeholder:"(\u52D9\u5FC5\u7559\u4E0B\u53EF\u806F\u7E6B\u96FB\u8A71)",name:"phoneNumber",required:""})])])],-1),Lc={class:"row"},xc=ie(" \u5C31\u8A3A\u554F\u984C(\u53EF\u8907\u9078)\uFF1A"),Vc=E("br",null,null,-1),Uc={class:"form-check-label"},qc=["value","disabled"],Hc=E("br",null,null,-1),Wc={key:0,class:"btn btn-primary",type:"submit"},zc=mt({__name:"UserFrom1",props:{disabled:{type:Boolean}},emits:["kidBirthdayChange","submit"],setup(t,{emit:e}){const n=["\u7236\u6BCD/\u76E3\u8B77\u4EBA","\u8001\u5E2B","\u793E\u5DE5","\u8B77\u7406\u5E2B","\u5176\u4ED6"],r=["\u52D5\u4F5C","\u8A9E\u8A00","\u5B78\u7FD2","\u60C5\u7DD2","\u5C08\u6CE8\u529B\u3001\u904E\u52D5","\u5B78\u524D\u9451\u5B9A"],s=me("");st();const i=me(null);function o(a){e("submit",mr(a),!0)}return(a,u)=>(J(),se("form",{id:"from",onSubmit:pr(o,["prevent"])},[bc,E("div",$c,[E("div",wc,[Cc,E("input",{type:"text",class:"form-control",name:"identityNumber",required:"",pattern:"[A-Z][01][0-9]{8}",readonly:t.disabled},null,8,Sc)]),E("div",Ac,[Tc,E("input",{type:"text",class:"form-control",name:"childName",required:"",readonly:t.disabled},null,8,Ic)])]),Nc,E("div",Dc,[E("div",Rc,[Pc,E("div",kc,[(J(),se(Ge,null,ut(n,(l,d)=>E("div",Oc,[E("label",Fc,[It(E("input",{class:"form-check-input",type:"radio",name:"userRelationship",value:l,"onUpdate:modelValue":u[0]||(u[0]=c=>s.value=c),required:"",disabled:t.disabled},null,8,Mc),[[lr,s.value]]),ie(Ne(l),1)])])),64)),E("div",null,[E("input",{type:"text",class:"form-control",name:"userRelationshipOther",placeholder:s.value==n[n.length-1]?"\u8ACB\u8F38\u5165\u95DC\u4FC2":"",disabled:s.value!=n[n.length-1],readonly:t.disabled},null,8,jc)])])])]),Bc,E("div",Lc,[xc,Vc,(J(),se(Ge,null,ut(r,l=>E("label",Uc,[E("input",{class:"form-check-input",type:"checkbox",name:"questionsAbouts",value:l,disabled:t.disabled},null,8,qc),ie(" "+Ne(l)+"\u2003 ",1)])),64))]),Hc,i.value?De("",!0):(J(),se("button",Wc,"\u78BA\u8A8D"))],40,Ec))}}),Kc=["onSubmit"],Gc=E("h5",null,"2.\u662F\u5426\u66FE\u7D93\u65BC\u672C\u9662/\u4ED6\u9662\u770B\u904E\u5152\u7AE5\u767C\u5C55\u806F\u5408\u8A55\u4F30\u9580\u8A3A\uFF1F",-1),Yc={class:"col-md-12"},Qc={class:"form-check"},Jc={class:"form-check-label"},Xc=["disabled"],Zc=ie("\u5426 "),ed={class:"form-check"},td={class:"form-check-label"},nd=["disabled"],rd=ie("\u662F "),sd={key:0},id={class:"row"},od={class:"form-inline col-md-6"},ad=ie(" \u524D\u6B21\u8A55\u4F30\u65E5\u671F\uFF1A"),ld=["disabled"],ud={class:"form-inline col-md-6"},cd=ie(" \u5EFA\u8B70\u8907\u8A55\u6642\u9593\uFF1A"),dd=["disabled"],hd=E("br",null,null,-1),fd={key:0},pd=E("h5",null,"\u524D\u6B21\u8A55\u4F30\u9072\u7DE9/\u81E8\u754C\u9072\u7DE9\uFF1A",-1),md={class:"col-md-12"},_d={class:"form-inline"},gd={class:"form-check"},yd={class:"form-check-label"},vd=["value","disabled"],Ed={key:1,class:"alert alert-warning"},bd=ie(" \u2027\u7121\u8AD6\u65BC\u672C\u9662\u6216\u4ED6\u9662\u8A55\u4F30\u4E00\u5E74\u5167\u4E0D\u5F97\u91CD\u8A55\uFF0C\u67E5\u8A62\u5F8C\u82E5\u91CD\u8986\u770B\u8A3A\uFF0C\u5C07\u6703\u62D2\u7D55\u8A55\u4F30"),$d=E("br",null,null,-1),wd=[bd,$d],Cd={key:2,class:"btn btn-primary",type:"submit"},Sd=mt({__name:"UserFrom2",props:{disabled:{type:Boolean}},emits:["submit"],setup(t,{emit:e}){const n=me(!1),r=me(null),s=me(null),i=["\u52D5\u4F5C\u985E","\u8A9E\u8A00","\u8A8D\u77E5\u3001\u793E\u6703\u60C5\u7DD2\u3001\u5C08\u6CE8\u529B\u3001\u904E\u52D5\u7B49"],o=me([]);function a(u){const l=st().diff(r.value);r.value&&n.value?s.value=l/(1e3*60*60*24)>365-61:s.value=!0,e("submit",mr(u),!0)}return(u,l)=>(J(),se("form",{id:"from",onSubmit:pr(a,["prevent"])},[Gc,E("div",Yc,[E("div",Qc,[E("label",Jc,[It(E("input",{type:"radio",class:"form-check-input",value:!1,"onUpdate:modelValue":l[0]||(l[0]=d=>n.value=d),required:"",disabled:t.disabled},null,8,Xc),[[lr,n.value]]),Zc])]),E("div",ed,[E("label",td,[It(E("input",{type:"radio",class:"form-check-input",value:!0,"onUpdate:modelValue":l[1]||(l[1]=d=>n.value=d),required:"",disabled:t.disabled},null,8,nd),[[lr,n.value]]),rd]),n.value?(J(),se("div",sd,[E("div",id,[E("div",od,[ad,It(E("input",{type:"date",class:"form-control",name:"lastEvaluate",required:"","onUpdate:modelValue":l[2]||(l[2]=d=>r.value=d),disabled:t.disabled},null,8,ld),[[ri,r.value]])]),E("div",ud,[cd,E("input",{type:"date",class:"form-control",name:"SuggestEvaluate",required:"",disabled:t.disabled},null,8,dd)])])])):De("",!0)])]),hd,n.value?(J(),se("div",fd,[pd,E("div",md,[(J(),se(Ge,null,ut(i,(d,c)=>E("div",_d,[E("div",gd,[E("label",yd,[It(E("input",{type:"checkbox",class:"form-check-input",name:"previousAssessment","onUpdate:modelValue":l[3]||(l[3]=m=>o.value=m),value:d,disabled:t.disabled},null,8,vd),[[hc,o.value]]),ie(Ne(d),1)])])])),64))])])):De("",!0),n.value?(J(),se("div",Ed,wd)):De("",!0),s.value?De("",!0):(J(),se("button",Cd,"\u78BA\u8A8D"))],40,Kc))}}),Ad=["onSubmit"],Td=E("h5",null,"3\u3001\u662F\u5426\u6709\u7279\u6B8A\u75BE\u75C5\uFF1F",-1),Id={class:"col-md-12"},Nd={class:"form-check"},Dd={class:"form-check-label"},Rd=["disabled"],Pd=ie("\u5426 "),kd={class:"form-check"},Od={class:"form-check-label"},Fd=["disabled"],Md=ie("\u662F "),jd={class:"form-check form-check-inline"},Bd={class:"form-check-label"},Ld=["value","disabled"],xd=E("br",null,null,-1),Vd={key:0,class:"btn btn-primary",type:"submit"},Ud=mt({__name:"UserFrom3",props:{disabled:{type:Boolean}},emits:["submit"],setup(t,{emit:e}){const n=me(!1),r=["\u795E\u7D93\u7CFB\u7D71","\u5167\u5206\u6CCC","\u7F55\u898B\u75BE\u75C5","\u65E9\u7522"],s=me(null);function i(o){s.value=!0,e("submit",mr(o),s.value)}return(o,a)=>(J(),se("form",{id:"from",onSubmit:pr(i,["prevent"])},[Td,E("div",Id,[E("div",Nd,[E("label",Dd,[It(E("input",{type:"radio",class:"form-check-input",value:!1,"onUpdate:modelValue":a[0]||(a[0]=u=>n.value=u),required:"",disabled:t.disabled},null,8,Rd),[[lr,n.value]]),Pd])]),E("div",kd,[E("label",Od,[It(E("input",{type:"radio",class:"form-check-input",value:!0,"onUpdate:modelValue":a[1]||(a[1]=u=>n.value=u),required:"",disabled:t.disabled},null,8,Fd),[[lr,n.value]]),Md]),E("div",null,[(J(),se(Ge,null,ut(r,(u,l)=>E("div",jd,[E("label",Bd,[E("input",{type:"checkbox",class:"form-check-input",name:"specialDisease",value:u,disabled:t.disabled||!n.value},null,8,Ld),ie(Ne(u),1)])])),64))])])]),xd,s.value?De("",!0):(J(),se("button",Vd,"\u78BA\u8A8D"))],40,Ad))}});const qd=["onSubmit"],Hd=E("h5",null,"5\u3001TAIPEI II \u7BE9\u6AA2\u8868",-1),Wd={class:"col-md-12"},zd={key:0},Kd=E("div",{class:"text-center"},[E("div",{class:"spinner-border",role:"status"},[E("span",{class:"visually-hidden"},"Loading...")])],-1),Gd=[Kd],Yd={key:1},Qd={class:"row"},Jd={class:"col-md-1"},Xd={style:{color:"red"}},Zd={class:"col-md-9"},eh={class:"form-check-label"},th={class:"col-md-2 text-center"},nh=["id","name"],rh=["for"],sh=["id","name"],ih=["for"],oh=["src"],ah=E("br",null,null,-1),lh={key:0,class:"btn btn-primary",type:"submit"},uh=mt({__name:"UserFrom5",props:{kidBirthday:null},emits:["submit"],setup(t,{emit:e}){const n=t,r=me({}),s=me({questions:[],image:""});fetch("assets/monthRoot.json").then(u=>u.json()).then(u=>{r.value=u});const i=Ba(()=>{const l=st().diff(st(n.kidBirthday))/(1e3*60*60*24);let d="";for(const c in r.value)if(r.value[c].min<=l&&r.value[c].max>=l){d=r.value[c].title,fetch(c).then(m=>m.json()).then(m=>{m.questions.forEach(($,v,S)=>{$.title=$.title.replace(/^\d+\./gm,""),$.answer=!!$.answer}),s.value=m});break}return d}),o=me(null);function a(u){const l=mr(u),d=[];s.value.questions.forEach((c,m,$)=>{const v=c.answer?"true":"false";l["q_"+m]==v&&d.push(m+1),delete l["q_"+m]}),l.wrongAnswers=d.join("|"),e("submit",l,!!i.value)}return(u,l)=>(J(),se("form",{id:"from",onSubmit:pr(a,["prevent"])},[Hd,E("div",Wd,[Bt(i)?De("",!0):(J(),se("div",zd,Gd)),Bt(i)?(J(),se("div",Yd,[E("h6",null,Ne(Bt(i)),1),E("div",null,[(J(!0),se(Ge,null,ut(s.value.questions,(d,c)=>(J(),se("div",{class:fc(c%2==0?"q_white_line":"q_gray_line")},[E("div",Qd,[E("div",Jd,[ie(Ne(c+1),1),E("span",Xd,Ne(d.special?"\u2605":""),1)]),E("div",Zd,[E("label",eh,Ne(d.title),1)]),E("div",th,[E("input",{type:"radio",class:"slist_radio_input",id:`q5t_${c}`,name:`q_${c}`,required:"",value:!0},null,8,nh),E("label",{class:"slist_radio_label",for:`q5t_${c}`},"\u662F",8,rh),E("input",{type:"radio",class:"slist_radio_input",id:`q5f_${c}`,name:`q_${c}`,required:"",value:!1},null,8,sh),E("label",{class:"slist_radio_label",for:`q5f_${c}`},"\u5426",8,ih)])])],2))),256)),E("img",{src:s.value.image,style:{width:"100%"}},null,8,oh)])])):De("",!0)]),ah,o.value?De("",!0):(J(),se("button",lh,"\u78BA\u8A8D"))],40,qd))}}),ch=ie(" \u4E0D\u7B26\u5408\u672C\u9662\u770B\u8A3A\u689D\u4EF6\uFF0C\u82E5\u4ECD\u9700\u8981\u672C\u9662\u5C31\u8A3A\uFF0C\u5EFA\u8B70\u8F49\u8A3A\u81F3\u4EE5\u4E0B\u79D1\u5225\uFF1A"),dh=E("br",null,null,-1),hh=ie(" \u52D5\u4F5C\u3001\u8A9E\u8A00\u985E\u767C\u5C55\u554F\u984C \u2192 \u8ACB\u639B "),fh=E("a",{href:"https://register.vghtc.gov.tw/register/listDoctor.jsp?init=init&section=REHA"},"\u5FA9\u5065\u79D1",-1),ph=E("br",null,null,-1),mh=ie(" \u8A8D\u77E5\u3001\u4EBA\u969B\u3001\u60C5\u7DD2\u3001\u5C08\u6CE8\u529B\u3001\u904E\u52D5\u7B49 \u2192 \u8ACB\u639B"),_h=E("a",{href:"https://register.vghtc.gov.tw/register/listDoctor.jsp?init=init&section=PSYC"},"\u5152\u7AE5\u5FC3\u667A\u79D1",-1),gh=mt({__name:"SuggestReferral",setup(t){return(e,n)=>(J(),se(Ge,null,[ch,dh,hh,fh,ph,mh,_h],64))}});var ks={exports:{}},Va={},ft={},An={},_r={},ae={},ur={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class e{}t._CodeOrName=e,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends e{constructor(I){if(super(),!t.IDENTIFIER.test(I))throw new Error("CodeGen: name must be a valid identifier");this.str=I}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=n;class r extends e{constructor(I){super(),this._items=typeof I=="string"?[I]:I}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const I=this._items[0];return I===""||I==='""'}get str(){var I;return(I=this._str)!==null&&I!==void 0?I:this._str=this._items.reduce((D,O)=>`${D}${O}`,"")}get names(){var I;return(I=this._names)!==null&&I!==void 0?I:this._names=this._items.reduce((D,O)=>(O instanceof n&&(D[O.str]=(D[O.str]||0)+1),D),{})}}t._Code=r,t.nil=new r("");function s(y,...I){const D=[y[0]];let O=0;for(;O<I.length;)a(D,I[O]),D.push(y[++O]);return new r(D)}t._=s;const i=new r("+");function o(y,...I){const D=[$(y[0])];let O=0;for(;O<I.length;)D.push(i),a(D,I[O]),D.push(i,$(y[++O]));return u(D),new r(D)}t.str=o;function a(y,I){I instanceof r?y.push(...I._items):I instanceof n?y.push(I):y.push(c(I))}t.addCodeArg=a;function u(y){let I=1;for(;I<y.length-1;){if(y[I]===i){const D=l(y[I-1],y[I+1]);if(D!==void 0){y.splice(I-1,3,D);continue}y[I++]="+"}I++}}function l(y,I){if(I==='""')return y;if(y==='""')return I;if(typeof y=="string")return I instanceof n||y[y.length-1]!=='"'?void 0:typeof I!="string"?`${y.slice(0,-1)}${I}"`:I[0]==='"'?y.slice(0,-1)+I.slice(1):void 0;if(typeof I=="string"&&I[0]==='"'&&!(y instanceof n))return`"${y}${I.slice(1)}`}function d(y,I){return I.emptyStr()?y:y.emptyStr()?I:o`${y}${I}`}t.strConcat=d;function c(y){return typeof y=="number"||typeof y=="boolean"||y===null?y:$(Array.isArray(y)?y.join(","):y)}function m(y){return new r($(y))}t.stringify=m;function $(y){return JSON.stringify(y).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.safeStringify=$;function v(y){return typeof y=="string"&&t.IDENTIFIER.test(y)?new r(`.${y}`):s`[${y}]`}t.getProperty=v;function S(y){if(typeof y=="string"&&t.IDENTIFIER.test(y))return new r(`${y}`);throw new Error(`CodeGen: invalid export name: ${y}, use explicit $id name mapping`)}t.getEsmExportName=S;function w(y){return new r(y.toString())}t.regexpCode=w})(ur);var Os={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const e=ur;class n extends Error{constructor(l){super(`CodeGen: "code" for ${l} not defined`),this.value=l.value}}var r;(function(u){u[u.Started=0]="Started",u[u.Completed=1]="Completed"})(r=t.UsedValueState||(t.UsedValueState={})),t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};class s{constructor({prefixes:l,parent:d}={}){this._names={},this._prefixes=l,this._parent=d}toName(l){return l instanceof e.Name?l:this.name(l)}name(l){return new e.Name(this._newName(l))}_newName(l){const d=this._names[l]||this._nameGroup(l);return`${l}${d.index++}`}_nameGroup(l){var d,c;if(((c=(d=this._parent)===null||d===void 0?void 0:d._prefixes)===null||c===void 0?void 0:c.has(l))||this._prefixes&&!this._prefixes.has(l))throw new Error(`CodeGen: prefix "${l}" is not allowed in this scope`);return this._names[l]={prefix:l,index:0}}}t.Scope=s;class i extends e.Name{constructor(l,d){super(d),this.prefix=l}setValue(l,{property:d,itemIndex:c}){this.value=l,this.scopePath=(0,e._)`.${new e.Name(d)}[${c}]`}}t.ValueScopeName=i;const o=(0,e._)`\n`;class a extends s{constructor(l){super(l),this._values={},this._scope=l.scope,this.opts=Tt(Be({},l),{_n:l.lines?o:e.nil})}get(){return this._scope}name(l){return new i(l,this._newName(l))}value(l,d){var c;if(d.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const m=this.toName(l),{prefix:$}=m,v=(c=d.key)!==null&&c!==void 0?c:d.ref;let S=this._values[$];if(S){const I=S.get(v);if(I)return I}else S=this._values[$]=new Map;S.set(v,m);const w=this._scope[$]||(this._scope[$]=[]),y=w.length;return w[y]=d.ref,m.setValue(d,{property:$,itemIndex:y}),m}getValue(l,d){const c=this._values[l];if(!!c)return c.get(d)}scopeRefs(l,d=this._values){return this._reduceValues(d,c=>{if(c.scopePath===void 0)throw new Error(`CodeGen: name "${c}" has no value`);return(0,e._)`${l}${c.scopePath}`})}scopeCode(l=this._values,d,c){return this._reduceValues(l,m=>{if(m.value===void 0)throw new Error(`CodeGen: name "${m}" has no value`);return m.value.code},d,c)}_reduceValues(l,d,c={},m){let $=e.nil;for(const v in l){const S=l[v];if(!S)continue;const w=c[v]=c[v]||new Map;S.forEach(y=>{if(w.has(y))return;w.set(y,r.Started);let I=d(y);if(I){const D=this.opts.es5?t.varKinds.var:t.varKinds.const;$=(0,e._)`${$}${D} ${y} = ${I};${this.opts._n}`}else if(I=m==null?void 0:m(y))$=(0,e._)`${$}${I}${this.opts._n}`;else throw new n(y);w.set(y,r.Completed)})}return $}}t.ValueScope=a})(Os);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const e=ur,n=Os;var r=ur;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return r.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return r.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return r.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}});var s=Os;Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return s.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return s.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return s.varKinds}}),t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};class i{optimizeNodes(){return this}optimizeNames(h,p){return this}}class o extends i{constructor(h,p,P){super(),this.varKind=h,this.name=p,this.rhs=P}render({es5:h,_n:p}){const P=h?n.varKinds.var:this.varKind,x=this.rhs===void 0?"":` = ${this.rhs}`;return`${P} ${this.name}${x};`+p}optimizeNames(h,p){if(!!h[this.name.str])return this.rhs&&(this.rhs=B(this.rhs,h,p)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}}class a extends i{constructor(h,p,P){super(),this.lhs=h,this.rhs=p,this.sideEffects=P}render({_n:h}){return`${this.lhs} = ${this.rhs};`+h}optimizeNames(h,p){if(!(this.lhs instanceof e.Name&&!h[this.lhs.str]&&!this.sideEffects))return this.rhs=B(this.rhs,h,p),this}get names(){const h=this.lhs instanceof e.Name?{}:Be({},this.lhs.names);return Y(h,this.rhs)}}class u extends a{constructor(h,p,P,x){super(h,P,x),this.op=p}render({_n:h}){return`${this.lhs} ${this.op}= ${this.rhs};`+h}}class l extends i{constructor(h){super(),this.label=h,this.names={}}render({_n:h}){return`${this.label}:`+h}}class d extends i{constructor(h){super(),this.label=h,this.names={}}render({_n:h}){return`break${this.label?` ${this.label}`:""};`+h}}class c extends i{constructor(h){super(),this.error=h}render({_n:h}){return`throw ${this.error};`+h}get names(){return this.error.names}}class m extends i{constructor(h){super(),this.code=h}render({_n:h}){return`${this.code};`+h}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(h,p){return this.code=B(this.code,h,p),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}}class $ extends i{constructor(h=[]){super(),this.nodes=h}render(h){return this.nodes.reduce((p,P)=>p+P.render(h),"")}optimizeNodes(){const{nodes:h}=this;let p=h.length;for(;p--;){const P=h[p].optimizeNodes();Array.isArray(P)?h.splice(p,1,...P):P?h[p]=P:h.splice(p,1)}return h.length>0?this:void 0}optimizeNames(h,p){const{nodes:P}=this;let x=P.length;for(;x--;){const q=P[x];q.optimizeNames(h,p)||(L(h,q.names),P.splice(x,1))}return P.length>0?this:void 0}get names(){return this.nodes.reduce((h,p)=>le(h,p.names),{})}}class v extends ${render(h){return"{"+h._n+super.render(h)+"}"+h._n}}class S extends ${}class w extends v{}w.kind="else";class y extends v{constructor(h,p){super(p),this.condition=h}render(h){let p=`if(${this.condition})`+super.render(h);return this.else&&(p+="else "+this.else.render(h)),p}optimizeNodes(){super.optimizeNodes();const h=this.condition;if(h===!0)return this.nodes;let p=this.else;if(p){const P=p.optimizeNodes();p=this.else=Array.isArray(P)?new w(P):P}if(p)return h===!1?p instanceof y?p:p.nodes:this.nodes.length?this:new y(X(h),p instanceof y?[p]:p.nodes);if(!(h===!1||!this.nodes.length))return this}optimizeNames(h,p){var P;if(this.else=(P=this.else)===null||P===void 0?void 0:P.optimizeNames(h,p),!!(super.optimizeNames(h,p)||this.else))return this.condition=B(this.condition,h,p),this}get names(){const h=super.names;return Y(h,this.condition),this.else&&le(h,this.else.names),h}}y.kind="if";class I extends v{}I.kind="for";class D extends I{constructor(h){super(),this.iteration=h}render(h){return`for(${this.iteration})`+super.render(h)}optimizeNames(h,p){if(!!super.optimizeNames(h,p))return this.iteration=B(this.iteration,h,p),this}get names(){return le(super.names,this.iteration.names)}}class O extends I{constructor(h,p,P,x){super(),this.varKind=h,this.name=p,this.from=P,this.to=x}render(h){const p=h.es5?n.varKinds.var:this.varKind,{name:P,from:x,to:q}=this;return`for(${p} ${P}=${x}; ${P}<${q}; ${P}++)`+super.render(h)}get names(){const h=Y(super.names,this.from);return Y(h,this.to)}}class j extends I{constructor(h,p,P,x){super(),this.loop=h,this.varKind=p,this.name=P,this.iterable=x}render(h){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(h)}optimizeNames(h,p){if(!!super.optimizeNames(h,p))return this.iterable=B(this.iterable,h,p),this}get names(){return le(super.names,this.iterable.names)}}class A extends v{constructor(h,p,P){super(),this.name=h,this.args=p,this.async=P}render(h){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(h)}}A.kind="func";class R extends ${render(h){return"return "+super.render(h)}}R.kind="return";class M extends v{render(h){let p="try"+super.render(h);return this.catch&&(p+=this.catch.render(h)),this.finally&&(p+=this.finally.render(h)),p}optimizeNodes(){var h,p;return super.optimizeNodes(),(h=this.catch)===null||h===void 0||h.optimizeNodes(),(p=this.finally)===null||p===void 0||p.optimizeNodes(),this}optimizeNames(h,p){var P,x;return super.optimizeNames(h,p),(P=this.catch)===null||P===void 0||P.optimizeNames(h,p),(x=this.finally)===null||x===void 0||x.optimizeNames(h,p),this}get names(){const h=super.names;return this.catch&&le(h,this.catch.names),this.finally&&le(h,this.finally.names),h}}class W extends v{constructor(h){super(),this.error=h}render(h){return`catch(${this.error})`+super.render(h)}}W.kind="catch";class H extends v{render(h){return"finally"+super.render(h)}}H.kind="finally";class ge{constructor(h,p={}){this._values={},this._blockStarts=[],this._constants={},this.opts=Tt(Be({},p),{_n:p.lines?`
`:""}),this._extScope=h,this._scope=new n.Scope({parent:h}),this._nodes=[new S]}toString(){return this._root.render(this.opts)}name(h){return this._scope.name(h)}scopeName(h){return this._extScope.name(h)}scopeValue(h,p){const P=this._extScope.value(h,p);return(this._values[P.prefix]||(this._values[P.prefix]=new Set)).add(P),P}getScopeValue(h,p){return this._extScope.getValue(h,p)}scopeRefs(h){return this._extScope.scopeRefs(h,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(h,p,P,x){const q=this._scope.toName(p);return P!==void 0&&x&&(this._constants[q.str]=P),this._leafNode(new o(h,q,P)),q}const(h,p,P){return this._def(n.varKinds.const,h,p,P)}let(h,p,P){return this._def(n.varKinds.let,h,p,P)}var(h,p,P){return this._def(n.varKinds.var,h,p,P)}assign(h,p,P){return this._leafNode(new a(h,p,P))}add(h,p){return this._leafNode(new u(h,t.operators.ADD,p))}code(h){return typeof h=="function"?h():h!==e.nil&&this._leafNode(new m(h)),this}object(...h){const p=["{"];for(const[P,x]of h)p.length>1&&p.push(","),p.push(P),(P!==x||this.opts.es5)&&(p.push(":"),(0,e.addCodeArg)(p,x));return p.push("}"),new e._Code(p)}if(h,p,P){if(this._blockNode(new y(h)),p&&P)this.code(p).else().code(P).endIf();else if(p)this.code(p).endIf();else if(P)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(h){return this._elseNode(new y(h))}else(){return this._elseNode(new w)}endIf(){return this._endBlockNode(y,w)}_for(h,p){return this._blockNode(h),p&&this.code(p).endFor(),this}for(h,p){return this._for(new D(h),p)}forRange(h,p,P,x,q=this.opts.es5?n.varKinds.var:n.varKinds.let){const Q=this._scope.toName(h);return this._for(new O(q,Q,p,P),()=>x(Q))}forOf(h,p,P,x=n.varKinds.const){const q=this._scope.toName(h);if(this.opts.es5){const Q=p instanceof e.Name?p:this.var("_arr",p);return this.forRange("_i",0,(0,e._)`${Q}.length`,ne=>{this.var(q,(0,e._)`${Q}[${ne}]`),P(q)})}return this._for(new j("of",x,q,p),()=>P(q))}forIn(h,p,P,x=this.opts.es5?n.varKinds.var:n.varKinds.const){if(this.opts.ownProperties)return this.forOf(h,(0,e._)`Object.keys(${p})`,P);const q=this._scope.toName(h);return this._for(new j("in",x,q,p),()=>P(q))}endFor(){return this._endBlockNode(I)}label(h){return this._leafNode(new l(h))}break(h){return this._leafNode(new d(h))}return(h){const p=new R;if(this._blockNode(p),this.code(h),p.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(R)}try(h,p,P){if(!p&&!P)throw new Error('CodeGen: "try" without "catch" and "finally"');const x=new M;if(this._blockNode(x),this.code(h),p){const q=this.name("e");this._currNode=x.catch=new W(q),p(q)}return P&&(this._currNode=x.finally=new H,this.code(P)),this._endBlockNode(W,H)}throw(h){return this._leafNode(new c(h))}block(h,p){return this._blockStarts.push(this._nodes.length),h&&this.code(h).endBlock(p),this}endBlock(h){const p=this._blockStarts.pop();if(p===void 0)throw new Error("CodeGen: not in self-balancing block");const P=this._nodes.length-p;if(P<0||h!==void 0&&P!==h)throw new Error(`CodeGen: wrong number of nodes: ${P} vs ${h} expected`);return this._nodes.length=p,this}func(h,p=e.nil,P,x){return this._blockNode(new A(h,p,P)),x&&this.code(x).endFunc(),this}endFunc(){return this._endBlockNode(A)}optimize(h=1){for(;h-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(h){return this._currNode.nodes.push(h),this}_blockNode(h){this._currNode.nodes.push(h),this._nodes.push(h)}_endBlockNode(h,p){const P=this._currNode;if(P instanceof h||p&&P instanceof p)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${p?`${h.kind}/${p.kind}`:h.kind}"`)}_elseNode(h){const p=this._currNode;if(!(p instanceof y))throw new Error('CodeGen: "else" without "if"');return this._currNode=p.else=h,this}get _root(){return this._nodes[0]}get _currNode(){const h=this._nodes;return h[h.length-1]}set _currNode(h){const p=this._nodes;p[p.length-1]=h}}t.CodeGen=ge;function le(C,h){for(const p in h)C[p]=(C[p]||0)+(h[p]||0);return C}function Y(C,h){return h instanceof e._CodeOrName?le(C,h.names):C}function B(C,h,p){if(C instanceof e.Name)return P(C);if(!x(C))return C;return new e._Code(C._items.reduce((q,Q)=>(Q instanceof e.Name&&(Q=P(Q)),Q instanceof e._Code?q.push(...Q._items):q.push(Q),q),[]));function P(q){const Q=p[q.str];return Q===void 0||h[q.str]!==1?q:(delete h[q.str],Q)}function x(q){return q instanceof e._Code&&q._items.some(Q=>Q instanceof e.Name&&h[Q.str]===1&&p[Q.str]!==void 0)}}function L(C,h){for(const p in h)C[p]=(C[p]||0)-(h[p]||0)}function X(C){return typeof C=="boolean"||typeof C=="number"||C===null?!C:(0,e._)`!${k(C)}`}t.not=X;const U=b(t.operators.AND);function ee(...C){return C.reduce(U)}t.and=ee;const Z=b(t.operators.OR);function F(...C){return C.reduce(Z)}t.or=F;function b(C){return(h,p)=>h===e.nil?p:p===e.nil?h:(0,e._)`${k(h)} ${C} ${k(p)}`}function k(C){return C instanceof e.Name?C:(0,e._)`(${C})`}})(ae);var pe={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.getErrorPath=t.Type=t.useFunc=t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;const e=ae,n=ur;function r(A){const R={};for(const M of A)R[M]=!0;return R}t.toHash=r;function s(A,R){return typeof R=="boolean"?R:Object.keys(R).length===0?!0:(i(A,R),!o(R,A.self.RULES.all))}t.alwaysValidSchema=s;function i(A,R=A.schema){const{opts:M,self:W}=A;if(!M.strictSchema||typeof R=="boolean")return;const H=W.RULES.keywords;for(const ge in R)H[ge]||j(A,`unknown keyword: "${ge}"`)}t.checkUnknownRules=i;function o(A,R){if(typeof A=="boolean")return!A;for(const M in A)if(R[M])return!0;return!1}t.schemaHasRules=o;function a(A,R){if(typeof A=="boolean")return!A;for(const M in A)if(M!=="$ref"&&R.all[M])return!0;return!1}t.schemaHasRulesButRef=a;function u({topSchemaRef:A,schemaPath:R},M,W,H){if(!H){if(typeof M=="number"||typeof M=="boolean")return M;if(typeof M=="string")return(0,e._)`${M}`}return(0,e._)`${A}${R}${(0,e.getProperty)(W)}`}t.schemaRefOrVal=u;function l(A){return m(decodeURIComponent(A))}t.unescapeFragment=l;function d(A){return encodeURIComponent(c(A))}t.escapeFragment=d;function c(A){return typeof A=="number"?`${A}`:A.replace(/~/g,"~0").replace(/\//g,"~1")}t.escapeJsonPointer=c;function m(A){return A.replace(/~1/g,"/").replace(/~0/g,"~")}t.unescapeJsonPointer=m;function $(A,R){if(Array.isArray(A))for(const M of A)R(M);else R(A)}t.eachItem=$;function v({mergeNames:A,mergeToName:R,mergeValues:M,resultToName:W}){return(H,ge,le,Y)=>{const B=le===void 0?ge:le instanceof e.Name?(ge instanceof e.Name?A(H,ge,le):R(H,ge,le),le):ge instanceof e.Name?(R(H,le,ge),ge):M(ge,le);return Y===e.Name&&!(B instanceof e.Name)?W(H,B):B}}t.mergeEvaluated={props:v({mergeNames:(A,R,M)=>A.if((0,e._)`${M} !== true && ${R} !== undefined`,()=>{A.if((0,e._)`${R} === true`,()=>A.assign(M,!0),()=>A.assign(M,(0,e._)`${M} || {}`).code((0,e._)`Object.assign(${M}, ${R})`))}),mergeToName:(A,R,M)=>A.if((0,e._)`${M} !== true`,()=>{R===!0?A.assign(M,!0):(A.assign(M,(0,e._)`${M} || {}`),w(A,M,R))}),mergeValues:(A,R)=>A===!0?!0:Be(Be({},A),R),resultToName:S}),items:v({mergeNames:(A,R,M)=>A.if((0,e._)`${M} !== true && ${R} !== undefined`,()=>A.assign(M,(0,e._)`${R} === true ? true : ${M} > ${R} ? ${M} : ${R}`)),mergeToName:(A,R,M)=>A.if((0,e._)`${M} !== true`,()=>A.assign(M,R===!0?!0:(0,e._)`${M} > ${R} ? ${M} : ${R}`)),mergeValues:(A,R)=>A===!0?!0:Math.max(A,R),resultToName:(A,R)=>A.var("items",R)})};function S(A,R){if(R===!0)return A.var("props",!0);const M=A.var("props",(0,e._)`{}`);return R!==void 0&&w(A,M,R),M}t.evaluatedPropsToName=S;function w(A,R,M){Object.keys(M).forEach(W=>A.assign((0,e._)`${R}${(0,e.getProperty)(W)}`,!0))}t.setEvaluated=w;const y={};function I(A,R){return A.scopeValue("func",{ref:R,code:y[R.code]||(y[R.code]=new n._Code(R.code))})}t.useFunc=I;var D;(function(A){A[A.Num=0]="Num",A[A.Str=1]="Str"})(D=t.Type||(t.Type={}));function O(A,R,M){if(A instanceof e.Name){const W=R===D.Num;return M?W?(0,e._)`"[" + ${A} + "]"`:(0,e._)`"['" + ${A} + "']"`:W?(0,e._)`"/" + ${A}`:(0,e._)`"/" + ${A}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return M?(0,e.getProperty)(A).toString():"/"+c(A)}t.getErrorPath=O;function j(A,R,M=A.opts.strictSchema){if(!!M){if(R=`strict mode: ${R}`,M===!0)throw new Error(R);A.self.logger.warn(R)}}t.checkStrictMode=j})(pe);var St={};Object.defineProperty(St,"__esModule",{value:!0});const Ue=ae,yh={data:new Ue.Name("data"),valCxt:new Ue.Name("valCxt"),instancePath:new Ue.Name("instancePath"),parentData:new Ue.Name("parentData"),parentDataProperty:new Ue.Name("parentDataProperty"),rootData:new Ue.Name("rootData"),dynamicAnchors:new Ue.Name("dynamicAnchors"),vErrors:new Ue.Name("vErrors"),errors:new Ue.Name("errors"),this:new Ue.Name("this"),self:new Ue.Name("self"),scope:new Ue.Name("scope"),json:new Ue.Name("json"),jsonPos:new Ue.Name("jsonPos"),jsonLen:new Ue.Name("jsonLen"),jsonPart:new Ue.Name("jsonPart")};St.default=yh;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const e=ae,n=pe,r=St;t.keywordError={message:({keyword:w})=>(0,e.str)`must pass "${w}" keyword validation`},t.keyword$DataError={message:({keyword:w,schemaType:y})=>y?(0,e.str)`"${w}" keyword must be ${y} ($data)`:(0,e.str)`"${w}" keyword is invalid ($data)`};function s(w,y=t.keywordError,I,D){const{it:O}=w,{gen:j,compositeRule:A,allErrors:R}=O,M=c(w,y,I);(D!=null?D:A||R)?u(j,M):l(O,(0,e._)`[${M}]`)}t.reportError=s;function i(w,y=t.keywordError,I){const{it:D}=w,{gen:O,compositeRule:j,allErrors:A}=D,R=c(w,y,I);u(O,R),j||A||l(D,r.default.vErrors)}t.reportExtraError=i;function o(w,y){w.assign(r.default.errors,y),w.if((0,e._)`${r.default.vErrors} !== null`,()=>w.if(y,()=>w.assign((0,e._)`${r.default.vErrors}.length`,y),()=>w.assign(r.default.vErrors,null)))}t.resetErrorsCount=o;function a({gen:w,keyword:y,schemaValue:I,data:D,errsCount:O,it:j}){if(O===void 0)throw new Error("ajv implementation error");const A=w.name("err");w.forRange("i",O,r.default.errors,R=>{w.const(A,(0,e._)`${r.default.vErrors}[${R}]`),w.if((0,e._)`${A}.instancePath === undefined`,()=>w.assign((0,e._)`${A}.instancePath`,(0,e.strConcat)(r.default.instancePath,j.errorPath))),w.assign((0,e._)`${A}.schemaPath`,(0,e.str)`${j.errSchemaPath}/${y}`),j.opts.verbose&&(w.assign((0,e._)`${A}.schema`,I),w.assign((0,e._)`${A}.data`,D))})}t.extendErrors=a;function u(w,y){const I=w.const("err",y);w.if((0,e._)`${r.default.vErrors} === null`,()=>w.assign(r.default.vErrors,(0,e._)`[${I}]`),(0,e._)`${r.default.vErrors}.push(${I})`),w.code((0,e._)`${r.default.errors}++`)}function l(w,y){const{gen:I,validateName:D,schemaEnv:O}=w;O.$async?I.throw((0,e._)`new ${w.ValidationError}(${y})`):(I.assign((0,e._)`${D}.errors`,y),I.return(!1))}const d={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")};function c(w,y,I){const{createErrors:D}=w.it;return D===!1?(0,e._)`{}`:m(w,y,I)}function m(w,y,I={}){const{gen:D,it:O}=w,j=[$(O,I),v(w,I)];return S(w,y,j),D.object(...j)}function $({errorPath:w},{instancePath:y}){const I=y?(0,e.str)`${w}${(0,n.getErrorPath)(y,n.Type.Str)}`:w;return[r.default.instancePath,(0,e.strConcat)(r.default.instancePath,I)]}function v({keyword:w,it:{errSchemaPath:y}},{schemaPath:I,parentSchema:D}){let O=D?y:(0,e.str)`${y}/${w}`;return I&&(O=(0,e.str)`${O}${(0,n.getErrorPath)(I,n.Type.Str)}`),[d.schemaPath,O]}function S(w,{params:y,message:I},D){const{keyword:O,data:j,schemaValue:A,it:R}=w,{opts:M,propertyName:W,topSchemaRef:H,schemaPath:ge}=R;D.push([d.keyword,O],[d.params,typeof y=="function"?y(w):y||(0,e._)`{}`]),M.messages&&D.push([d.message,typeof I=="function"?I(w):I]),M.verbose&&D.push([d.schema,A],[d.parentSchema,(0,e._)`${H}${ge}`],[r.default.data,j]),W&&D.push([d.propertyName,W])}})(_r);Object.defineProperty(An,"__esModule",{value:!0});An.boolOrEmptySchema=An.topBoolOrEmptySchema=void 0;const vh=_r,Eh=ae,bh=St,$h={message:"boolean schema is false"};function wh(t){const{gen:e,schema:n,validateName:r}=t;n===!1?Ua(t,!1):typeof n=="object"&&n.$async===!0?e.return(bh.default.data):(e.assign((0,Eh._)`${r}.errors`,null),e.return(!0))}An.topBoolOrEmptySchema=wh;function Ch(t,e){const{gen:n,schema:r}=t;r===!1?(n.var(e,!1),Ua(t)):n.var(e,!0)}An.boolOrEmptySchema=Ch;function Ua(t,e){const{gen:n,data:r}=t,s={gen:n,keyword:"false schema",data:r,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,vh.reportError)(s,$h,void 0,e)}var gr={},en={};Object.defineProperty(en,"__esModule",{value:!0});en.getRules=en.isJSONType=void 0;const Sh=["string","number","integer","boolean","null","object","array"],Ah=new Set(Sh);function Th(t){return typeof t=="string"&&Ah.has(t)}en.isJSONType=Th;function Ih(){const t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:Tt(Be({},t),{integer:!0,boolean:!0,null:!0}),rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}en.getRules=Ih;var Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});Dt.shouldUseRule=Dt.shouldUseGroup=Dt.schemaHasRulesForType=void 0;function Nh({schema:t,self:e},n){const r=e.RULES.types[n];return r&&r!==!0&&qa(t,r)}Dt.schemaHasRulesForType=Nh;function qa(t,e){return e.rules.some(n=>Ha(t,n))}Dt.shouldUseGroup=qa;function Ha(t,e){var n;return t[e.keyword]!==void 0||((n=e.definition.implements)===null||n===void 0?void 0:n.some(r=>t[r]!==void 0))}Dt.shouldUseRule=Ha;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;const e=en,n=Dt,r=_r,s=ae,i=pe;var o;(function(D){D[D.Correct=0]="Correct",D[D.Wrong=1]="Wrong"})(o=t.DataType||(t.DataType={}));function a(D){const O=u(D.type);if(O.includes("null")){if(D.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!O.length&&D.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');D.nullable===!0&&O.push("null")}return O}t.getSchemaTypes=a;function u(D){const O=Array.isArray(D)?D:D?[D]:[];if(O.every(e.isJSONType))return O;throw new Error("type must be JSONType or JSONType[]: "+O.join(","))}t.getJSONTypes=u;function l(D,O){const{gen:j,data:A,opts:R}=D,M=c(O,R.coerceTypes),W=O.length>0&&!(M.length===0&&O.length===1&&(0,n.schemaHasRulesForType)(D,O[0]));if(W){const H=S(O,A,R.strictNumbers,o.Wrong);j.if(H,()=>{M.length?m(D,O,M):y(D)})}return W}t.coerceAndCheckDataType=l;const d=new Set(["string","number","integer","boolean","null"]);function c(D,O){return O?D.filter(j=>d.has(j)||O==="array"&&j==="array"):[]}function m(D,O,j){const{gen:A,data:R,opts:M}=D,W=A.let("dataType",(0,s._)`typeof ${R}`),H=A.let("coerced",(0,s._)`undefined`);M.coerceTypes==="array"&&A.if((0,s._)`${W} == 'object' && Array.isArray(${R}) && ${R}.length == 1`,()=>A.assign(R,(0,s._)`${R}[0]`).assign(W,(0,s._)`typeof ${R}`).if(S(O,R,M.strictNumbers),()=>A.assign(H,R))),A.if((0,s._)`${H} !== undefined`);for(const le of j)(d.has(le)||le==="array"&&M.coerceTypes==="array")&&ge(le);A.else(),y(D),A.endIf(),A.if((0,s._)`${H} !== undefined`,()=>{A.assign(R,H),$(D,H)});function ge(le){switch(le){case"string":A.elseIf((0,s._)`${W} == "number" || ${W} == "boolean"`).assign(H,(0,s._)`"" + ${R}`).elseIf((0,s._)`${R} === null`).assign(H,(0,s._)`""`);return;case"number":A.elseIf((0,s._)`${W} == "boolean" || ${R} === null
              || (${W} == "string" && ${R} && ${R} == +${R})`).assign(H,(0,s._)`+${R}`);return;case"integer":A.elseIf((0,s._)`${W} === "boolean" || ${R} === null
              || (${W} === "string" && ${R} && ${R} == +${R} && !(${R} % 1))`).assign(H,(0,s._)`+${R}`);return;case"boolean":A.elseIf((0,s._)`${R} === "false" || ${R} === 0 || ${R} === null`).assign(H,!1).elseIf((0,s._)`${R} === "true" || ${R} === 1`).assign(H,!0);return;case"null":A.elseIf((0,s._)`${R} === "" || ${R} === 0 || ${R} === false`),A.assign(H,null);return;case"array":A.elseIf((0,s._)`${W} === "string" || ${W} === "number"
              || ${W} === "boolean" || ${R} === null`).assign(H,(0,s._)`[${R}]`)}}}function $({gen:D,parentData:O,parentDataProperty:j},A){D.if((0,s._)`${O} !== undefined`,()=>D.assign((0,s._)`${O}[${j}]`,A))}function v(D,O,j,A=o.Correct){const R=A===o.Correct?s.operators.EQ:s.operators.NEQ;let M;switch(D){case"null":return(0,s._)`${O} ${R} null`;case"array":M=(0,s._)`Array.isArray(${O})`;break;case"object":M=(0,s._)`${O} && typeof ${O} == "object" && !Array.isArray(${O})`;break;case"integer":M=W((0,s._)`!(${O} % 1) && !isNaN(${O})`);break;case"number":M=W();break;default:return(0,s._)`typeof ${O} ${R} ${D}`}return A===o.Correct?M:(0,s.not)(M);function W(H=s.nil){return(0,s.and)((0,s._)`typeof ${O} == "number"`,H,j?(0,s._)`isFinite(${O})`:s.nil)}}t.checkDataType=v;function S(D,O,j,A){if(D.length===1)return v(D[0],O,j,A);let R;const M=(0,i.toHash)(D);if(M.array&&M.object){const W=(0,s._)`typeof ${O} != "object"`;R=M.null?W:(0,s._)`!${O} || ${W}`,delete M.null,delete M.array,delete M.object}else R=s.nil;M.number&&delete M.integer;for(const W in M)R=(0,s.and)(R,v(W,O,j,A));return R}t.checkDataTypes=S;const w={message:({schema:D})=>`must be ${D}`,params:({schema:D,schemaValue:O})=>typeof D=="string"?(0,s._)`{type: ${D}}`:(0,s._)`{type: ${O}}`};function y(D){const O=I(D);(0,r.reportError)(O,w)}t.reportTypeError=y;function I(D){const{gen:O,data:j,schema:A}=D,R=(0,i.schemaRefOrVal)(D,A,"type");return{gen:O,keyword:"type",data:j,schema:A.type,schemaCode:R,schemaValue:R,parentSchema:A,params:{},it:D}}})(gr);var ns={};Object.defineProperty(ns,"__esModule",{value:!0});ns.assignDefaults=void 0;const gn=ae,Dh=pe;function Rh(t,e){const{properties:n,items:r}=t.schema;if(e==="object"&&n)for(const s in n)To(t,s,n[s].default);else e==="array"&&Array.isArray(r)&&r.forEach((s,i)=>To(t,i,s.default))}ns.assignDefaults=Rh;function To(t,e,n){const{gen:r,compositeRule:s,data:i,opts:o}=t;if(n===void 0)return;const a=(0,gn._)`${i}${(0,gn.getProperty)(e)}`;if(s){(0,Dh.checkStrictMode)(t,`default is ignored for: ${a}`);return}let u=(0,gn._)`${a} === undefined`;o.useDefaults==="empty"&&(u=(0,gn._)`${u} || ${a} === null || ${a} === ""`),r.if(u,(0,gn._)`${a} = ${(0,gn.stringify)(n)}`)}var wt={},oe={};Object.defineProperty(oe,"__esModule",{value:!0});oe.validateUnion=oe.validateArray=oe.usePattern=oe.callValidateCode=oe.schemaProperties=oe.allSchemaProperties=oe.noPropertyInData=oe.propertyInData=oe.isOwnProperty=oe.hasPropFunc=oe.reportMissingProp=oe.checkMissingProp=oe.checkReportMissingProp=void 0;const Se=ae,si=pe,Ft=St,Ph=pe;function kh(t,e){const{gen:n,data:r,it:s}=t;n.if(oi(n,r,e,s.opts.ownProperties),()=>{t.setParams({missingProperty:(0,Se._)`${e}`},!0),t.error()})}oe.checkReportMissingProp=kh;function Oh({gen:t,data:e,it:{opts:n}},r,s){return(0,Se.or)(...r.map(i=>(0,Se.and)(oi(t,e,i,n.ownProperties),(0,Se._)`${s} = ${i}`)))}oe.checkMissingProp=Oh;function Fh(t,e){t.setParams({missingProperty:e},!0),t.error()}oe.reportMissingProp=Fh;function Wa(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,Se._)`Object.prototype.hasOwnProperty`})}oe.hasPropFunc=Wa;function ii(t,e,n){return(0,Se._)`${Wa(t)}.call(${e}, ${n})`}oe.isOwnProperty=ii;function Mh(t,e,n,r){const s=(0,Se._)`${e}${(0,Se.getProperty)(n)} !== undefined`;return r?(0,Se._)`${s} && ${ii(t,e,n)}`:s}oe.propertyInData=Mh;function oi(t,e,n,r){const s=(0,Se._)`${e}${(0,Se.getProperty)(n)} === undefined`;return r?(0,Se.or)(s,(0,Se.not)(ii(t,e,n))):s}oe.noPropertyInData=oi;function za(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}oe.allSchemaProperties=za;function jh(t,e){return za(e).filter(n=>!(0,si.alwaysValidSchema)(t,e[n]))}oe.schemaProperties=jh;function Bh({schemaCode:t,data:e,it:{gen:n,topSchemaRef:r,schemaPath:s,errorPath:i},it:o},a,u,l){const d=l?(0,Se._)`${t}, ${e}, ${r}${s}`:e,c=[[Ft.default.instancePath,(0,Se.strConcat)(Ft.default.instancePath,i)],[Ft.default.parentData,o.parentData],[Ft.default.parentDataProperty,o.parentDataProperty],[Ft.default.rootData,Ft.default.rootData]];o.opts.dynamicRef&&c.push([Ft.default.dynamicAnchors,Ft.default.dynamicAnchors]);const m=(0,Se._)`${d}, ${n.object(...c)}`;return u!==Se.nil?(0,Se._)`${a}.call(${u}, ${m})`:(0,Se._)`${a}(${m})`}oe.callValidateCode=Bh;const Lh=(0,Se._)`new RegExp`;function xh({gen:t,it:{opts:e}},n){const r=e.unicodeRegExp?"u":"",{regExp:s}=e.code,i=s(n,r);return t.scopeValue("pattern",{key:i.toString(),ref:i,code:(0,Se._)`${s.code==="new RegExp"?Lh:(0,Ph.useFunc)(t,s)}(${n}, ${r})`})}oe.usePattern=xh;function Vh(t){const{gen:e,data:n,keyword:r,it:s}=t,i=e.name("valid");if(s.allErrors){const a=e.let("valid",!0);return o(()=>e.assign(a,!1)),a}return e.var(i,!0),o(()=>e.break()),i;function o(a){const u=e.const("len",(0,Se._)`${n}.length`);e.forRange("i",0,u,l=>{t.subschema({keyword:r,dataProp:l,dataPropType:si.Type.Num},i),e.if((0,Se.not)(i),a)})}}oe.validateArray=Vh;function Uh(t){const{gen:e,schema:n,keyword:r,it:s}=t;if(!Array.isArray(n))throw new Error("ajv implementation error");if(n.some(u=>(0,si.alwaysValidSchema)(s,u))&&!s.opts.unevaluated)return;const o=e.let("valid",!1),a=e.name("_valid");e.block(()=>n.forEach((u,l)=>{const d=t.subschema({keyword:r,schemaProp:l,compositeRule:!0},a);e.assign(o,(0,Se._)`${o} || ${a}`),t.mergeValidEvaluated(d,a)||e.if((0,Se.not)(o))})),t.result(o,()=>t.reset(),()=>t.error(!0))}oe.validateUnion=Uh;Object.defineProperty(wt,"__esModule",{value:!0});wt.validateKeywordUsage=wt.validSchemaType=wt.funcKeywordCode=wt.macroKeywordCode=void 0;const Ke=ae,Yt=St,qh=oe,Hh=_r;function Wh(t,e){const{gen:n,keyword:r,schema:s,parentSchema:i,it:o}=t,a=e.macro.call(o.self,s,i,o),u=Ka(n,r,a);o.opts.validateSchema!==!1&&o.self.validateSchema(a,!0);const l=n.name("valid");t.subschema({schema:a,schemaPath:Ke.nil,errSchemaPath:`${o.errSchemaPath}/${r}`,topSchemaRef:u,compositeRule:!0},l),t.pass(l,()=>t.error(!0))}wt.macroKeywordCode=Wh;function zh(t,e){var n;const{gen:r,keyword:s,schema:i,parentSchema:o,$data:a,it:u}=t;Gh(u,e);const l=!a&&e.compile?e.compile.call(u.self,i,o,u):e.validate,d=Ka(r,s,l),c=r.let("valid");t.block$data(c,m),t.ok((n=e.valid)!==null&&n!==void 0?n:c);function m(){if(e.errors===!1)S(),e.modifying&&Io(t),w(()=>t.error());else{const y=e.async?$():v();e.modifying&&Io(t),w(()=>Kh(t,y))}}function $(){const y=r.let("ruleErrs",null);return r.try(()=>S((0,Ke._)`await `),I=>r.assign(c,!1).if((0,Ke._)`${I} instanceof ${u.ValidationError}`,()=>r.assign(y,(0,Ke._)`${I}.errors`),()=>r.throw(I))),y}function v(){const y=(0,Ke._)`${d}.errors`;return r.assign(y,null),S(Ke.nil),y}function S(y=e.async?(0,Ke._)`await `:Ke.nil){const I=u.opts.passContext?Yt.default.this:Yt.default.self,D=!("compile"in e&&!a||e.schema===!1);r.assign(c,(0,Ke._)`${y}${(0,qh.callValidateCode)(t,d,I,D)}`,e.modifying)}function w(y){var I;r.if((0,Ke.not)((I=e.valid)!==null&&I!==void 0?I:c),y)}}wt.funcKeywordCode=zh;function Io(t){const{gen:e,data:n,it:r}=t;e.if(r.parentData,()=>e.assign(n,(0,Ke._)`${r.parentData}[${r.parentDataProperty}]`))}function Kh(t,e){const{gen:n}=t;n.if((0,Ke._)`Array.isArray(${e})`,()=>{n.assign(Yt.default.vErrors,(0,Ke._)`${Yt.default.vErrors} === null ? ${e} : ${Yt.default.vErrors}.concat(${e})`).assign(Yt.default.errors,(0,Ke._)`${Yt.default.vErrors}.length`),(0,Hh.extendErrors)(t)},()=>t.error())}function Gh({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function Ka(t,e,n){if(n===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof n=="function"?{ref:n}:{ref:n,code:(0,Ke.stringify)(n)})}function Yh(t,e,n=!1){return!e.length||e.some(r=>r==="array"?Array.isArray(t):r==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==r||n&&typeof t=="undefined")}wt.validSchemaType=Yh;function Qh({schema:t,opts:e,self:n,errSchemaPath:r},s,i){if(Array.isArray(s.keyword)?!s.keyword.includes(i):s.keyword!==i)throw new Error("ajv implementation error");const o=s.dependencies;if(o!=null&&o.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${i}: ${o.join(",")}`);if(s.validateSchema&&!s.validateSchema(t[i])){const u=`keyword "${i}" value is invalid at path "${r}": `+n.errorsText(s.validateSchema.errors);if(e.validateSchema==="log")n.logger.error(u);else throw new Error(u)}}wt.validateKeywordUsage=Qh;var Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});Lt.extendSubschemaMode=Lt.extendSubschemaData=Lt.getSubschema=void 0;const $t=ae,Ga=pe;function Jh(t,{keyword:e,schemaProp:n,schema:r,schemaPath:s,errSchemaPath:i,topSchemaRef:o}){if(e!==void 0&&r!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){const a=t.schema[e];return n===void 0?{schema:a,schemaPath:(0,$t._)`${t.schemaPath}${(0,$t.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[n],schemaPath:(0,$t._)`${t.schemaPath}${(0,$t.getProperty)(e)}${(0,$t.getProperty)(n)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,Ga.escapeFragment)(n)}`}}if(r!==void 0){if(s===void 0||i===void 0||o===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:r,schemaPath:s,topSchemaRef:o,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')}Lt.getSubschema=Jh;function Xh(t,e,{dataProp:n,dataPropType:r,data:s,dataTypes:i,propertyName:o}){if(s!==void 0&&n!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:a}=e;if(n!==void 0){const{errorPath:l,dataPathArr:d,opts:c}=e,m=a.let("data",(0,$t._)`${e.data}${(0,$t.getProperty)(n)}`,!0);u(m),t.errorPath=(0,$t.str)`${l}${(0,Ga.getErrorPath)(n,r,c.jsPropertySyntax)}`,t.parentDataProperty=(0,$t._)`${n}`,t.dataPathArr=[...d,t.parentDataProperty]}if(s!==void 0){const l=s instanceof $t.Name?s:a.let("data",s,!0);u(l),o!==void 0&&(t.propertyName=o)}i&&(t.dataTypes=i);function u(l){t.data=l,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,l]}}Lt.extendSubschemaData=Xh;function Zh(t,{jtdDiscriminator:e,jtdMetadata:n,compositeRule:r,createErrors:s,allErrors:i}){r!==void 0&&(t.compositeRule=r),s!==void 0&&(t.createErrors=s),i!==void 0&&(t.allErrors=i),t.jtdDiscriminator=e,t.jtdMetadata=n}Lt.extendSubschemaMode=Zh;var xe={},Ya=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,s,i;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(s=r;s--!==0;)if(!t(e[s],n[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(i=Object.keys(e),r=i.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[s]))return!1;for(s=r;s--!==0;){var o=i[s];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n},Qa={exports:{}},jt=Qa.exports=function(t,e,n){typeof e=="function"&&(n=e,e={}),n=e.cb||n;var r=typeof n=="function"?n:n.pre||function(){},s=n.post||function(){};Mr(e,r,s,t,"",t)};jt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};jt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};jt.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};jt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Mr(t,e,n,r,s,i,o,a,u,l){if(r&&typeof r=="object"&&!Array.isArray(r)){e(r,s,i,o,a,u,l);for(var d in r){var c=r[d];if(Array.isArray(c)){if(d in jt.arrayKeywords)for(var m=0;m<c.length;m++)Mr(t,e,n,c[m],s+"/"+d+"/"+m,i,s,d,r,m)}else if(d in jt.propsKeywords){if(c&&typeof c=="object")for(var $ in c)Mr(t,e,n,c[$],s+"/"+d+"/"+ef($),i,s,d,r,$)}else(d in jt.keywords||t.allKeys&&!(d in jt.skipKeywords))&&Mr(t,e,n,c,s+"/"+d,i,s,d,r)}n(r,s,i,o,a,u,l)}}function ef(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(xe,"__esModule",{value:!0});xe.getSchemaRefs=xe.resolveUrl=xe.normalizeId=xe._getFullPath=xe.getFullPath=xe.inlineRef=void 0;const tf=pe,nf=Ya,rf=Qa.exports,sf=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function of(t,e=!0){return typeof t=="boolean"?!0:e===!0?!Fs(t):e?Ja(t)<=e:!1}xe.inlineRef=of;const af=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Fs(t){for(const e in t){if(af.has(e))return!0;const n=t[e];if(Array.isArray(n)&&n.some(Fs)||typeof n=="object"&&Fs(n))return!0}return!1}function Ja(t){let e=0;for(const n in t){if(n==="$ref")return 1/0;if(e++,!sf.has(n)&&(typeof t[n]=="object"&&(0,tf.eachItem)(t[n],r=>e+=Ja(r)),e===1/0))return 1/0}return e}function Xa(t,e="",n){n!==!1&&(e=wn(e));const r=t.parse(e);return Za(t,r)}xe.getFullPath=Xa;function Za(t,e){return t.serialize(e).split("#")[0]+"#"}xe._getFullPath=Za;const lf=/#\/?$/;function wn(t){return t?t.replace(lf,""):""}xe.normalizeId=wn;function uf(t,e,n){return n=wn(n),t.resolve(e,n)}xe.resolveUrl=uf;const cf=/^[a-z_][-a-z0-9._]*$/i;function df(t,e){if(typeof t=="boolean")return{};const{schemaId:n,uriResolver:r}=this.opts,s=wn(t[n]||e),i={"":s},o=Xa(r,s,!1),a={},u=new Set;return rf(t,{allKeys:!0},(c,m,$,v)=>{if(v===void 0)return;const S=o+m;let w=i[v];typeof c[n]=="string"&&(w=y.call(this,c[n])),I.call(this,c.$anchor),I.call(this,c.$dynamicAnchor),i[m]=w;function y(D){const O=this.opts.uriResolver.resolve;if(D=wn(w?O(w,D):D),u.has(D))throw d(D);u.add(D);let j=this.refs[D];return typeof j=="string"&&(j=this.refs[j]),typeof j=="object"?l(c,j.schema,D):D!==wn(S)&&(D[0]==="#"?(l(c,a[D],D),a[D]=c):this.refs[D]=S),D}function I(D){if(typeof D=="string"){if(!cf.test(D))throw new Error(`invalid anchor "${D}"`);y.call(this,`#${D}`)}}}),a;function l(c,m,$){if(m!==void 0&&!nf(c,m))throw d($)}function d(c){return new Error(`reference "${c}" resolves to more than one schema`)}}xe.getSchemaRefs=df;Object.defineProperty(ft,"__esModule",{value:!0});ft.getData=ft.KeywordCxt=ft.validateFunctionCode=void 0;const el=An,No=gr,ai=Dt,xr=gr,hf=ns,Zn=wt,_s=Lt,z=ae,te=St,ff=xe,Rt=pe,zn=_r;function pf(t){if(rl(t)&&(sl(t),nl(t))){gf(t);return}tl(t,()=>(0,el.topBoolOrEmptySchema)(t))}ft.validateFunctionCode=pf;function tl({gen:t,validateName:e,schema:n,schemaEnv:r,opts:s},i){s.code.es5?t.func(e,(0,z._)`${te.default.data}, ${te.default.valCxt}`,r.$async,()=>{t.code((0,z._)`"use strict"; ${Do(n,s)}`),_f(t,s),t.code(i)}):t.func(e,(0,z._)`${te.default.data}, ${mf(s)}`,r.$async,()=>t.code(Do(n,s)).code(i))}function mf(t){return(0,z._)`{${te.default.instancePath}="", ${te.default.parentData}, ${te.default.parentDataProperty}, ${te.default.rootData}=${te.default.data}${t.dynamicRef?(0,z._)`, ${te.default.dynamicAnchors}={}`:z.nil}}={}`}function _f(t,e){t.if(te.default.valCxt,()=>{t.var(te.default.instancePath,(0,z._)`${te.default.valCxt}.${te.default.instancePath}`),t.var(te.default.parentData,(0,z._)`${te.default.valCxt}.${te.default.parentData}`),t.var(te.default.parentDataProperty,(0,z._)`${te.default.valCxt}.${te.default.parentDataProperty}`),t.var(te.default.rootData,(0,z._)`${te.default.valCxt}.${te.default.rootData}`),e.dynamicRef&&t.var(te.default.dynamicAnchors,(0,z._)`${te.default.valCxt}.${te.default.dynamicAnchors}`)},()=>{t.var(te.default.instancePath,(0,z._)`""`),t.var(te.default.parentData,(0,z._)`undefined`),t.var(te.default.parentDataProperty,(0,z._)`undefined`),t.var(te.default.rootData,te.default.data),e.dynamicRef&&t.var(te.default.dynamicAnchors,(0,z._)`{}`)})}function gf(t){const{schema:e,opts:n,gen:r}=t;tl(t,()=>{n.$comment&&e.$comment&&ol(t),$f(t),r.let(te.default.vErrors,null),r.let(te.default.errors,0),n.unevaluated&&yf(t),il(t),Sf(t)})}function yf(t){const{gen:e,validateName:n}=t;t.evaluated=e.const("evaluated",(0,z._)`${n}.evaluated`),e.if((0,z._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,z._)`${t.evaluated}.props`,(0,z._)`undefined`)),e.if((0,z._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,z._)`${t.evaluated}.items`,(0,z._)`undefined`))}function Do(t,e){const n=typeof t=="object"&&t[e.schemaId];return n&&(e.code.source||e.code.process)?(0,z._)`/*# sourceURL=${n} */`:z.nil}function vf(t,e){if(rl(t)&&(sl(t),nl(t))){Ef(t,e);return}(0,el.boolOrEmptySchema)(t,e)}function nl({schema:t,self:e}){if(typeof t=="boolean")return!t;for(const n in t)if(e.RULES.all[n])return!0;return!1}function rl(t){return typeof t.schema!="boolean"}function Ef(t,e){const{schema:n,gen:r,opts:s}=t;s.$comment&&n.$comment&&ol(t),wf(t),Cf(t);const i=r.const("_errs",te.default.errors);il(t,i),r.var(e,(0,z._)`${i} === ${te.default.errors}`)}function sl(t){(0,Rt.checkUnknownRules)(t),bf(t)}function il(t,e){if(t.opts.jtd)return Ro(t,[],!1,e);const n=(0,No.getSchemaTypes)(t.schema),r=(0,No.coerceAndCheckDataType)(t,n);Ro(t,n,!r,e)}function bf(t){const{schema:e,errSchemaPath:n,opts:r,self:s}=t;e.$ref&&r.ignoreKeywordsWithRef&&(0,Rt.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${n}"`)}function $f(t){const{schema:e,opts:n}=t;e.default!==void 0&&n.useDefaults&&n.strictSchema&&(0,Rt.checkStrictMode)(t,"default is ignored in the schema root")}function wf(t){const e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,ff.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function Cf(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function ol({gen:t,schemaEnv:e,schema:n,errSchemaPath:r,opts:s}){const i=n.$comment;if(s.$comment===!0)t.code((0,z._)`${te.default.self}.logger.log(${i})`);else if(typeof s.$comment=="function"){const o=(0,z.str)`${r}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,z._)`${te.default.self}.opts.$comment(${i}, ${o}, ${a}.schema)`)}}function Sf(t){const{gen:e,schemaEnv:n,validateName:r,ValidationError:s,opts:i}=t;n.$async?e.if((0,z._)`${te.default.errors} === 0`,()=>e.return(te.default.data),()=>e.throw((0,z._)`new ${s}(${te.default.vErrors})`)):(e.assign((0,z._)`${r}.errors`,te.default.vErrors),i.unevaluated&&Af(t),e.return((0,z._)`${te.default.errors} === 0`))}function Af({gen:t,evaluated:e,props:n,items:r}){n instanceof z.Name&&t.assign((0,z._)`${e}.props`,n),r instanceof z.Name&&t.assign((0,z._)`${e}.items`,r)}function Ro(t,e,n,r){const{gen:s,schema:i,data:o,allErrors:a,opts:u,self:l}=t,{RULES:d}=l;if(i.$ref&&(u.ignoreKeywordsWithRef||!(0,Rt.schemaHasRulesButRef)(i,d))){s.block(()=>ll(t,"$ref",d.all.$ref.definition));return}u.jtd||Tf(t,e),s.block(()=>{for(const m of d.rules)c(m);c(d.post)});function c(m){!(0,ai.shouldUseGroup)(i,m)||(m.type?(s.if((0,xr.checkDataType)(m.type,o,u.strictNumbers)),Po(t,m),e.length===1&&e[0]===m.type&&n&&(s.else(),(0,xr.reportTypeError)(t)),s.endIf()):Po(t,m),a||s.if((0,z._)`${te.default.errors} === ${r||0}`))}}function Po(t,e){const{gen:n,schema:r,opts:{useDefaults:s}}=t;s&&(0,hf.assignDefaults)(t,e.type),n.block(()=>{for(const i of e.rules)(0,ai.shouldUseRule)(r,i)&&ll(t,i.keyword,i.definition,e.type)})}function Tf(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(If(t,e),t.opts.allowUnionTypes||Nf(t,e),Df(t,t.dataTypes))}function If(t,e){if(!!e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(n=>{ko(t.dataTypes,n)||li(t,`type "${n}" not allowed by context "${t.dataTypes.join(",")}"`)}),t.dataTypes=t.dataTypes.filter(n=>ko(e,n))}}function Nf(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&li(t,"use allowUnionTypes to allow union type keyword")}function Df(t,e){const n=t.self.RULES.all;for(const r in n){const s=n[r];if(typeof s=="object"&&(0,ai.shouldUseRule)(t.schema,s)){const{type:i}=s.definition;i.length&&!i.some(o=>Rf(e,o))&&li(t,`missing type "${i.join(",")}" for keyword "${r}"`)}}}function Rf(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function ko(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function li(t,e){e+=` at "${t.schemaEnv.baseId+t.errSchemaPath}" (strictTypes)`,(0,Rt.checkStrictMode)(t,e,t.opts.strictTypes)}class al{constructor(e,n,r){if((0,Zn.validateKeywordUsage)(e,n,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=n.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Rt.schemaRefOrVal)(e,this.schema,r,this.$data),this.schemaType=n.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=n,this.$data)this.schemaCode=e.gen.const("vSchema",ul(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,Zn.validSchemaType)(this.schema,n.schemaType,n.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(n.schemaType)}`);("code"in n?n.trackErrors:n.errors!==!1)&&(this.errsCount=e.gen.const("_errs",te.default.errors))}result(e,n,r){this.failResult((0,z.not)(e),n,r)}failResult(e,n,r){this.gen.if(e),r?r():this.error(),n?(this.gen.else(),n(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,n){this.failResult((0,z.not)(e),void 0,n)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:n}=this;this.fail((0,z._)`${n} !== undefined && (${(0,z.or)(this.invalid$data(),e)})`)}error(e,n,r){if(n){this.setParams(n),this._error(e,r),this.setParams({});return}this._error(e,r)}_error(e,n){(e?zn.reportExtraError:zn.reportError)(this,this.def.error,n)}$dataError(){(0,zn.reportError)(this,this.def.$dataError||zn.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,zn.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,n){n?Object.assign(this.params,e):this.params=e}block$data(e,n,r=z.nil){this.gen.block(()=>{this.check$data(e,r),n()})}check$data(e=z.nil,n=z.nil){if(!this.$data)return;const{gen:r,schemaCode:s,schemaType:i,def:o}=this;r.if((0,z.or)((0,z._)`${s} === undefined`,n)),e!==z.nil&&r.assign(e,!0),(i.length||o.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==z.nil&&r.assign(e,!1)),r.else()}invalid$data(){const{gen:e,schemaCode:n,schemaType:r,def:s,it:i}=this;return(0,z.or)(o(),a());function o(){if(r.length){if(!(n instanceof z.Name))throw new Error("ajv implementation error");const u=Array.isArray(r)?r:[r];return(0,z._)`${(0,xr.checkDataTypes)(u,n,i.opts.strictNumbers,xr.DataType.Wrong)}`}return z.nil}function a(){if(s.validateSchema){const u=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,z._)`!${u}(${n})`}return z.nil}}subschema(e,n){const r=(0,_s.getSubschema)(this.it,e);(0,_s.extendSubschemaData)(r,this.it,e),(0,_s.extendSubschemaMode)(r,e);const s=Tt(Be(Be({},this.it),r),{items:void 0,props:void 0});return vf(s,n),s}mergeEvaluated(e,n){const{it:r,gen:s}=this;!r.opts.unevaluated||(r.props!==!0&&e.props!==void 0&&(r.props=Rt.mergeEvaluated.props(s,e.props,r.props,n)),r.items!==!0&&e.items!==void 0&&(r.items=Rt.mergeEvaluated.items(s,e.items,r.items,n)))}mergeValidEvaluated(e,n){const{it:r,gen:s}=this;if(r.opts.unevaluated&&(r.props!==!0||r.items!==!0))return s.if(n,()=>this.mergeEvaluated(e,z.Name)),!0}}ft.KeywordCxt=al;function ll(t,e,n,r){const s=new al(t,n,e);"code"in n?n.code(s,r):s.$data&&n.validate?(0,Zn.funcKeywordCode)(s,n):"macro"in n?(0,Zn.macroKeywordCode)(s,n):(n.compile||n.validate)&&(0,Zn.funcKeywordCode)(s,n)}const Pf=/^\/(?:[^~]|~0|~1)*$/,kf=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function ul(t,{dataLevel:e,dataNames:n,dataPathArr:r}){let s,i;if(t==="")return te.default.rootData;if(t[0]==="/"){if(!Pf.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,i=te.default.rootData}else{const l=kf.exec(t);if(!l)throw new Error(`Invalid JSON-pointer: ${t}`);const d=+l[1];if(s=l[2],s==="#"){if(d>=e)throw new Error(u("property/index",d));return r[e-d]}if(d>e)throw new Error(u("data",d));if(i=n[e-d],!s)return i}let o=i;const a=s.split("/");for(const l of a)l&&(i=(0,z._)`${i}${(0,z.getProperty)((0,Rt.unescapeJsonPointer)(l))}`,o=(0,z._)`${o} && ${i}`);return o;function u(l,d){return`Cannot access ${l} ${d} levels up, current level is ${e}`}}ft.getData=ul;var rs={};Object.defineProperty(rs,"__esModule",{value:!0});class Of extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}rs.default=Of;var ss={};Object.defineProperty(ss,"__esModule",{value:!0});const gs=xe;class Ff extends Error{constructor(e,n,r,s){super(s||`can't resolve reference ${r} from id ${n}`),this.missingRef=(0,gs.resolveUrl)(e,n,r),this.missingSchema=(0,gs.normalizeId)((0,gs.getFullPath)(e,this.missingRef))}}ss.default=Ff;var Je={};Object.defineProperty(Je,"__esModule",{value:!0});Je.resolveSchema=Je.getCompilingSchema=Je.resolveRef=Je.compileSchema=Je.SchemaEnv=void 0;const at=ae,Mf=rs,Kt=St,ct=xe,Oo=pe,jf=ft;class is{constructor(e){var n;this.refs={},this.dynamicAnchors={};let r;typeof e.schema=="object"&&(r=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(n=e.baseId)!==null&&n!==void 0?n:(0,ct.normalizeId)(r==null?void 0:r[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=r==null?void 0:r.$async,this.refs={}}}Je.SchemaEnv=is;function ui(t){const e=cl.call(this,t);if(e)return e;const n=(0,ct.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:r,lines:s}=this.opts.code,{ownProperties:i}=this.opts,o=new at.CodeGen(this.scope,{es5:r,lines:s,ownProperties:i});let a;t.$async&&(a=o.scopeValue("Error",{ref:Mf.default,code:(0,at._)`require("ajv/dist/runtime/validation_error").default`}));const u=o.scopeName("validate");t.validateName=u;const l={gen:o,allErrors:this.opts.allErrors,data:Kt.default.data,parentData:Kt.default.parentData,parentDataProperty:Kt.default.parentDataProperty,dataNames:[Kt.default.data],dataPathArr:[at.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,at.stringify)(t.schema)}:{ref:t.schema}),validateName:u,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:n,baseId:t.baseId||n,schemaPath:at.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,at._)`""`,opts:this.opts,self:this};let d;try{this._compilations.add(t),(0,jf.validateFunctionCode)(l),o.optimize(this.opts.code.optimize);const c=o.toString();d=`${o.scopeRefs(Kt.default.scope)}return ${c}`,this.opts.code.process&&(d=this.opts.code.process(d,t));const $=new Function(`${Kt.default.self}`,`${Kt.default.scope}`,d)(this,this.scope.get());if(this.scope.value(u,{ref:$}),$.errors=null,$.schema=t.schema,$.schemaEnv=t,t.$async&&($.$async=!0),this.opts.code.source===!0&&($.source={validateName:u,validateCode:c,scopeValues:o._values}),this.opts.unevaluated){const{props:v,items:S}=l;$.evaluated={props:v instanceof at.Name?void 0:v,items:S instanceof at.Name?void 0:S,dynamicProps:v instanceof at.Name,dynamicItems:S instanceof at.Name},$.source&&($.source.evaluated=(0,at.stringify)($.evaluated))}return t.validate=$,t}catch(c){throw delete t.validate,delete t.validateName,d&&this.logger.error("Error compiling schema, function code:",d),c}finally{this._compilations.delete(t)}}Je.compileSchema=ui;function Bf(t,e,n){var r;n=(0,ct.resolveUrl)(this.opts.uriResolver,e,n);const s=t.refs[n];if(s)return s;let i=Vf.call(this,t,n);if(i===void 0){const o=(r=t.localRefs)===null||r===void 0?void 0:r[n],{schemaId:a}=this.opts;o&&(i=new is({schema:o,schemaId:a,root:t,baseId:e}))}if(i!==void 0)return t.refs[n]=Lf.call(this,i)}Je.resolveRef=Bf;function Lf(t){return(0,ct.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:ui.call(this,t)}function cl(t){for(const e of this._compilations)if(xf(e,t))return e}Je.getCompilingSchema=cl;function xf(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function Vf(t,e){let n;for(;typeof(n=this.refs[e])=="string";)e=n;return n||this.schemas[e]||os.call(this,t,e)}function os(t,e){const n=this.opts.uriResolver.parse(e),r=(0,ct._getFullPath)(this.opts.uriResolver,n);let s=(0,ct.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&r===s)return ys.call(this,n,t);const i=(0,ct.normalizeId)(r),o=this.refs[i]||this.schemas[i];if(typeof o=="string"){const a=os.call(this,t,o);return typeof(a==null?void 0:a.schema)!="object"?void 0:ys.call(this,n,a)}if(typeof(o==null?void 0:o.schema)=="object"){if(o.validate||ui.call(this,o),i===(0,ct.normalizeId)(e)){const{schema:a}=o,{schemaId:u}=this.opts,l=a[u];return l&&(s=(0,ct.resolveUrl)(this.opts.uriResolver,s,l)),new is({schema:a,schemaId:u,root:t,baseId:s})}return ys.call(this,n,o)}}Je.resolveSchema=os;const Uf=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function ys(t,{baseId:e,schema:n,root:r}){var s;if(((s=t.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(const a of t.fragment.slice(1).split("/")){if(typeof n=="boolean")return;const u=n[(0,Oo.unescapeFragment)(a)];if(u===void 0)return;n=u;const l=typeof n=="object"&&n[this.opts.schemaId];!Uf.has(a)&&l&&(e=(0,ct.resolveUrl)(this.opts.uriResolver,e,l))}let i;if(typeof n!="boolean"&&n.$ref&&!(0,Oo.schemaHasRulesButRef)(n,this.RULES)){const a=(0,ct.resolveUrl)(this.opts.uriResolver,e,n.$ref);i=os.call(this,r,a)}const{schemaId:o}=this.opts;if(i=i||new is({schema:n,schemaId:o,root:r,baseId:e}),i.schema!==i.root.schema)return i}const qf="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",Hf="Meta-schema for $data reference (JSON AnySchema extension proposal)",Wf="object",zf=["$data"],Kf={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},Gf=!1;var Yf={$id:qf,description:Hf,type:Wf,required:zf,properties:Kf,additionalProperties:Gf},ci={},Ms={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(t,e){(function(n,r){r(e)})(La,function(n){function r(){for(var _=arguments.length,f=Array(_),g=0;g<_;g++)f[g]=arguments[g];if(f.length>1){f[0]=f[0].slice(0,-1);for(var N=f.length-1,T=1;T<N;++T)f[T]=f[T].slice(1,-1);return f[N]=f[N].slice(1),f.join("")}else return f[0]}function s(_){return"(?:"+_+")"}function i(_){return _===void 0?"undefined":_===null?"null":Object.prototype.toString.call(_).split(" ").pop().split("]").shift().toLowerCase()}function o(_){return _.toUpperCase()}function a(_){return _!=null?_ instanceof Array?_:typeof _.length!="number"||_.split||_.setInterval||_.call?[_]:Array.prototype.slice.call(_):[]}function u(_,f){var g=_;if(f)for(var N in f)g[N]=f[N];return g}function l(_){var f="[A-Za-z]",g="[0-9]",N=r(g,"[A-Fa-f]"),T=s(s("%[EFef]"+N+"%"+N+N+"%"+N+N)+"|"+s("%[89A-Fa-f]"+N+"%"+N+N)+"|"+s("%"+N+N)),K="[\\:\\/\\?\\#\\[\\]\\@]",G="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",de=r(K,G),$e=_?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",Re=_?"[\\uE000-\\uF8FF]":"[]",ue=r(f,g,"[\\-\\.\\_\\~]",$e);s(f+r(f,g,"[\\+\\-\\.]")+"*"),s(s(T+"|"+r(ue,G,"[\\:]"))+"*");var Ee=s(s("25[0-5]")+"|"+s("2[0-4]"+g)+"|"+s("1"+g+g)+"|"+s("0?[1-9]"+g)+"|0?0?"+g),Pe=s(Ee+"\\."+Ee+"\\."+Ee+"\\."+Ee),re=s(N+"{1,4}"),Te=s(s(re+"\\:"+re)+"|"+Pe),Oe=s(s(re+"\\:")+"{6}"+Te),Ie=s("\\:\\:"+s(re+"\\:")+"{5}"+Te),Ot=s(s(re)+"?\\:\\:"+s(re+"\\:")+"{4}"+Te),yt=s(s(s(re+"\\:")+"{0,1}"+re)+"?\\:\\:"+s(re+"\\:")+"{3}"+Te),vt=s(s(s(re+"\\:")+"{0,2}"+re)+"?\\:\\:"+s(re+"\\:")+"{2}"+Te),_n=s(s(s(re+"\\:")+"{0,3}"+re)+"?\\:\\:"+re+"\\:"+Te),Wt=s(s(s(re+"\\:")+"{0,4}"+re)+"?\\:\\:"+Te),nt=s(s(s(re+"\\:")+"{0,5}"+re)+"?\\:\\:"+re),Et=s(s(s(re+"\\:")+"{0,6}"+re)+"?\\:\\:"),zt=s([Oe,Ie,Ot,yt,vt,_n,Wt,nt,Et].join("|")),At=s(s(ue+"|"+T)+"+");s("[vV]"+N+"+\\."+r(ue,G,"[\\:]")+"+"),s(s(T+"|"+r(ue,G))+"*");var Hn=s(T+"|"+r(ue,G,"[\\:\\@]"));return s(s(T+"|"+r(ue,G,"[\\@]"))+"+"),s(s(Hn+"|"+r("[\\/\\?]",Re))+"*"),{NOT_SCHEME:new RegExp(r("[^]",f,g,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(r("[^\\%\\:]",ue,G),"g"),NOT_HOST:new RegExp(r("[^\\%\\[\\]\\:]",ue,G),"g"),NOT_PATH:new RegExp(r("[^\\%\\/\\:\\@]",ue,G),"g"),NOT_PATH_NOSCHEME:new RegExp(r("[^\\%\\/\\@]",ue,G),"g"),NOT_QUERY:new RegExp(r("[^\\%]",ue,G,"[\\:\\@\\/\\?]",Re),"g"),NOT_FRAGMENT:new RegExp(r("[^\\%]",ue,G,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(r("[^]",ue,G),"g"),UNRESERVED:new RegExp(ue,"g"),OTHER_CHARS:new RegExp(r("[^\\%]",ue,de),"g"),PCT_ENCODED:new RegExp(T,"g"),IPV4ADDRESS:new RegExp("^("+Pe+")$"),IPV6ADDRESS:new RegExp("^\\[?("+zt+")"+s(s("\\%25|\\%(?!"+N+"{2})")+"("+At+")")+"?\\]?$")}}var d=l(!1),c=l(!0),m=function(){function _(f,g){var N=[],T=!0,K=!1,G=void 0;try{for(var de=f[Symbol.iterator](),$e;!(T=($e=de.next()).done)&&(N.push($e.value),!(g&&N.length===g));T=!0);}catch(Re){K=!0,G=Re}finally{try{!T&&de.return&&de.return()}finally{if(K)throw G}}return N}return function(f,g){if(Array.isArray(f))return f;if(Symbol.iterator in Object(f))return _(f,g);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),$=function(_){if(Array.isArray(_)){for(var f=0,g=Array(_.length);f<_.length;f++)g[f]=_[f];return g}else return Array.from(_)},v=2147483647,S=36,w=1,y=26,I=38,D=700,O=72,j=128,A="-",R=/^xn--/,M=/[^\0-\x7E]/,W=/[\x2E\u3002\uFF0E\uFF61]/g,H={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ge=S-w,le=Math.floor,Y=String.fromCharCode;function B(_){throw new RangeError(H[_])}function L(_,f){for(var g=[],N=_.length;N--;)g[N]=f(_[N]);return g}function X(_,f){var g=_.split("@"),N="";g.length>1&&(N=g[0]+"@",_=g[1]),_=_.replace(W,".");var T=_.split("."),K=L(T,f).join(".");return N+K}function U(_){for(var f=[],g=0,N=_.length;g<N;){var T=_.charCodeAt(g++);if(T>=55296&&T<=56319&&g<N){var K=_.charCodeAt(g++);(K&64512)==56320?f.push(((T&1023)<<10)+(K&1023)+65536):(f.push(T),g--)}else f.push(T)}return f}var ee=function(f){return String.fromCodePoint.apply(String,$(f))},Z=function(f){return f-48<10?f-22:f-65<26?f-65:f-97<26?f-97:S},F=function(f,g){return f+22+75*(f<26)-((g!=0)<<5)},b=function(f,g,N){var T=0;for(f=N?le(f/D):f>>1,f+=le(f/g);f>ge*y>>1;T+=S)f=le(f/ge);return le(T+(ge+1)*f/(f+I))},k=function(f){var g=[],N=f.length,T=0,K=j,G=O,de=f.lastIndexOf(A);de<0&&(de=0);for(var $e=0;$e<de;++$e)f.charCodeAt($e)>=128&&B("not-basic"),g.push(f.charCodeAt($e));for(var Re=de>0?de+1:0;Re<N;){for(var ue=T,Ee=1,Pe=S;;Pe+=S){Re>=N&&B("invalid-input");var re=Z(f.charCodeAt(Re++));(re>=S||re>le((v-T)/Ee))&&B("overflow"),T+=re*Ee;var Te=Pe<=G?w:Pe>=G+y?y:Pe-G;if(re<Te)break;var Oe=S-Te;Ee>le(v/Oe)&&B("overflow"),Ee*=Oe}var Ie=g.length+1;G=b(T-ue,Ie,ue==0),le(T/Ie)>v-K&&B("overflow"),K+=le(T/Ie),T%=Ie,g.splice(T++,0,K)}return String.fromCodePoint.apply(String,g)},C=function(f){var g=[];f=U(f);var N=f.length,T=j,K=0,G=O,de=!0,$e=!1,Re=void 0;try{for(var ue=f[Symbol.iterator](),Ee;!(de=(Ee=ue.next()).done);de=!0){var Pe=Ee.value;Pe<128&&g.push(Y(Pe))}}catch(Wn){$e=!0,Re=Wn}finally{try{!de&&ue.return&&ue.return()}finally{if($e)throw Re}}var re=g.length,Te=re;for(re&&g.push(A);Te<N;){var Oe=v,Ie=!0,Ot=!1,yt=void 0;try{for(var vt=f[Symbol.iterator](),_n;!(Ie=(_n=vt.next()).done);Ie=!0){var Wt=_n.value;Wt>=T&&Wt<Oe&&(Oe=Wt)}}catch(Wn){Ot=!0,yt=Wn}finally{try{!Ie&&vt.return&&vt.return()}finally{if(Ot)throw yt}}var nt=Te+1;Oe-T>le((v-K)/nt)&&B("overflow"),K+=(Oe-T)*nt,T=Oe;var Et=!0,zt=!1,At=void 0;try{for(var Hn=f[Symbol.iterator](),bo;!(Et=(bo=Hn.next()).done);Et=!0){var $o=bo.value;if($o<T&&++K>v&&B("overflow"),$o==T){for(var Ar=K,Tr=S;;Tr+=S){var Ir=Tr<=G?w:Tr>=G+y?y:Tr-G;if(Ar<Ir)break;var wo=Ar-Ir,Co=S-Ir;g.push(Y(F(Ir+wo%Co,0))),Ar=le(wo/Co)}g.push(Y(F(Ar,0))),G=b(K,nt,Te==re),K=0,++Te}}}catch(Wn){zt=!0,At=Wn}finally{try{!Et&&Hn.return&&Hn.return()}finally{if(zt)throw At}}++K,++T}return g.join("")},h=function(f){return X(f,function(g){return R.test(g)?k(g.slice(4).toLowerCase()):g})},p=function(f){return X(f,function(g){return M.test(g)?"xn--"+C(g):g})},P={version:"2.1.0",ucs2:{decode:U,encode:ee},decode:k,encode:C,toASCII:p,toUnicode:h},x={};function q(_){var f=_.charCodeAt(0),g=void 0;return f<16?g="%0"+f.toString(16).toUpperCase():f<128?g="%"+f.toString(16).toUpperCase():f<2048?g="%"+(f>>6|192).toString(16).toUpperCase()+"%"+(f&63|128).toString(16).toUpperCase():g="%"+(f>>12|224).toString(16).toUpperCase()+"%"+(f>>6&63|128).toString(16).toUpperCase()+"%"+(f&63|128).toString(16).toUpperCase(),g}function Q(_){for(var f="",g=0,N=_.length;g<N;){var T=parseInt(_.substr(g+1,2),16);if(T<128)f+=String.fromCharCode(T),g+=3;else if(T>=194&&T<224){if(N-g>=6){var K=parseInt(_.substr(g+4,2),16);f+=String.fromCharCode((T&31)<<6|K&63)}else f+=_.substr(g,6);g+=6}else if(T>=224){if(N-g>=9){var G=parseInt(_.substr(g+4,2),16),de=parseInt(_.substr(g+7,2),16);f+=String.fromCharCode((T&15)<<12|(G&63)<<6|de&63)}else f+=_.substr(g,9);g+=9}else f+=_.substr(g,3),g+=3}return f}function ne(_,f){function g(N){var T=Q(N);return T.match(f.UNRESERVED)?T:N}return _.scheme&&(_.scheme=String(_.scheme).replace(f.PCT_ENCODED,g).toLowerCase().replace(f.NOT_SCHEME,"")),_.userinfo!==void 0&&(_.userinfo=String(_.userinfo).replace(f.PCT_ENCODED,g).replace(f.NOT_USERINFO,q).replace(f.PCT_ENCODED,o)),_.host!==void 0&&(_.host=String(_.host).replace(f.PCT_ENCODED,g).toLowerCase().replace(f.NOT_HOST,q).replace(f.PCT_ENCODED,o)),_.path!==void 0&&(_.path=String(_.path).replace(f.PCT_ENCODED,g).replace(_.scheme?f.NOT_PATH:f.NOT_PATH_NOSCHEME,q).replace(f.PCT_ENCODED,o)),_.query!==void 0&&(_.query=String(_.query).replace(f.PCT_ENCODED,g).replace(f.NOT_QUERY,q).replace(f.PCT_ENCODED,o)),_.fragment!==void 0&&(_.fragment=String(_.fragment).replace(f.PCT_ENCODED,g).replace(f.NOT_FRAGMENT,q).replace(f.PCT_ENCODED,o)),_}function ve(_){return _.replace(/^0*(.*)/,"$1")||"0"}function ze(_,f){var g=_.match(f.IPV4ADDRESS)||[],N=m(g,2),T=N[1];return T?T.split(".").map(ve).join("."):_}function cn(_,f){var g=_.match(f.IPV6ADDRESS)||[],N=m(g,3),T=N[1],K=N[2];if(T){for(var G=T.toLowerCase().split("::").reverse(),de=m(G,2),$e=de[0],Re=de[1],ue=Re?Re.split(":").map(ve):[],Ee=$e.split(":").map(ve),Pe=f.IPV4ADDRESS.test(Ee[Ee.length-1]),re=Pe?7:8,Te=Ee.length-re,Oe=Array(re),Ie=0;Ie<re;++Ie)Oe[Ie]=ue[Ie]||Ee[Te+Ie]||"";Pe&&(Oe[re-1]=ze(Oe[re-1],f));var Ot=Oe.reduce(function(nt,Et,zt){if(!Et||Et==="0"){var At=nt[nt.length-1];At&&At.index+At.length===zt?At.length++:nt.push({index:zt,length:1})}return nt},[]),yt=Ot.sort(function(nt,Et){return Et.length-nt.length})[0],vt=void 0;if(yt&&yt.length>1){var _n=Oe.slice(0,yt.index),Wt=Oe.slice(yt.index+yt.length);vt=_n.join(":")+"::"+Wt.join(":")}else vt=Oe.join(":");return K&&(vt+="%"+K),vt}else return _}var jn=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Bn="".match(/(){0}/)[1]===void 0;function Ze(_){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g={},N=f.iri!==!1?c:d;f.reference==="suffix"&&(_=(f.scheme?f.scheme+":":"")+"//"+_);var T=_.match(jn);if(T){Bn?(g.scheme=T[1],g.userinfo=T[3],g.host=T[4],g.port=parseInt(T[5],10),g.path=T[6]||"",g.query=T[7],g.fragment=T[8],isNaN(g.port)&&(g.port=T[5])):(g.scheme=T[1]||void 0,g.userinfo=_.indexOf("@")!==-1?T[3]:void 0,g.host=_.indexOf("//")!==-1?T[4]:void 0,g.port=parseInt(T[5],10),g.path=T[6]||"",g.query=_.indexOf("?")!==-1?T[7]:void 0,g.fragment=_.indexOf("#")!==-1?T[8]:void 0,isNaN(g.port)&&(g.port=_.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?T[4]:void 0)),g.host&&(g.host=cn(ze(g.host,N),N)),g.scheme===void 0&&g.userinfo===void 0&&g.host===void 0&&g.port===void 0&&!g.path&&g.query===void 0?g.reference="same-document":g.scheme===void 0?g.reference="relative":g.fragment===void 0?g.reference="absolute":g.reference="uri",f.reference&&f.reference!=="suffix"&&f.reference!==g.reference&&(g.error=g.error||"URI is not a "+f.reference+" reference.");var K=x[(f.scheme||g.scheme||"").toLowerCase()];if(!f.unicodeSupport&&(!K||!K.unicodeSupport)){if(g.host&&(f.domainHost||K&&K.domainHost))try{g.host=P.toASCII(g.host.replace(N.PCT_ENCODED,Q).toLowerCase())}catch(G){g.error=g.error||"Host's domain name can not be converted to ASCII via punycode: "+G}ne(g,d)}else ne(g,N);K&&K.parse&&K.parse(g,f)}else g.error=g.error||"URI can not be parsed.";return g}function Ln(_,f){var g=f.iri!==!1?c:d,N=[];return _.userinfo!==void 0&&(N.push(_.userinfo),N.push("@")),_.host!==void 0&&N.push(cn(ze(String(_.host),g),g).replace(g.IPV6ADDRESS,function(T,K,G){return"["+K+(G?"%25"+G:"")+"]"})),(typeof _.port=="number"||typeof _.port=="string")&&(N.push(":"),N.push(String(_.port))),N.length?N.join(""):void 0}var dn=/^\.\.?\//,hn=/^\/\.(\/|$)/,fn=/^\/\.\.(\/|$)/,xn=/^\/?(?:.|\n)*?(?=\/|$)/;function _t(_){for(var f=[];_.length;)if(_.match(dn))_=_.replace(dn,"");else if(_.match(hn))_=_.replace(hn,"/");else if(_.match(fn))_=_.replace(fn,"/"),f.pop();else if(_==="."||_==="..")_="";else{var g=_.match(xn);if(g){var N=g[0];_=_.slice(N.length),f.push(N)}else throw new Error("Unexpected dot segment condition")}return f.join("")}function Ye(_){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=f.iri?c:d,N=[],T=x[(f.scheme||_.scheme||"").toLowerCase()];if(T&&T.serialize&&T.serialize(_,f),_.host&&!g.IPV6ADDRESS.test(_.host)){if(f.domainHost||T&&T.domainHost)try{_.host=f.iri?P.toUnicode(_.host):P.toASCII(_.host.replace(g.PCT_ENCODED,Q).toLowerCase())}catch(de){_.error=_.error||"Host's domain name can not be converted to "+(f.iri?"Unicode":"ASCII")+" via punycode: "+de}}ne(_,g),f.reference!=="suffix"&&_.scheme&&(N.push(_.scheme),N.push(":"));var K=Ln(_,f);if(K!==void 0&&(f.reference!=="suffix"&&N.push("//"),N.push(K),_.path&&_.path.charAt(0)!=="/"&&N.push("/")),_.path!==void 0){var G=_.path;!f.absolutePath&&(!T||!T.absolutePath)&&(G=_t(G)),K===void 0&&(G=G.replace(/^\/\//,"/%2F")),N.push(G)}return _.query!==void 0&&(N.push("?"),N.push(_.query)),_.fragment!==void 0&&(N.push("#"),N.push(_.fragment)),N.join("")}function pn(_,f){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},N=arguments[3],T={};return N||(_=Ze(Ye(_,g),g),f=Ze(Ye(f,g),g)),g=g||{},!g.tolerant&&f.scheme?(T.scheme=f.scheme,T.userinfo=f.userinfo,T.host=f.host,T.port=f.port,T.path=_t(f.path||""),T.query=f.query):(f.userinfo!==void 0||f.host!==void 0||f.port!==void 0?(T.userinfo=f.userinfo,T.host=f.host,T.port=f.port,T.path=_t(f.path||""),T.query=f.query):(f.path?(f.path.charAt(0)==="/"?T.path=_t(f.path):((_.userinfo!==void 0||_.host!==void 0||_.port!==void 0)&&!_.path?T.path="/"+f.path:_.path?T.path=_.path.slice(0,_.path.lastIndexOf("/")+1)+f.path:T.path=f.path,T.path=_t(T.path)),T.query=f.query):(T.path=_.path,f.query!==void 0?T.query=f.query:T.query=_.query),T.userinfo=_.userinfo,T.host=_.host,T.port=_.port),T.scheme=_.scheme),T.fragment=f.fragment,T}function Vn(_,f,g){var N=u({scheme:"null"},g);return Ye(pn(Ze(_,N),Ze(f,N),N,!0),N)}function qt(_,f){return typeof _=="string"?_=Ye(Ze(_,f),f):i(_)==="object"&&(_=Ze(Ye(_,f),f)),_}function Un(_,f,g){return typeof _=="string"?_=Ye(Ze(_,g),g):i(_)==="object"&&(_=Ye(_,g)),typeof f=="string"?f=Ye(Ze(f,g),g):i(f)==="object"&&(f=Ye(f,g)),_===f}function Sr(_,f){return _&&_.toString().replace(!f||!f.iri?d.ESCAPE:c.ESCAPE,q)}function tt(_,f){return _&&_.toString().replace(!f||!f.iri?d.PCT_ENCODED:c.PCT_ENCODED,Q)}var Ht={scheme:"http",domainHost:!0,parse:function(f,g){return f.host||(f.error=f.error||"HTTP URIs must have a host."),f},serialize:function(f,g){var N=String(f.scheme).toLowerCase()==="https";return(f.port===(N?443:80)||f.port==="")&&(f.port=void 0),f.path||(f.path="/"),f}},fo={scheme:"https",domainHost:Ht.domainHost,parse:Ht.parse,serialize:Ht.serialize};function po(_){return typeof _.secure=="boolean"?_.secure:String(_.scheme).toLowerCase()==="wss"}var qn={scheme:"ws",domainHost:!0,parse:function(f,g){var N=f;return N.secure=po(N),N.resourceName=(N.path||"/")+(N.query?"?"+N.query:""),N.path=void 0,N.query=void 0,N},serialize:function(f,g){if((f.port===(po(f)?443:80)||f.port==="")&&(f.port=void 0),typeof f.secure=="boolean"&&(f.scheme=f.secure?"wss":"ws",f.secure=void 0),f.resourceName){var N=f.resourceName.split("?"),T=m(N,2),K=T[0],G=T[1];f.path=K&&K!=="/"?K:void 0,f.query=G,f.resourceName=void 0}return f.fragment=void 0,f}},mo={scheme:"wss",domainHost:qn.domainHost,parse:qn.parse,serialize:qn.serialize},Gu={},_o="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",gt="[0-9A-Fa-f]",Yu=s(s("%[EFef]"+gt+"%"+gt+gt+"%"+gt+gt)+"|"+s("%[89A-Fa-f]"+gt+"%"+gt+gt)+"|"+s("%"+gt+gt)),Qu="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Ju="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Xu=r(Ju,'[\\"\\\\]'),Zu="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",ec=new RegExp(_o,"g"),mn=new RegExp(Yu,"g"),tc=new RegExp(r("[^]",Qu,"[\\.]",'[\\"]',Xu),"g"),go=new RegExp(r("[^]",_o,Zu),"g"),nc=go;function ps(_){var f=Q(_);return f.match(ec)?f:_}var yo={scheme:"mailto",parse:function(f,g){var N=f,T=N.to=N.path?N.path.split(","):[];if(N.path=void 0,N.query){for(var K=!1,G={},de=N.query.split("&"),$e=0,Re=de.length;$e<Re;++$e){var ue=de[$e].split("=");switch(ue[0]){case"to":for(var Ee=ue[1].split(","),Pe=0,re=Ee.length;Pe<re;++Pe)T.push(Ee[Pe]);break;case"subject":N.subject=tt(ue[1],g);break;case"body":N.body=tt(ue[1],g);break;default:K=!0,G[tt(ue[0],g)]=tt(ue[1],g);break}}K&&(N.headers=G)}N.query=void 0;for(var Te=0,Oe=T.length;Te<Oe;++Te){var Ie=T[Te].split("@");if(Ie[0]=tt(Ie[0]),g.unicodeSupport)Ie[1]=tt(Ie[1],g).toLowerCase();else try{Ie[1]=P.toASCII(tt(Ie[1],g).toLowerCase())}catch(Ot){N.error=N.error||"Email address's domain name can not be converted to ASCII via punycode: "+Ot}T[Te]=Ie.join("@")}return N},serialize:function(f,g){var N=f,T=a(f.to);if(T){for(var K=0,G=T.length;K<G;++K){var de=String(T[K]),$e=de.lastIndexOf("@"),Re=de.slice(0,$e).replace(mn,ps).replace(mn,o).replace(tc,q),ue=de.slice($e+1);try{ue=g.iri?P.toUnicode(ue):P.toASCII(tt(ue,g).toLowerCase())}catch(Te){N.error=N.error||"Email address's domain name can not be converted to "+(g.iri?"Unicode":"ASCII")+" via punycode: "+Te}T[K]=Re+"@"+ue}N.path=T.join(",")}var Ee=f.headers=f.headers||{};f.subject&&(Ee.subject=f.subject),f.body&&(Ee.body=f.body);var Pe=[];for(var re in Ee)Ee[re]!==Gu[re]&&Pe.push(re.replace(mn,ps).replace(mn,o).replace(go,q)+"="+Ee[re].replace(mn,ps).replace(mn,o).replace(nc,q));return Pe.length&&(N.query=Pe.join("&")),N}},rc=/^([^\:]+)\:(.*)/,vo={scheme:"urn",parse:function(f,g){var N=f.path&&f.path.match(rc),T=f;if(N){var K=g.scheme||T.scheme||"urn",G=N[1].toLowerCase(),de=N[2],$e=K+":"+(g.nid||G),Re=x[$e];T.nid=G,T.nss=de,T.path=void 0,Re&&(T=Re.parse(T,g))}else T.error=T.error||"URN can not be parsed.";return T},serialize:function(f,g){var N=g.scheme||f.scheme||"urn",T=f.nid,K=N+":"+(g.nid||T),G=x[K];G&&(f=G.serialize(f,g));var de=f,$e=f.nss;return de.path=(T||g.nid)+":"+$e,de}},sc=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Eo={scheme:"urn:uuid",parse:function(f,g){var N=f;return N.uuid=N.nss,N.nss=void 0,!g.tolerant&&(!N.uuid||!N.uuid.match(sc))&&(N.error=N.error||"UUID is not valid."),N},serialize:function(f,g){var N=f;return N.nss=(f.uuid||"").toLowerCase(),N}};x[Ht.scheme]=Ht,x[fo.scheme]=fo,x[qn.scheme]=qn,x[mo.scheme]=mo,x[yo.scheme]=yo,x[vo.scheme]=vo,x[Eo.scheme]=Eo,n.SCHEMES=x,n.pctEncChar=q,n.pctDecChars=Q,n.parse=Ze,n.removeDotSegments=_t,n.serialize=Ye,n.resolveComponents=pn,n.resolve=Vn,n.normalize=qt,n.equal=Un,n.escapeComponent=Sr,n.unescapeComponent=tt,Object.defineProperty(n,"__esModule",{value:!0})})})(Ms,Ms.exports);Object.defineProperty(ci,"__esModule",{value:!0});const dl=Ms.exports;dl.code='require("ajv/dist/runtime/uri").default';ci.default=dl;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var e=ft;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return e.KeywordCxt}});var n=ae;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return n.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return n.CodeGen}});const r=rs,s=ss,i=en,o=Je,a=ae,u=xe,l=gr,d=pe,c=Yf,m=ci,$=(F,b)=>new RegExp(F,b);$.code="new RegExp";const v=["removeAdditional","useDefaults","coerceTypes"],S=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),w={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},y={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},I=200;function D(F){var b,k,C,h,p,P,x,q,Q,ne,ve,ze,cn,jn,Bn,Ze,Ln,dn,hn,fn,xn,_t,Ye,pn,Vn;const qt=F.strict,Un=(b=F.code)===null||b===void 0?void 0:b.optimize,Sr=Un===!0||Un===void 0?1:Un||0,tt=(C=(k=F.code)===null||k===void 0?void 0:k.regExp)!==null&&C!==void 0?C:$,Ht=(h=F.uriResolver)!==null&&h!==void 0?h:m.default;return{strictSchema:(P=(p=F.strictSchema)!==null&&p!==void 0?p:qt)!==null&&P!==void 0?P:!0,strictNumbers:(q=(x=F.strictNumbers)!==null&&x!==void 0?x:qt)!==null&&q!==void 0?q:!0,strictTypes:(ne=(Q=F.strictTypes)!==null&&Q!==void 0?Q:qt)!==null&&ne!==void 0?ne:"log",strictTuples:(ze=(ve=F.strictTuples)!==null&&ve!==void 0?ve:qt)!==null&&ze!==void 0?ze:"log",strictRequired:(jn=(cn=F.strictRequired)!==null&&cn!==void 0?cn:qt)!==null&&jn!==void 0?jn:!1,code:F.code?Tt(Be({},F.code),{optimize:Sr,regExp:tt}):{optimize:Sr,regExp:tt},loopRequired:(Bn=F.loopRequired)!==null&&Bn!==void 0?Bn:I,loopEnum:(Ze=F.loopEnum)!==null&&Ze!==void 0?Ze:I,meta:(Ln=F.meta)!==null&&Ln!==void 0?Ln:!0,messages:(dn=F.messages)!==null&&dn!==void 0?dn:!0,inlineRefs:(hn=F.inlineRefs)!==null&&hn!==void 0?hn:!0,schemaId:(fn=F.schemaId)!==null&&fn!==void 0?fn:"$id",addUsedSchema:(xn=F.addUsedSchema)!==null&&xn!==void 0?xn:!0,validateSchema:(_t=F.validateSchema)!==null&&_t!==void 0?_t:!0,validateFormats:(Ye=F.validateFormats)!==null&&Ye!==void 0?Ye:!0,unicodeRegExp:(pn=F.unicodeRegExp)!==null&&pn!==void 0?pn:!0,int32range:(Vn=F.int32range)!==null&&Vn!==void 0?Vn:!0,uriResolver:Ht}}class O{constructor(b={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,b=this.opts=Be(Be({},b),D(b));const{es5:k,lines:C}=this.opts.code;this.scope=new a.ValueScope({scope:{},prefixes:S,es5:k,lines:C}),this.logger=le(b.logger);const h=b.validateFormats;b.validateFormats=!1,this.RULES=(0,i.getRules)(),j.call(this,w,b,"NOT SUPPORTED"),j.call(this,y,b,"DEPRECATED","warn"),this._metaOpts=H.call(this),b.formats&&M.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),b.keywords&&W.call(this,b.keywords),typeof b.meta=="object"&&this.addMetaSchema(b.meta),R.call(this),b.validateFormats=h}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:b,meta:k,schemaId:C}=this.opts;let h=c;C==="id"&&(h=Be({},c),h.id=h.$id,delete h.$id),k&&b&&this.addMetaSchema(h,h[C],!1)}defaultMeta(){const{meta:b,schemaId:k}=this.opts;return this.opts.defaultMeta=typeof b=="object"?b[k]||b:void 0}validate(b,k){let C;if(typeof b=="string"){if(C=this.getSchema(b),!C)throw new Error(`no schema with key or ref "${b}"`)}else C=this.compile(b);const h=C(k);return"$async"in C||(this.errors=C.errors),h}compile(b,k){const C=this._addSchema(b,k);return C.validate||this._compileSchemaEnv(C)}compileAsync(b,k){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:C}=this.opts;return h.call(this,b,k);async function h(ne,ve){await p.call(this,ne.$schema);const ze=this._addSchema(ne,ve);return ze.validate||P.call(this,ze)}async function p(ne){ne&&!this.getSchema(ne)&&await h.call(this,{$ref:ne},!0)}async function P(ne){try{return this._compileSchemaEnv(ne)}catch(ve){if(!(ve instanceof s.default))throw ve;return x.call(this,ve),await q.call(this,ve.missingSchema),P.call(this,ne)}}function x({missingSchema:ne,missingRef:ve}){if(this.refs[ne])throw new Error(`AnySchema ${ne} is loaded but ${ve} cannot be resolved`)}async function q(ne){const ve=await Q.call(this,ne);this.refs[ne]||await p.call(this,ve.$schema),this.refs[ne]||this.addSchema(ve,ne,k)}async function Q(ne){const ve=this._loading[ne];if(ve)return ve;try{return await(this._loading[ne]=C(ne))}finally{delete this._loading[ne]}}}addSchema(b,k,C,h=this.opts.validateSchema){if(Array.isArray(b)){for(const P of b)this.addSchema(P,void 0,C,h);return this}let p;if(typeof b=="object"){const{schemaId:P}=this.opts;if(p=b[P],p!==void 0&&typeof p!="string")throw new Error(`schema ${P} must be string`)}return k=(0,u.normalizeId)(k||p),this._checkUnique(k),this.schemas[k]=this._addSchema(b,C,k,h,!0),this}addMetaSchema(b,k,C=this.opts.validateSchema){return this.addSchema(b,k,!0,C),this}validateSchema(b,k){if(typeof b=="boolean")return!0;let C;if(C=b.$schema,C!==void 0&&typeof C!="string")throw new Error("$schema must be a string");if(C=C||this.opts.defaultMeta||this.defaultMeta(),!C)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const h=this.validate(C,b);if(!h&&k){const p="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(p);else throw new Error(p)}return h}getSchema(b){let k;for(;typeof(k=A.call(this,b))=="string";)b=k;if(k===void 0){const{schemaId:C}=this.opts,h=new o.SchemaEnv({schema:{},schemaId:C});if(k=o.resolveSchema.call(this,h,b),!k)return;this.refs[b]=k}return k.validate||this._compileSchemaEnv(k)}removeSchema(b){if(b instanceof RegExp)return this._removeAllSchemas(this.schemas,b),this._removeAllSchemas(this.refs,b),this;switch(typeof b){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const k=A.call(this,b);return typeof k=="object"&&this._cache.delete(k.schema),delete this.schemas[b],delete this.refs[b],this}case"object":{const k=b;this._cache.delete(k);let C=b[this.opts.schemaId];return C&&(C=(0,u.normalizeId)(C),delete this.schemas[C],delete this.refs[C]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(b){for(const k of b)this.addKeyword(k);return this}addKeyword(b,k){let C;if(typeof b=="string")C=b,typeof k=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),k.keyword=C);else if(typeof b=="object"&&k===void 0){if(k=b,C=k.keyword,Array.isArray(C)&&!C.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(B.call(this,C,k),!k)return(0,d.eachItem)(C,p=>L.call(this,p)),this;U.call(this,k);const h=Tt(Be({},k),{type:(0,l.getJSONTypes)(k.type),schemaType:(0,l.getJSONTypes)(k.schemaType)});return(0,d.eachItem)(C,h.type.length===0?p=>L.call(this,p,h):p=>h.type.forEach(P=>L.call(this,p,h,P))),this}getKeyword(b){const k=this.RULES.all[b];return typeof k=="object"?k.definition:!!k}removeKeyword(b){const{RULES:k}=this;delete k.keywords[b],delete k.all[b];for(const C of k.rules){const h=C.rules.findIndex(p=>p.keyword===b);h>=0&&C.rules.splice(h,1)}return this}addFormat(b,k){return typeof k=="string"&&(k=new RegExp(k)),this.formats[b]=k,this}errorsText(b=this.errors,{separator:k=", ",dataVar:C="data"}={}){return!b||b.length===0?"No errors":b.map(h=>`${C}${h.instancePath} ${h.message}`).reduce((h,p)=>h+k+p)}$dataMetaSchema(b,k){const C=this.RULES.all;b=JSON.parse(JSON.stringify(b));for(const h of k){const p=h.split("/").slice(1);let P=b;for(const x of p)P=P[x];for(const x in C){const q=C[x];if(typeof q!="object")continue;const{$data:Q}=q.definition,ne=P[x];Q&&ne&&(P[x]=Z(ne))}}return b}_removeAllSchemas(b,k){for(const C in b){const h=b[C];(!k||k.test(C))&&(typeof h=="string"?delete b[C]:h&&!h.meta&&(this._cache.delete(h.schema),delete b[C]))}}_addSchema(b,k,C,h=this.opts.validateSchema,p=this.opts.addUsedSchema){let P;const{schemaId:x}=this.opts;if(typeof b=="object")P=b[x];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof b!="boolean")throw new Error("schema must be object or boolean")}let q=this._cache.get(b);if(q!==void 0)return q;C=(0,u.normalizeId)(P||C);const Q=u.getSchemaRefs.call(this,b,C);return q=new o.SchemaEnv({schema:b,schemaId:x,meta:k,baseId:C,localRefs:Q}),this._cache.set(q.schema,q),p&&!C.startsWith("#")&&(C&&this._checkUnique(C),this.refs[C]=q),h&&this.validateSchema(b,!0),q}_checkUnique(b){if(this.schemas[b]||this.refs[b])throw new Error(`schema with key or id "${b}" already exists`)}_compileSchemaEnv(b){if(b.meta?this._compileMetaSchema(b):o.compileSchema.call(this,b),!b.validate)throw new Error("ajv implementation error");return b.validate}_compileMetaSchema(b){const k=this.opts;this.opts=this._metaOpts;try{o.compileSchema.call(this,b)}finally{this.opts=k}}}t.default=O,O.ValidationError=r.default,O.MissingRefError=s.default;function j(F,b,k,C="error"){for(const h in F){const p=h;p in b&&this.logger[C](`${k}: option ${h}. ${F[p]}`)}}function A(F){return F=(0,u.normalizeId)(F),this.schemas[F]||this.refs[F]}function R(){const F=this.opts.schemas;if(!!F)if(Array.isArray(F))this.addSchema(F);else for(const b in F)this.addSchema(F[b],b)}function M(){for(const F in this.opts.formats){const b=this.opts.formats[F];b&&this.addFormat(F,b)}}function W(F){if(Array.isArray(F)){this.addVocabulary(F);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const b in F){const k=F[b];k.keyword||(k.keyword=b),this.addKeyword(k)}}function H(){const F=Be({},this.opts);for(const b of v)delete F[b];return F}const ge={log(){},warn(){},error(){}};function le(F){if(F===!1)return ge;if(F===void 0)return console;if(F.log&&F.warn&&F.error)return F;throw new Error("logger must implement log, warn and error methods")}const Y=/^[a-z_$][a-z0-9_$:-]*$/i;function B(F,b){const{RULES:k}=this;if((0,d.eachItem)(F,C=>{if(k.keywords[C])throw new Error(`Keyword ${C} is already defined`);if(!Y.test(C))throw new Error(`Keyword ${C} has invalid name`)}),!!b&&b.$data&&!("code"in b||"validate"in b))throw new Error('$data keyword must have "code" or "validate" function')}function L(F,b,k){var C;const h=b==null?void 0:b.post;if(k&&h)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:p}=this;let P=h?p.post:p.rules.find(({type:q})=>q===k);if(P||(P={type:k,rules:[]},p.rules.push(P)),p.keywords[F]=!0,!b)return;const x={keyword:F,definition:Tt(Be({},b),{type:(0,l.getJSONTypes)(b.type),schemaType:(0,l.getJSONTypes)(b.schemaType)})};b.before?X.call(this,P,x,b.before):P.rules.push(x),p.all[F]=x,(C=b.implements)===null||C===void 0||C.forEach(q=>this.addKeyword(q))}function X(F,b,k){const C=F.rules.findIndex(h=>h.keyword===k);C>=0?F.rules.splice(C,0,b):(F.rules.push(b),this.logger.warn(`rule ${k} is not defined`))}function U(F){let{metaSchema:b}=F;b!==void 0&&(F.$data&&this.opts.$data&&(b=Z(b)),F.validateSchema=this.compile(b,!0))}const ee={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Z(F){return{anyOf:[F,ee]}}})(Va);var di={},hi={},fi={};Object.defineProperty(fi,"__esModule",{value:!0});const Qf={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};fi.default=Qf;var tn={};Object.defineProperty(tn,"__esModule",{value:!0});tn.callRef=tn.getValidate=void 0;const Jf=ss,Fo=oe,Qe=ae,yn=St,Mo=Je,Nr=pe,Xf={keyword:"$ref",schemaType:"string",code(t){const{gen:e,schema:n,it:r}=t,{baseId:s,schemaEnv:i,validateName:o,opts:a,self:u}=r,{root:l}=i;if((n==="#"||n==="#/")&&s===l.baseId)return c();const d=Mo.resolveRef.call(u,l,s,n);if(d===void 0)throw new Jf.default(r.opts.uriResolver,s,n);if(d instanceof Mo.SchemaEnv)return m(d);return $(d);function c(){if(i===l)return jr(t,o,i,i.$async);const v=e.scopeValue("root",{ref:l});return jr(t,(0,Qe._)`${v}.validate`,l,l.$async)}function m(v){const S=hl(t,v);jr(t,S,v,v.$async)}function $(v){const S=e.scopeValue("schema",a.code.source===!0?{ref:v,code:(0,Qe.stringify)(v)}:{ref:v}),w=e.name("valid"),y=t.subschema({schema:v,dataTypes:[],schemaPath:Qe.nil,topSchemaRef:S,errSchemaPath:n},w);t.mergeEvaluated(y),t.ok(w)}}};function hl(t,e){const{gen:n}=t;return e.validate?n.scopeValue("validate",{ref:e.validate}):(0,Qe._)`${n.scopeValue("wrapper",{ref:e})}.validate`}tn.getValidate=hl;function jr(t,e,n,r){const{gen:s,it:i}=t,{allErrors:o,schemaEnv:a,opts:u}=i,l=u.passContext?yn.default.this:Qe.nil;r?d():c();function d(){if(!a.$async)throw new Error("async schema referenced by sync schema");const v=s.let("valid");s.try(()=>{s.code((0,Qe._)`await ${(0,Fo.callValidateCode)(t,e,l)}`),$(e),o||s.assign(v,!0)},S=>{s.if((0,Qe._)`!(${S} instanceof ${i.ValidationError})`,()=>s.throw(S)),m(S),o||s.assign(v,!1)}),t.ok(v)}function c(){t.result((0,Fo.callValidateCode)(t,e,l),()=>$(e),()=>m(e))}function m(v){const S=(0,Qe._)`${v}.errors`;s.assign(yn.default.vErrors,(0,Qe._)`${yn.default.vErrors} === null ? ${S} : ${yn.default.vErrors}.concat(${S})`),s.assign(yn.default.errors,(0,Qe._)`${yn.default.vErrors}.length`)}function $(v){var S;if(!i.opts.unevaluated)return;const w=(S=n==null?void 0:n.validate)===null||S===void 0?void 0:S.evaluated;if(i.props!==!0)if(w&&!w.dynamicProps)w.props!==void 0&&(i.props=Nr.mergeEvaluated.props(s,w.props,i.props));else{const y=s.var("props",(0,Qe._)`${v}.evaluated.props`);i.props=Nr.mergeEvaluated.props(s,y,i.props,Qe.Name)}if(i.items!==!0)if(w&&!w.dynamicItems)w.items!==void 0&&(i.items=Nr.mergeEvaluated.items(s,w.items,i.items));else{const y=s.var("items",(0,Qe._)`${v}.evaluated.items`);i.items=Nr.mergeEvaluated.items(s,y,i.items,Qe.Name)}}}tn.callRef=jr;tn.default=Xf;Object.defineProperty(hi,"__esModule",{value:!0});const Zf=fi,ep=tn,tp=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Zf.default,ep.default];hi.default=tp;var pi={},mi={};Object.defineProperty(mi,"__esModule",{value:!0});const Vr=ae,Mt=Vr.operators,Ur={maximum:{okStr:"<=",ok:Mt.LTE,fail:Mt.GT},minimum:{okStr:">=",ok:Mt.GTE,fail:Mt.LT},exclusiveMaximum:{okStr:"<",ok:Mt.LT,fail:Mt.GTE},exclusiveMinimum:{okStr:">",ok:Mt.GT,fail:Mt.LTE}},np={message:({keyword:t,schemaCode:e})=>(0,Vr.str)`must be ${Ur[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Vr._)`{comparison: ${Ur[t].okStr}, limit: ${e}}`},rp={keyword:Object.keys(Ur),type:"number",schemaType:"number",$data:!0,error:np,code(t){const{keyword:e,data:n,schemaCode:r}=t;t.fail$data((0,Vr._)`${n} ${Ur[e].fail} ${r} || isNaN(${n})`)}};mi.default=rp;var _i={};Object.defineProperty(_i,"__esModule",{value:!0});const er=ae,sp={message:({schemaCode:t})=>(0,er.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,er._)`{multipleOf: ${t}}`},ip={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:sp,code(t){const{gen:e,data:n,schemaCode:r,it:s}=t,i=s.opts.multipleOfPrecision,o=e.let("res"),a=i?(0,er._)`Math.abs(Math.round(${o}) - ${o}) > 1e-${i}`:(0,er._)`${o} !== parseInt(${o})`;t.fail$data((0,er._)`(${r} === 0 || (${o} = ${n}/${r}, ${a}))`)}};_i.default=ip;var gi={},yi={};Object.defineProperty(yi,"__esModule",{value:!0});function fl(t){const e=t.length;let n=0,r=0,s;for(;r<e;)n++,s=t.charCodeAt(r++),s>=55296&&s<=56319&&r<e&&(s=t.charCodeAt(r),(s&64512)===56320&&r++);return n}yi.default=fl;fl.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(gi,"__esModule",{value:!0});const Qt=ae,op=pe,ap=yi,lp={message({keyword:t,schemaCode:e}){const n=t==="maxLength"?"more":"fewer";return(0,Qt.str)`must NOT have ${n} than ${e} characters`},params:({schemaCode:t})=>(0,Qt._)`{limit: ${t}}`},up={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:lp,code(t){const{keyword:e,data:n,schemaCode:r,it:s}=t,i=e==="maxLength"?Qt.operators.GT:Qt.operators.LT,o=s.opts.unicode===!1?(0,Qt._)`${n}.length`:(0,Qt._)`${(0,op.useFunc)(t.gen,ap.default)}(${n})`;t.fail$data((0,Qt._)`${o} ${i} ${r}`)}};gi.default=up;var vi={};Object.defineProperty(vi,"__esModule",{value:!0});const cp=oe,qr=ae,dp={message:({schemaCode:t})=>(0,qr.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,qr._)`{pattern: ${t}}`},hp={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:dp,code(t){const{data:e,$data:n,schema:r,schemaCode:s,it:i}=t,o=i.opts.unicodeRegExp?"u":"",a=n?(0,qr._)`(new RegExp(${s}, ${o}))`:(0,cp.usePattern)(t,r);t.fail$data((0,qr._)`!${a}.test(${e})`)}};vi.default=hp;var Ei={};Object.defineProperty(Ei,"__esModule",{value:!0});const tr=ae,fp={message({keyword:t,schemaCode:e}){const n=t==="maxProperties"?"more":"fewer";return(0,tr.str)`must NOT have ${n} than ${e} properties`},params:({schemaCode:t})=>(0,tr._)`{limit: ${t}}`},pp={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:fp,code(t){const{keyword:e,data:n,schemaCode:r}=t,s=e==="maxProperties"?tr.operators.GT:tr.operators.LT;t.fail$data((0,tr._)`Object.keys(${n}).length ${s} ${r}`)}};Ei.default=pp;var bi={};Object.defineProperty(bi,"__esModule",{value:!0});const Kn=oe,nr=ae,mp=pe,_p={message:({params:{missingProperty:t}})=>(0,nr.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,nr._)`{missingProperty: ${t}}`},gp={keyword:"required",type:"object",schemaType:"array",$data:!0,error:_p,code(t){const{gen:e,schema:n,schemaCode:r,data:s,$data:i,it:o}=t,{opts:a}=o;if(!i&&n.length===0)return;const u=n.length>=a.loopRequired;if(o.allErrors?l():d(),a.strictRequired){const $=t.parentSchema.properties,{definedProperties:v}=t.it;for(const S of n)if(($==null?void 0:$[S])===void 0&&!v.has(S)){const w=o.schemaEnv.baseId+o.errSchemaPath,y=`required property "${S}" is not defined at "${w}" (strictRequired)`;(0,mp.checkStrictMode)(o,y,o.opts.strictRequired)}}function l(){if(u||i)t.block$data(nr.nil,c);else for(const $ of n)(0,Kn.checkReportMissingProp)(t,$)}function d(){const $=e.let("missing");if(u||i){const v=e.let("valid",!0);t.block$data(v,()=>m($,v)),t.ok(v)}else e.if((0,Kn.checkMissingProp)(t,n,$)),(0,Kn.reportMissingProp)(t,$),e.else()}function c(){e.forOf("prop",r,$=>{t.setParams({missingProperty:$}),e.if((0,Kn.noPropertyInData)(e,s,$,a.ownProperties),()=>t.error())})}function m($,v){t.setParams({missingProperty:$}),e.forOf($,r,()=>{e.assign(v,(0,Kn.propertyInData)(e,s,$,a.ownProperties)),e.if((0,nr.not)(v),()=>{t.error(),e.break()})},nr.nil)}}};bi.default=gp;var $i={};Object.defineProperty($i,"__esModule",{value:!0});const rr=ae,yp={message({keyword:t,schemaCode:e}){const n=t==="maxItems"?"more":"fewer";return(0,rr.str)`must NOT have ${n} than ${e} items`},params:({schemaCode:t})=>(0,rr._)`{limit: ${t}}`},vp={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:yp,code(t){const{keyword:e,data:n,schemaCode:r}=t,s=e==="maxItems"?rr.operators.GT:rr.operators.LT;t.fail$data((0,rr._)`${n}.length ${s} ${r}`)}};$i.default=vp;var wi={},yr={};Object.defineProperty(yr,"__esModule",{value:!0});const pl=Ya;pl.code='require("ajv/dist/runtime/equal").default';yr.default=pl;Object.defineProperty(wi,"__esModule",{value:!0});const vs=gr,Le=ae,Ep=pe,bp=yr,$p={message:({params:{i:t,j:e}})=>(0,Le.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Le._)`{i: ${t}, j: ${e}}`},wp={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:$p,code(t){const{gen:e,data:n,$data:r,schema:s,parentSchema:i,schemaCode:o,it:a}=t;if(!r&&!s)return;const u=e.let("valid"),l=i.items?(0,vs.getSchemaTypes)(i.items):[];t.block$data(u,d,(0,Le._)`${o} === false`),t.ok(u);function d(){const v=e.let("i",(0,Le._)`${n}.length`),S=e.let("j");t.setParams({i:v,j:S}),e.assign(u,!0),e.if((0,Le._)`${v} > 1`,()=>(c()?m:$)(v,S))}function c(){return l.length>0&&!l.some(v=>v==="object"||v==="array")}function m(v,S){const w=e.name("item"),y=(0,vs.checkDataTypes)(l,w,a.opts.strictNumbers,vs.DataType.Wrong),I=e.const("indices",(0,Le._)`{}`);e.for((0,Le._)`;${v}--;`,()=>{e.let(w,(0,Le._)`${n}[${v}]`),e.if(y,(0,Le._)`continue`),l.length>1&&e.if((0,Le._)`typeof ${w} == "string"`,(0,Le._)`${w} += "_"`),e.if((0,Le._)`typeof ${I}[${w}] == "number"`,()=>{e.assign(S,(0,Le._)`${I}[${w}]`),t.error(),e.assign(u,!1).break()}).code((0,Le._)`${I}[${w}] = ${v}`)})}function $(v,S){const w=(0,Ep.useFunc)(e,bp.default),y=e.name("outer");e.label(y).for((0,Le._)`;${v}--;`,()=>e.for((0,Le._)`${S} = ${v}; ${S}--;`,()=>e.if((0,Le._)`${w}(${n}[${v}], ${n}[${S}])`,()=>{t.error(),e.assign(u,!1).break(y)})))}}};wi.default=wp;var Ci={};Object.defineProperty(Ci,"__esModule",{value:!0});const js=ae,Cp=pe,Sp=yr,Ap={message:"must be equal to constant",params:({schemaCode:t})=>(0,js._)`{allowedValue: ${t}}`},Tp={keyword:"const",$data:!0,error:Ap,code(t){const{gen:e,data:n,$data:r,schemaCode:s,schema:i}=t;r||i&&typeof i=="object"?t.fail$data((0,js._)`!${(0,Cp.useFunc)(e,Sp.default)}(${n}, ${s})`):t.fail((0,js._)`${i} !== ${n}`)}};Ci.default=Tp;var Si={};Object.defineProperty(Si,"__esModule",{value:!0});const Xn=ae,Ip=pe,Np=yr,Dp={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,Xn._)`{allowedValues: ${t}}`},Rp={keyword:"enum",schemaType:"array",$data:!0,error:Dp,code(t){const{gen:e,data:n,$data:r,schema:s,schemaCode:i,it:o}=t;if(!r&&s.length===0)throw new Error("enum must have non-empty array");const a=s.length>=o.opts.loopEnum;let u;const l=()=>u!=null?u:u=(0,Ip.useFunc)(e,Np.default);let d;if(a||r)d=e.let("valid"),t.block$data(d,c);else{if(!Array.isArray(s))throw new Error("ajv implementation error");const $=e.const("vSchema",i);d=(0,Xn.or)(...s.map((v,S)=>m($,S)))}t.pass(d);function c(){e.assign(d,!1),e.forOf("v",i,$=>e.if((0,Xn._)`${l()}(${n}, ${$})`,()=>e.assign(d,!0).break()))}function m($,v){const S=s[v];return typeof S=="object"&&S!==null?(0,Xn._)`${l()}(${n}, ${$}[${v}])`:(0,Xn._)`${n} === ${S}`}}};Si.default=Rp;Object.defineProperty(pi,"__esModule",{value:!0});const Pp=mi,kp=_i,Op=gi,Fp=vi,Mp=Ei,jp=bi,Bp=$i,Lp=wi,xp=Ci,Vp=Si,Up=[Pp.default,kp.default,Op.default,Fp.default,Mp.default,jp.default,Bp.default,Lp.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},xp.default,Vp.default];pi.default=Up;var Ai={},Rn={};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.validateAdditionalItems=void 0;const Jt=ae,Bs=pe,qp={message:({params:{len:t}})=>(0,Jt.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Jt._)`{limit: ${t}}`},Hp={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:qp,code(t){const{parentSchema:e,it:n}=t,{items:r}=e;if(!Array.isArray(r)){(0,Bs.checkStrictMode)(n,'"additionalItems" is ignored when "items" is not an array of schemas');return}ml(t,r)}};function ml(t,e){const{gen:n,schema:r,data:s,keyword:i,it:o}=t;o.items=!0;const a=n.const("len",(0,Jt._)`${s}.length`);if(r===!1)t.setParams({len:e.length}),t.pass((0,Jt._)`${a} <= ${e.length}`);else if(typeof r=="object"&&!(0,Bs.alwaysValidSchema)(o,r)){const l=n.var("valid",(0,Jt._)`${a} <= ${e.length}`);n.if((0,Jt.not)(l),()=>u(l)),t.ok(l)}function u(l){n.forRange("i",e.length,a,d=>{t.subschema({keyword:i,dataProp:d,dataPropType:Bs.Type.Num},l),o.allErrors||n.if((0,Jt.not)(l),()=>n.break())})}}Rn.validateAdditionalItems=ml;Rn.default=Hp;var Ti={},Pn={};Object.defineProperty(Pn,"__esModule",{value:!0});Pn.validateTuple=void 0;const jo=ae,Br=pe,Wp=oe,zp={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){const{schema:e,it:n}=t;if(Array.isArray(e))return _l(t,"additionalItems",e);n.items=!0,!(0,Br.alwaysValidSchema)(n,e)&&t.ok((0,Wp.validateArray)(t))}};function _l(t,e,n=t.schema){const{gen:r,parentSchema:s,data:i,keyword:o,it:a}=t;d(s),a.opts.unevaluated&&n.length&&a.items!==!0&&(a.items=Br.mergeEvaluated.items(r,n.length,a.items));const u=r.name("valid"),l=r.const("len",(0,jo._)`${i}.length`);n.forEach((c,m)=>{(0,Br.alwaysValidSchema)(a,c)||(r.if((0,jo._)`${l} > ${m}`,()=>t.subschema({keyword:o,schemaProp:m,dataProp:m},u)),t.ok(u))});function d(c){const{opts:m,errSchemaPath:$}=a,v=n.length,S=v===c.minItems&&(v===c.maxItems||c[e]===!1);if(m.strictTuples&&!S){const w=`"${o}" is ${v}-tuple, but minItems or maxItems/${e} are not specified or different at path "${$}"`;(0,Br.checkStrictMode)(a,w,m.strictTuples)}}}Pn.validateTuple=_l;Pn.default=zp;Object.defineProperty(Ti,"__esModule",{value:!0});const Kp=Pn,Gp={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,Kp.validateTuple)(t,"items")};Ti.default=Gp;var Ii={};Object.defineProperty(Ii,"__esModule",{value:!0});const Bo=ae,Yp=pe,Qp=oe,Jp=Rn,Xp={message:({params:{len:t}})=>(0,Bo.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Bo._)`{limit: ${t}}`},Zp={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:Xp,code(t){const{schema:e,parentSchema:n,it:r}=t,{prefixItems:s}=n;r.items=!0,!(0,Yp.alwaysValidSchema)(r,e)&&(s?(0,Jp.validateAdditionalItems)(t,s):t.ok((0,Qp.validateArray)(t)))}};Ii.default=Zp;var Ni={};Object.defineProperty(Ni,"__esModule",{value:!0});const rt=ae,Dr=pe,em={message:({params:{min:t,max:e}})=>e===void 0?(0,rt.str)`must contain at least ${t} valid item(s)`:(0,rt.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,rt._)`{minContains: ${t}}`:(0,rt._)`{minContains: ${t}, maxContains: ${e}}`},tm={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:em,code(t){const{gen:e,schema:n,parentSchema:r,data:s,it:i}=t;let o,a;const{minContains:u,maxContains:l}=r;i.opts.next?(o=u===void 0?1:u,a=l):o=1;const d=e.const("len",(0,rt._)`${s}.length`);if(t.setParams({min:o,max:a}),a===void 0&&o===0){(0,Dr.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&o>a){(0,Dr.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,Dr.alwaysValidSchema)(i,n)){let S=(0,rt._)`${d} >= ${o}`;a!==void 0&&(S=(0,rt._)`${S} && ${d} <= ${a}`),t.pass(S);return}i.items=!0;const c=e.name("valid");a===void 0&&o===1?$(c,()=>e.if(c,()=>e.break())):o===0?(e.let(c,!0),a!==void 0&&e.if((0,rt._)`${s}.length > 0`,m)):(e.let(c,!1),m()),t.result(c,()=>t.reset());function m(){const S=e.name("_valid"),w=e.let("count",0);$(S,()=>e.if(S,()=>v(w)))}function $(S,w){e.forRange("i",0,d,y=>{t.subschema({keyword:"contains",dataProp:y,dataPropType:Dr.Type.Num,compositeRule:!0},S),w()})}function v(S){e.code((0,rt._)`${S}++`),a===void 0?e.if((0,rt._)`${S} >= ${o}`,()=>e.assign(c,!0).break()):(e.if((0,rt._)`${S} > ${a}`,()=>e.assign(c,!1).break()),o===1?e.assign(c,!0):e.if((0,rt._)`${S} >= ${o}`,()=>e.assign(c,!0)))}}};Ni.default=tm;var gl={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const e=ae,n=pe,r=oe;t.error={message:({params:{property:u,depsCount:l,deps:d}})=>{const c=l===1?"property":"properties";return(0,e.str)`must have ${c} ${d} when property ${u} is present`},params:({params:{property:u,depsCount:l,deps:d,missingProperty:c}})=>(0,e._)`{property: ${u},
    missingProperty: ${c},
    depsCount: ${l},
    deps: ${d}}`};const s={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(u){const[l,d]=i(u);o(u,l),a(u,d)}};function i({schema:u}){const l={},d={};for(const c in u){if(c==="__proto__")continue;const m=Array.isArray(u[c])?l:d;m[c]=u[c]}return[l,d]}function o(u,l=u.schema){const{gen:d,data:c,it:m}=u;if(Object.keys(l).length===0)return;const $=d.let("missing");for(const v in l){const S=l[v];if(S.length===0)continue;const w=(0,r.propertyInData)(d,c,v,m.opts.ownProperties);u.setParams({property:v,depsCount:S.length,deps:S.join(", ")}),m.allErrors?d.if(w,()=>{for(const y of S)(0,r.checkReportMissingProp)(u,y)}):(d.if((0,e._)`${w} && (${(0,r.checkMissingProp)(u,S,$)})`),(0,r.reportMissingProp)(u,$),d.else())}}t.validatePropertyDeps=o;function a(u,l=u.schema){const{gen:d,data:c,keyword:m,it:$}=u,v=d.name("valid");for(const S in l)(0,n.alwaysValidSchema)($,l[S])||(d.if((0,r.propertyInData)(d,c,S,$.opts.ownProperties),()=>{const w=u.subschema({keyword:m,schemaProp:S},v);u.mergeValidEvaluated(w,v)},()=>d.var(v,!0)),u.ok(v))}t.validateSchemaDeps=a,t.default=s})(gl);var Di={};Object.defineProperty(Di,"__esModule",{value:!0});const yl=ae,nm=pe,rm={message:"property name must be valid",params:({params:t})=>(0,yl._)`{propertyName: ${t.propertyName}}`},sm={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:rm,code(t){const{gen:e,schema:n,data:r,it:s}=t;if((0,nm.alwaysValidSchema)(s,n))return;const i=e.name("valid");e.forIn("key",r,o=>{t.setParams({propertyName:o}),t.subschema({keyword:"propertyNames",data:o,dataTypes:["string"],propertyName:o,compositeRule:!0},i),e.if((0,yl.not)(i),()=>{t.error(!0),s.allErrors||e.break()})}),t.ok(i)}};Di.default=sm;var as={};Object.defineProperty(as,"__esModule",{value:!0});const Rr=oe,lt=ae,im=St,Pr=pe,om={message:"must NOT have additional properties",params:({params:t})=>(0,lt._)`{additionalProperty: ${t.additionalProperty}}`},am={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:om,code(t){const{gen:e,schema:n,parentSchema:r,data:s,errsCount:i,it:o}=t;if(!i)throw new Error("ajv implementation error");const{allErrors:a,opts:u}=o;if(o.props=!0,u.removeAdditional!=="all"&&(0,Pr.alwaysValidSchema)(o,n))return;const l=(0,Rr.allSchemaProperties)(r.properties),d=(0,Rr.allSchemaProperties)(r.patternProperties);c(),t.ok((0,lt._)`${i} === ${im.default.errors}`);function c(){e.forIn("key",s,w=>{!l.length&&!d.length?v(w):e.if(m(w),()=>v(w))})}function m(w){let y;if(l.length>8){const I=(0,Pr.schemaRefOrVal)(o,r.properties,"properties");y=(0,Rr.isOwnProperty)(e,I,w)}else l.length?y=(0,lt.or)(...l.map(I=>(0,lt._)`${w} === ${I}`)):y=lt.nil;return d.length&&(y=(0,lt.or)(y,...d.map(I=>(0,lt._)`${(0,Rr.usePattern)(t,I)}.test(${w})`))),(0,lt.not)(y)}function $(w){e.code((0,lt._)`delete ${s}[${w}]`)}function v(w){if(u.removeAdditional==="all"||u.removeAdditional&&n===!1){$(w);return}if(n===!1){t.setParams({additionalProperty:w}),t.error(),a||e.break();return}if(typeof n=="object"&&!(0,Pr.alwaysValidSchema)(o,n)){const y=e.name("valid");u.removeAdditional==="failing"?(S(w,y,!1),e.if((0,lt.not)(y),()=>{t.reset(),$(w)})):(S(w,y),a||e.if((0,lt.not)(y),()=>e.break()))}}function S(w,y,I){const D={keyword:"additionalProperties",dataProp:w,dataPropType:Pr.Type.Str};I===!1&&Object.assign(D,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(D,y)}}};as.default=am;var Ri={};Object.defineProperty(Ri,"__esModule",{value:!0});const lm=ft,Lo=oe,Es=pe,xo=as,um={keyword:"properties",type:"object",schemaType:"object",code(t){const{gen:e,schema:n,parentSchema:r,data:s,it:i}=t;i.opts.removeAdditional==="all"&&r.additionalProperties===void 0&&xo.default.code(new lm.KeywordCxt(i,xo.default,"additionalProperties"));const o=(0,Lo.allSchemaProperties)(n);for(const c of o)i.definedProperties.add(c);i.opts.unevaluated&&o.length&&i.props!==!0&&(i.props=Es.mergeEvaluated.props(e,(0,Es.toHash)(o),i.props));const a=o.filter(c=>!(0,Es.alwaysValidSchema)(i,n[c]));if(a.length===0)return;const u=e.name("valid");for(const c of a)l(c)?d(c):(e.if((0,Lo.propertyInData)(e,s,c,i.opts.ownProperties)),d(c),i.allErrors||e.else().var(u,!0),e.endIf()),t.it.definedProperties.add(c),t.ok(u);function l(c){return i.opts.useDefaults&&!i.compositeRule&&n[c].default!==void 0}function d(c){t.subschema({keyword:"properties",schemaProp:c,dataProp:c},u)}}};Ri.default=um;var Pi={};Object.defineProperty(Pi,"__esModule",{value:!0});const Vo=oe,kr=ae,Uo=pe,qo=pe,cm={keyword:"patternProperties",type:"object",schemaType:"object",code(t){const{gen:e,schema:n,data:r,parentSchema:s,it:i}=t,{opts:o}=i,a=(0,Vo.allSchemaProperties)(n),u=a.filter(S=>(0,Uo.alwaysValidSchema)(i,n[S]));if(a.length===0||u.length===a.length&&(!i.opts.unevaluated||i.props===!0))return;const l=o.strictSchema&&!o.allowMatchingProperties&&s.properties,d=e.name("valid");i.props!==!0&&!(i.props instanceof kr.Name)&&(i.props=(0,qo.evaluatedPropsToName)(e,i.props));const{props:c}=i;m();function m(){for(const S of a)l&&$(S),i.allErrors?v(S):(e.var(d,!0),v(S),e.if(d))}function $(S){for(const w in l)new RegExp(S).test(w)&&(0,Uo.checkStrictMode)(i,`property ${w} matches pattern ${S} (use allowMatchingProperties)`)}function v(S){e.forIn("key",r,w=>{e.if((0,kr._)`${(0,Vo.usePattern)(t,S)}.test(${w})`,()=>{const y=u.includes(S);y||t.subschema({keyword:"patternProperties",schemaProp:S,dataProp:w,dataPropType:qo.Type.Str},d),i.opts.unevaluated&&c!==!0?e.assign((0,kr._)`${c}[${w}]`,!0):!y&&!i.allErrors&&e.if((0,kr.not)(d),()=>e.break())})})}}};Pi.default=cm;var ki={};Object.defineProperty(ki,"__esModule",{value:!0});const dm=pe,hm={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){const{gen:e,schema:n,it:r}=t;if((0,dm.alwaysValidSchema)(r,n)){t.fail();return}const s=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),t.failResult(s,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};ki.default=hm;var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});const fm=oe,pm={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:fm.validateUnion,error:{message:"must match a schema in anyOf"}};Oi.default=pm;var Fi={};Object.defineProperty(Fi,"__esModule",{value:!0});const Lr=ae,mm=pe,_m={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,Lr._)`{passingSchemas: ${t.passing}}`},gm={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:_m,code(t){const{gen:e,schema:n,parentSchema:r,it:s}=t;if(!Array.isArray(n))throw new Error("ajv implementation error");if(s.opts.discriminator&&r.discriminator)return;const i=n,o=e.let("valid",!1),a=e.let("passing",null),u=e.name("_valid");t.setParams({passing:a}),e.block(l),t.result(o,()=>t.reset(),()=>t.error(!0));function l(){i.forEach((d,c)=>{let m;(0,mm.alwaysValidSchema)(s,d)?e.var(u,!0):m=t.subschema({keyword:"oneOf",schemaProp:c,compositeRule:!0},u),c>0&&e.if((0,Lr._)`${u} && ${o}`).assign(o,!1).assign(a,(0,Lr._)`[${a}, ${c}]`).else(),e.if(u,()=>{e.assign(o,!0),e.assign(a,c),m&&t.mergeEvaluated(m,Lr.Name)})})}}};Fi.default=gm;var Mi={};Object.defineProperty(Mi,"__esModule",{value:!0});const ym=pe,vm={keyword:"allOf",schemaType:"array",code(t){const{gen:e,schema:n,it:r}=t;if(!Array.isArray(n))throw new Error("ajv implementation error");const s=e.name("valid");n.forEach((i,o)=>{if((0,ym.alwaysValidSchema)(r,i))return;const a=t.subschema({keyword:"allOf",schemaProp:o},s);t.ok(s),t.mergeEvaluated(a)})}};Mi.default=vm;var ji={};Object.defineProperty(ji,"__esModule",{value:!0});const Hr=ae,vl=pe,Em={message:({params:t})=>(0,Hr.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,Hr._)`{failingKeyword: ${t.ifClause}}`},bm={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:Em,code(t){const{gen:e,parentSchema:n,it:r}=t;n.then===void 0&&n.else===void 0&&(0,vl.checkStrictMode)(r,'"if" without "then" and "else" is ignored');const s=Ho(r,"then"),i=Ho(r,"else");if(!s&&!i)return;const o=e.let("valid",!0),a=e.name("_valid");if(u(),t.reset(),s&&i){const d=e.let("ifClause");t.setParams({ifClause:d}),e.if(a,l("then",d),l("else",d))}else s?e.if(a,l("then")):e.if((0,Hr.not)(a),l("else"));t.pass(o,()=>t.error(!0));function u(){const d=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(d)}function l(d,c){return()=>{const m=t.subschema({keyword:d},a);e.assign(o,a),t.mergeValidEvaluated(m,o),c?e.assign(c,(0,Hr._)`${d}`):t.setParams({ifClause:d})}}}};function Ho(t,e){const n=t.schema[e];return n!==void 0&&!(0,vl.alwaysValidSchema)(t,n)}ji.default=bm;var Bi={};Object.defineProperty(Bi,"__esModule",{value:!0});const $m=pe,wm={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:n}){e.if===void 0&&(0,$m.checkStrictMode)(n,`"${t}" without "if" is ignored`)}};Bi.default=wm;Object.defineProperty(Ai,"__esModule",{value:!0});const Cm=Rn,Sm=Ti,Am=Pn,Tm=Ii,Im=Ni,Nm=gl,Dm=Di,Rm=as,Pm=Ri,km=Pi,Om=ki,Fm=Oi,Mm=Fi,jm=Mi,Bm=ji,Lm=Bi;function xm(t=!1){const e=[Om.default,Fm.default,Mm.default,jm.default,Bm.default,Lm.default,Dm.default,Rm.default,Nm.default,Pm.default,km.default];return t?e.push(Sm.default,Tm.default):e.push(Cm.default,Am.default),e.push(Im.default),e}Ai.default=xm;var Li={},xi={};Object.defineProperty(xi,"__esModule",{value:!0});const ke=ae,Vm={message:({schemaCode:t})=>(0,ke.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,ke._)`{format: ${t}}`},Um={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:Vm,code(t,e){const{gen:n,data:r,$data:s,schema:i,schemaCode:o,it:a}=t,{opts:u,errSchemaPath:l,schemaEnv:d,self:c}=a;if(!u.validateFormats)return;s?m():$();function m(){const v=n.scopeValue("formats",{ref:c.formats,code:u.code.formats}),S=n.const("fDef",(0,ke._)`${v}[${o}]`),w=n.let("fType"),y=n.let("format");n.if((0,ke._)`typeof ${S} == "object" && !(${S} instanceof RegExp)`,()=>n.assign(w,(0,ke._)`${S}.type || "string"`).assign(y,(0,ke._)`${S}.validate`),()=>n.assign(w,(0,ke._)`"string"`).assign(y,S)),t.fail$data((0,ke.or)(I(),D()));function I(){return u.strictSchema===!1?ke.nil:(0,ke._)`${o} && !${y}`}function D(){const O=d.$async?(0,ke._)`(${S}.async ? await ${y}(${r}) : ${y}(${r}))`:(0,ke._)`${y}(${r})`,j=(0,ke._)`(typeof ${y} == "function" ? ${O} : ${y}.test(${r}))`;return(0,ke._)`${y} && ${y} !== true && ${w} === ${e} && !${j}`}}function $(){const v=c.formats[i];if(!v){I();return}if(v===!0)return;const[S,w,y]=D(v);S===e&&t.pass(O());function I(){if(u.strictSchema===!1){c.logger.warn(j());return}throw new Error(j());function j(){return`unknown format "${i}" ignored in schema at path "${l}"`}}function D(j){const A=j instanceof RegExp?(0,ke.regexpCode)(j):u.code.formats?(0,ke._)`${u.code.formats}${(0,ke.getProperty)(i)}`:void 0,R=n.scopeValue("formats",{key:i,ref:j,code:A});return typeof j=="object"&&!(j instanceof RegExp)?[j.type||"string",j.validate,(0,ke._)`${R}.validate`]:["string",j,R]}function O(){if(typeof v=="object"&&!(v instanceof RegExp)&&v.async){if(!d.$async)throw new Error("async format in sync schema");return(0,ke._)`await ${y}(${r})`}return typeof w=="function"?(0,ke._)`${y}(${r})`:(0,ke._)`${y}.test(${r})`}}}};xi.default=Um;Object.defineProperty(Li,"__esModule",{value:!0});const qm=xi,Hm=[qm.default];Li.default=Hm;var Tn={};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.contentVocabulary=Tn.metadataVocabulary=void 0;Tn.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Tn.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(di,"__esModule",{value:!0});const Wm=hi,zm=pi,Km=Ai,Gm=Li,Wo=Tn,Ym=[Wm.default,zm.default,(0,Km.default)(),Gm.default,Wo.metadataVocabulary,Wo.contentVocabulary];di.default=Ym;var Vi={},El={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DiscrError=void 0,function(e){e.Tag="tag",e.Mapping="mapping"}(t.DiscrError||(t.DiscrError={}))})(El);Object.defineProperty(Vi,"__esModule",{value:!0});const En=ae,Ls=El,zo=Je,Qm=pe,Jm={message:({params:{discrError:t,tagName:e}})=>t===Ls.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:n}})=>(0,En._)`{error: ${t}, tag: ${n}, tagValue: ${e}}`},Xm={keyword:"discriminator",type:"object",schemaType:"object",error:Jm,code(t){const{gen:e,data:n,schema:r,parentSchema:s,it:i}=t,{oneOf:o}=s;if(!i.opts.discriminator)throw new Error("discriminator: requires discriminator option");const a=r.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(r.mapping)throw new Error("discriminator: mapping is not supported");if(!o)throw new Error("discriminator: requires oneOf keyword");const u=e.let("valid",!1),l=e.const("tag",(0,En._)`${n}${(0,En.getProperty)(a)}`);e.if((0,En._)`typeof ${l} == "string"`,()=>d(),()=>t.error(!1,{discrError:Ls.DiscrError.Tag,tag:l,tagName:a})),t.ok(u);function d(){const $=m();e.if(!1);for(const v in $)e.elseIf((0,En._)`${l} === ${v}`),e.assign(u,c($[v]));e.else(),t.error(!1,{discrError:Ls.DiscrError.Mapping,tag:l,tagName:a}),e.endIf()}function c($){const v=e.name("valid"),S=t.subschema({keyword:"oneOf",schemaProp:$},v);return t.mergeEvaluated(S,En.Name),v}function m(){var $;const v={},S=y(s);let w=!0;for(let O=0;O<o.length;O++){let j=o[O];(j==null?void 0:j.$ref)&&!(0,Qm.schemaHasRulesButRef)(j,i.self.RULES)&&(j=zo.resolveRef.call(i.self,i.schemaEnv.root,i.baseId,j==null?void 0:j.$ref),j instanceof zo.SchemaEnv&&(j=j.schema));const A=($=j==null?void 0:j.properties)===null||$===void 0?void 0:$[a];if(typeof A!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);w=w&&(S||y(j)),I(A,O)}if(!w)throw new Error(`discriminator: "${a}" must be required`);return v;function y({required:O}){return Array.isArray(O)&&O.includes(a)}function I(O,j){if(O.const)D(O.const,j);else if(O.enum)for(const A of O.enum)D(A,j);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function D(O,j){if(typeof O!="string"||O in v)throw new Error(`discriminator: "${a}" values must be unique strings`);v[O]=j}}}};Vi.default=Xm;const Zm="http://json-schema.org/draft-07/schema#",e_="http://json-schema.org/draft-07/schema#",t_="Core schema meta-schema",n_={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},r_=["object","boolean"],s_={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}};var i_={$schema:Zm,$id:e_,title:t_,definitions:n_,type:r_,properties:s_,default:!0};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;const n=Va,r=di,s=Vi,i=i_,o=["/properties"],a="http://json-schema.org/draft-07/schema";class u extends n.default{_addVocabularies(){super._addVocabularies(),r.default.forEach(m=>this.addVocabulary(m)),this.opts.discriminator&&this.addKeyword(s.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const m=this.opts.$data?this.$dataMetaSchema(i,o):i;this.addMetaSchema(m,a,!1),this.refs["http://json-schema.org/schema"]=a}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(a)?a:void 0)}}t.exports=e=u,Object.defineProperty(e,"__esModule",{value:!0}),e.default=u;var l=ft;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return l.KeywordCxt}});var d=ae;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return d._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return d.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return d.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return d.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return d.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return d.CodeGen}})})(ks,ks.exports);var o_=vc(ks.exports);new o_;let bs=null;async function bl(){return bs||(bs=await(await fetch("https://next-early-intervention.vercel.app/api/setting")).json()),bs}function a_(t){return fetch("https://next-early-intervention.vercel.app/api/registration_date?date="+t).then(function(e){return e.json()}).then(function(e){return e})}async function l_(t){return await fetch("https://next-early-intervention.vercel.app/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $l={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V=function(t,e){if(!t)throw kn(e)},kn=function(t){return new Error("Firebase Database ("+$l.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},u_=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Ui={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,u=s+2<t.length,l=u?t[s+2]:0,d=i>>2,c=(i&3)<<4|a>>4;let m=(a&15)<<2|l>>6,$=l&63;u||($=64,o||(m=64)),r.push(n[d],n[c],n[m],n[$])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(wl(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):u_(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const l=s<t.length?n[t.charAt(s)]:64;++s;const c=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||l==null||c==null)throw Error();const m=i<<2|a>>4;if(r.push(m),l!==64){const $=a<<4&240|l>>2;if(r.push($),c!==64){const v=l<<6&192|c;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Cl=function(t){const e=wl(t);return Ui.encodeByteArray(e,!0)},Sl=function(t){return Cl(t).replace(/\./g,"")},Ko=function(t){try{return Ui.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c_(t){return Al(void 0,t)}function Al(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!d_(n)||(t[n]=Al(t[n],e[n]));return t}function d_(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h_(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Il(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(h_())}function f_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Nl(){return $l.NODE_ADMIN===!0}function p_(){return typeof indexedDB=="object"}function m_(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const __="FirebaseError";class vr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=__,Object.setPrototypeOf(this,vr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Dl.prototype.create)}}class Dl{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?g_(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new vr(s,a,r)}}function g_(t,e){return t.replace(y_,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const y_=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(t){return JSON.parse(t)}function Ve(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rl=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=cr(Ko(i[0])||""),n=cr(Ko(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},v_=function(t){const e=Rl(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},E_=function(t){const e=Rl(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function In(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Go(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Wr(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b_(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let c=0;c<16;c++)r[c]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let c=0;c<16;c++)r[c]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let c=16;c<80;c++){const m=r[c-3]^r[c-8]^r[c-14]^r[c-16];r[c]=(m<<1|m>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],u=this.chain_[4],l,d;for(let c=0;c<80;c++){c<40?c<20?(l=a^i&(o^a),d=1518500249):(l=i^o^a,d=1859775393):c<60?(l=i&o|a&(i|o),d=2400959708):(l=i^o^a,d=3395469782);const m=(s<<5|s>>>27)+l+u+d+r[c]&4294967295;u=a,a=o,o=(i<<30|i>>>2)&4294967295,i=s,s=m}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let o=this.inbuf_;for(;s<n;){if(o===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}else for(;s<n;)if(i[o]=e[s],++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function w_(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,V(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;s=65536+(i<<10)+o}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},ls=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S_(t){return t&&t._delegate?t._delegate:t}class zr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var be;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(be||(be={}));const A_={debug:be.DEBUG,verbose:be.VERBOSE,info:be.INFO,warn:be.WARN,error:be.ERROR,silent:be.SILENT},T_=be.INFO,I_={[be.DEBUG]:"log",[be.VERBOSE]:"log",[be.INFO]:"info",[be.WARN]:"warn",[be.ERROR]:"error"},N_=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=I_[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Pl{constructor(e){this.name=e,this._logLevel=T_,this._logHandler=N_,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?A_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,be.DEBUG,...e),this._logHandler(this,be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,be.VERBOSE,...e),this._logHandler(this,be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,be.INFO,...e),this._logHandler(this,be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,be.WARN,...e),this._logHandler(this,be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,be.ERROR,...e),this._logHandler(this,be.ERROR,...e)}}const D_=(t,e)=>e.some(n=>t instanceof n);let Yo,Qo;function R_(){return Yo||(Yo=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function P_(){return Qo||(Qo=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const kl=new WeakMap,xs=new WeakMap,Ol=new WeakMap,$s=new WeakMap,qi=new WeakMap;function k_(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(xt(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&kl.set(n,t)}).catch(()=>{}),qi.set(e,t),e}function O_(t){if(xs.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});xs.set(t,e)}let Vs={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return xs.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ol.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xt(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function F_(t){Vs=t(Vs)}function M_(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(ws(this),e,...n);return Ol.set(r,e.sort?e.sort():[e]),xt(r)}:P_().includes(t)?function(...e){return t.apply(ws(this),e),xt(kl.get(this))}:function(...e){return xt(t.apply(ws(this),e))}}function j_(t){return typeof t=="function"?M_(t):(t instanceof IDBTransaction&&O_(t),D_(t,R_())?new Proxy(t,Vs):t)}function xt(t){if(t instanceof IDBRequest)return k_(t);if($s.has(t))return $s.get(t);const e=j_(t);return e!==t&&($s.set(t,e),qi.set(e,t)),e}const ws=t=>qi.get(t);function B_(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=xt(o);return r&&o.addEventListener("upgradeneeded",u=>{r(xt(o.result),u.oldVersion,u.newVersion,xt(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}const L_=["get","getKey","getAll","getAllKeys","count"],x_=["put","add","delete","clear"],Cs=new Map;function Jo(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Cs.get(e))return Cs.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=x_.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||L_.includes(n)))return;const i=async function(o,...a){const u=this.transaction(o,s?"readwrite":"readonly");let l=u.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),s&&u.done]))[0]};return Cs.set(e,i),i}F_(t=>Tt(Be({},t),{get:(e,n,r)=>Jo(e,n)||t.get(e,n,r),has:(e,n)=>!!Jo(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(U_(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function U_(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Us="@firebase/app",Xo="0.7.32";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nn=new Pl("@firebase/app"),q_="@firebase/app-compat",H_="@firebase/analytics-compat",W_="@firebase/analytics",z_="@firebase/app-check-compat",K_="@firebase/app-check",G_="@firebase/auth",Y_="@firebase/auth-compat",Q_="@firebase/database",J_="@firebase/database-compat",X_="@firebase/functions",Z_="@firebase/functions-compat",eg="@firebase/installations",tg="@firebase/installations-compat",ng="@firebase/messaging",rg="@firebase/messaging-compat",sg="@firebase/performance",ig="@firebase/performance-compat",og="@firebase/remote-config",ag="@firebase/remote-config-compat",lg="@firebase/storage",ug="@firebase/storage-compat",cg="@firebase/firestore",dg="@firebase/firestore-compat",hg="firebase",fg="9.9.4",pg={[Us]:"fire-core",[q_]:"fire-core-compat",[W_]:"fire-analytics",[H_]:"fire-analytics-compat",[K_]:"fire-app-check",[z_]:"fire-app-check-compat",[G_]:"fire-auth",[Y_]:"fire-auth-compat",[Q_]:"fire-rtdb",[J_]:"fire-rtdb-compat",[X_]:"fire-fn",[Z_]:"fire-fn-compat",[eg]:"fire-iid",[tg]:"fire-iid-compat",[ng]:"fire-fcm",[rg]:"fire-fcm-compat",[sg]:"fire-perf",[ig]:"fire-perf-compat",[og]:"fire-rc",[ag]:"fire-rc-compat",[lg]:"fire-gcs",[ug]:"fire-gcs-compat",[cg]:"fire-fst",[dg]:"fire-fst-compat","fire-js":"fire-js",[hg]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mg=new Map,Zo=new Map;function _g(t,e){try{t.container.addComponent(e)}catch(n){nn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Kr(t){const e=t.name;if(Zo.has(e))return nn.debug(`There were multiple attempts to register component ${e}.`),!1;Zo.set(e,t);for(const n of mg.values())_g(n,t);return!0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gg={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Hi=new Dl("app","Firebase",gg);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yg=fg;function sr(t,e,n){var r;let s=(r=pg[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),nn.warn(a.join(" "));return}Kr(new zr(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vg="firebase-heartbeat-database",Eg=1,dr="firebase-heartbeat-store";let Ss=null;function Fl(){return Ss||(Ss=B_(vg,Eg,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(dr)}}}).catch(t=>{throw Hi.create("idb-open",{originalErrorMessage:t.message})})),Ss}async function bg(t){var e;try{return(await Fl()).transaction(dr).objectStore(dr).get(Ml(t))}catch(n){if(n instanceof vr)nn.warn(n.message);else{const r=Hi.create("idb-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message});nn.warn(r.message)}}}async function ea(t,e){var n;try{const s=(await Fl()).transaction(dr,"readwrite");return await s.objectStore(dr).put(e,Ml(t)),s.done}catch(r){if(r instanceof vr)nn.warn(r.message);else{const s=Hi.create("idb-set",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message});nn.warn(s.message)}}}function Ml(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $g=1024,wg=30*24*60*60*1e3;class Cg{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Ag(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=ta();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=wg}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=ta(),{heartbeatsToSend:n,unsentEntries:r}=Sg(this._heartbeatsCache.heartbeats),s=Sl(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function ta(){return new Date().toISOString().substring(0,10)}function Sg(t,e=$g){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),na(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),na(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Ag{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return p_()?m_().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await bg(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return ea(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return ea(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function na(t){return Sl(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tg(t){Kr(new zr("platform-logger",e=>new V_(e),"PRIVATE")),Kr(new zr("heartbeat",e=>new Cg(e),"PRIVATE")),sr(Us,Xo,t),sr(Us,Xo,"esm2017"),sr("fire-js","")}Tg("");const ra="@firebase/database",sa="0.13.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jl="";function Ig(t){jl=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ve(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:cr(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return kt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bl=function(t){try{if(typeof window!="undefined"&&typeof window[t]!="undefined"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Ng(e)}}catch{}return new Dg},Xt=Bl("localStorage"),qs=Bl("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cn=new Pl("@firebase/database"),Rg=function(){let t=1;return function(){return t++}}(),Ll=function(t){const e=C_(t),n=new $_;n.update(e);const r=n.digest();return Ui.encodeByteArray(r)},Er=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Er.apply(null,r):typeof r=="object"?e+=Ve(r):e+=r,e+=" "}return e};let Zt=null,ia=!0;const Pg=function(t,e){V(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Cn.logLevel=be.VERBOSE,Zt=Cn.log.bind(Cn),e&&qs.set("logging_enabled",!0)):typeof t=="function"?Zt=t:(Zt=null,qs.remove("logging_enabled"))},qe=function(...t){if(ia===!0&&(ia=!1,Zt===null&&qs.get("logging_enabled")===!0&&Pg(!0)),Zt){const e=Er.apply(null,t);Zt(e)}},br=function(t){return function(...e){qe(t,...e)}},Hs=function(...t){const e="FIREBASE INTERNAL ERROR: "+Er(...t);Cn.error(e)},rn=function(...t){const e=`FIREBASE FATAL ERROR: ${Er(...t)}`;throw Cn.error(e),new Error(e)},et=function(...t){const e="FIREBASE WARNING: "+Er(...t);Cn.warn(e)},kg=function(){typeof window!="undefined"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&et("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},xl=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},Og=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Nn="[MIN_NAME]",sn="[MAX_NAME]",On=function(t,e){if(t===e)return 0;if(t===Nn||e===sn)return-1;if(e===Nn||t===sn)return 1;{const n=oa(t),r=oa(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},Fg=function(t,e){return t===e?0:t<e?-1:1},Gn=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Ve(e))},Wi=function(t){if(typeof t!="object"||t===null)return Ve(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Ve(e[r]),n+=":",n+=Wi(t[e[r]]);return n+="}",n},Vl=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function ot(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const Ul=function(t){V(!xl(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,o,a,u;t===0?(i=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-r-n))));const l=[];for(u=n;u;u-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)l.push(i%2?1:0),i=Math.floor(i/2);l.push(s?1:0),l.reverse();const d=l.join("");let c="";for(u=0;u<64;u+=8){let m=parseInt(d.substr(u,8),2).toString(16);m.length===1&&(m="0"+m),c=c+m}return c.toLowerCase()},Mg=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},jg=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},Bg=new RegExp("^-?(0*)\\d{1,10}$"),Lg=-2147483648,xg=2147483647,oa=function(t){if(Bg.test(t)){const e=Number(t);if(e>=Lg&&e<=xg)return e}return null},$r=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw et("Exception was thrown by user callback.",n),e},Math.floor(0))}},Vg=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ir=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno!="undefined"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){et(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(qe("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',et(e)}}class Ws{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Ws.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zi="5",ql="v",Hl="s",Wl="r",zl="f",Kl=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Gl="ls",Yl="p",zs="ac",Ql="websocket",Jl="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(e,n,r,s,i=!1,o="",a=!1){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Xt.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Xt.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function Wg(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function Xl(t,e,n){V(typeof e=="string","typeof type must == string"),V(typeof n=="object","typeof params must == object");let r;if(e===Ql)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Jl)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Wg(t)&&(n.ns=t.namespace);const s=[];return ot(n,(i,o)=>{s.push(i+"="+o)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(){this.counters_={}}incrementCounter(e,n=1){kt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return c_(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const As={},Ts={};function Ki(t){const e=t.toString();return As[e]||(As[e]=new zg),As[e]}function Kg(t,e){const n=t.toString();return Ts[n]||(Ts[n]=e()),Ts[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&$r(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa="start",Yg="close",Qg="pLPCommand",Jg="pRTLPCB",Zl="id",eu="pw",tu="ser",Xg="cb",Zg="seg",ey="ts",ty="d",ny="dframe",nu=1870,ru=30,ry=nu-ru,sy=25e3,iy=3e4;class bn{constructor(e,n,r,s,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=br(e),this.stats_=Ki(n),this.urlFn=u=>(this.appCheckToken&&(u[zs]=this.appCheckToken),Xl(n,Jl,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Gg(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(iy)),Og(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Gi((...i)=>{const[o,a,u,l,d]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===aa)this.id=a,this.password=u;else if(o===Yg)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[aa]="t",r[tu]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[Xg]=this.scriptTagHolder.uniqueCallbackIdentifier),r[ql]=zi,this.transportSessionId&&(r[Hl]=this.transportSessionId),this.lastSessionId&&(r[Gl]=this.lastSessionId),this.applicationId&&(r[Yl]=this.applicationId),this.appCheckToken&&(r[zs]=this.appCheckToken),typeof location!="undefined"&&location.hostname&&Kl.test(location.hostname)&&(r[Wl]=zl);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){bn.forceAllow_=!0}static forceDisallow(){bn.forceDisallow_=!0}static isAvailable(){return bn.forceAllow_?!0:!bn.forceDisallow_&&typeof document!="undefined"&&document.createElement!=null&&!Mg()&&!jg()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Ve(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Cl(n),s=Vl(r,ry);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[ny]="t",r[Zl]=e,r[eu]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Ve(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Gi{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Rg(),window[Qg+this.uniqueCallbackIdentifier]=e,window[Jg+this.uniqueCallbackIdentifier]=n,this.myIFrame=Gi.createIFrame_();let i="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){const a=document.domain;i='<script>document.domain="'+a+'";<\/script>'}const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){qe("frame writing exception"),a.stack&&qe(a.stack),qe(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||qe("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Zl]=this.myID,e[eu]=this.myPW,e[tu]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+ru+r.length<=nu;){const o=this.pendingSegs.shift();r=r+"&"+Zg+s+"="+o.seg+"&"+ey+s+"="+o.ts+"&"+ty+s+"="+o.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(sy)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{qe("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oy=16384,ay=45e3;let Gr=null;typeof MozWebSocket!="undefined"?Gr=MozWebSocket:typeof WebSocket!="undefined"&&(Gr=WebSocket);class dt{constructor(e,n,r,s,i,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=br(this.connId),this.stats_=Ki(n),this.connURL=dt.connectionURL_(n,o,a,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const o={};return o[ql]=zi,typeof location!="undefined"&&location.hostname&&Kl.test(location.hostname)&&(o[Wl]=zl),n&&(o[Hl]=n),r&&(o[Gl]=r),s&&(o[zs]=s),i&&(o[Yl]=i),Xl(e,Ql,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Xt.set("previous_websocket_failure",!0);try{let r;Nl(),this.mySock=new Gr(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){dt.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator!="undefined"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Gr!==null&&!dt.forceDisallow_}static previouslyFailed(){return Xt.isInMemoryStorage||Xt.get("previous_websocket_failure")===!0}markConnectionHealthy(){Xt.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=cr(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(V(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=Ve(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Vl(n,oy);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(ay))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}dt.responsesRequiredToBeHealthy=2;dt.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[bn,dt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=dt&&dt.isAvailable();let r=n&&!dt.previouslyFailed();if(e.webSocketOnly&&(n||et("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[dt];else{const s=this.transports_=[];for(const i of hr.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);hr.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}hr.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ly=6e4,uy=5e3,cy=10*1024,dy=100*1024,Is="t",la="d",hy="s",ua="r",fy="e",ca="o",da="a",ha="n",fa="p",py="h";class my{constructor(e,n,r,s,i,o,a,u,l,d){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=br("c:"+this.id+":"),this.transportManager_=new hr(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=ir(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>dy?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>cy?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Is in e){const n=e[Is];n===da?this.upgradeIfSecondaryHealthy_():n===ua?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===ca&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Gn("t",e),r=Gn("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:fa,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:da,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:ha,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Gn("t",e),r=Gn("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Gn(Is,e);if(la in e){const r=e[la];if(n===py)this.onHandshake_(r);else if(n===ha){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===hy?this.onConnectionShutdown_(r):n===ua?this.onReset_(r):n===fy?Hs("Server Error: "+r):n===ca?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Hs("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),zi!==r&&et("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),ir(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(ly))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ir(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(uy))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:fa,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Xt.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e){this.allowedEvents_=e,this.listeners_={},V(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){V(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr extends iu{constructor(){super(["online"]),this.online_=!0,typeof window!="undefined"&&typeof window.addEventListener!="undefined"&&!Il()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Yr}getInitialEvent(e){return V(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa=32,ma=768;class Ae{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function ye(){return new Ae("")}function he(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ut(t){return t.pieces_.length-t.pieceNum_}function Ce(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ae(t.pieces_,e)}function ou(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function _y(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function au(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function lu(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ae(e,0)}function je(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Ae)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new Ae(n,0)}function ce(t){return t.pieceNum_>=t.pieces_.length}function it(t,e){const n=he(t),r=he(e);if(n===null)return e;if(n===r)return it(Ce(t),Ce(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function uu(t,e){if(Ut(t)!==Ut(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function ht(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Ut(t)>Ut(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class gy{constructor(e,n){this.errorPrefix_=n,this.parts_=au(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=ls(this.parts_[r]);cu(this)}}function yy(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=ls(e),cu(t)}function vy(t){const e=t.parts_.pop();t.byteLength_-=ls(e),t.parts_.length>0&&(t.byteLength_-=1)}function cu(t){if(t.byteLength_>ma)throw new Error(t.errorPrefix_+"has a key path longer than "+ma+" bytes ("+t.byteLength_+").");if(t.parts_.length>pa)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+pa+") or object contains a cycle "+Gt(t))}function Gt(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi extends iu{constructor(){super(["visible"]);let e,n;typeof document!="undefined"&&typeof document.addEventListener!="undefined"&&(typeof document.hidden!="undefined"?(n="visibilitychange",e="hidden"):typeof document.mozHidden!="undefined"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden!="undefined"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new Yi}getInitialEvent(e){return V(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yn=1e3,Ey=60*5*1e3,_a=30*1e3,by=1.3,$y=3e4,wy="server_kill",ga=3;class Pt extends su{constructor(e,n,r,s,i,o,a,u){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=u,this.id=Pt.nextPersistentConnectionId_++,this.log_=br("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Yn,this.maxReconnectDelay_=Ey,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!Nl())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Yi.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Yr.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(Ve(i)),V(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new Tl,r={p:e._path.toString(),q:e._queryObject},s={action:"g",request:r,onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),V(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),V(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const u=a.d,l=a.s;Pt.warnOnListenWarnings_(u,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",a),l!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(l,u))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&kt(e,"w")){const r=In(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();et(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||E_(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=_a)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=v_(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,o=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),V(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";s&&(i.q=r,i.t=s),this.sendRequest(o,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const o={p:n,d:r};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Ve(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Hs("Unrecognized action received from server: "+Ve(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){V(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Yn,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Yn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>$y&&(this.reconnectDelay_=Yn),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*by)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Pt.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const u=function(){a?a.close():(o=!0,r())},l=function(c){V(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(c)};this.realtime_={close:u,sendRequest:l};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[c,m]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);o?qe("getToken() completed but was canceled"):(qe("getToken() completed. Creating connection."),this.authToken_=c&&c.accessToken,this.appCheckToken_=m&&m.token,a=new my(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,$=>{et($+" ("+this.repoInfo_.toString()+")"),this.interrupt(wy)},i))}catch(c){this.log_("Failed to get token: "+c),o||(this.repoInfo_.nodeAdmin&&et(c),u())}}}interrupt(e){qe("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){qe("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Go(this.interruptReasons_)&&(this.reconnectDelay_=Yn,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>Wi(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new Ae(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){qe("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=ga&&(this.reconnectDelay_=_a,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){qe("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=ga&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+jl.replace(/\./g,"-")]=1,Il()?e["framework.cordova"]=1:f_()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Yr.getInstance().currentlyOnline();return Go(this.interruptReasons_)&&e}}Pt.nextPersistentConnectionId_=0;Pt.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new fe(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new fe(Nn,e),s=new fe(Nn,n);return this.compare(r,s)!==0}minPost(){return fe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Or;class du extends us{static get __EMPTY_NODE(){return Or}static set __EMPTY_NODE(e){Or=e}compare(e,n){return On(e.name,n.name)}isDefinedOn(e){throw kn("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return fe.MIN}maxPost(){return new fe(sn,Or)}makePost(e,n){return V(typeof e=="string","KeyIndex indexValue must always be a string."),new fe(e,Or)}toString(){return".key"}}const Sn=new du;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Me{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r!=null?r:Me.RED,this.left=s!=null?s:Xe.EMPTY_NODE,this.right=i!=null?i:Xe.EMPTY_NODE}copy(e,n,r,s,i){return new Me(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,s!=null?s:this.left,i!=null?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Xe.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return Xe.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Me.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Me.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Me.RED=!0;Me.BLACK=!1;class Cy{copy(e,n,r,s,i){return this}insert(e,n,r){return new Me(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Xe{constructor(e,n=Xe.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Xe(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Me.BLACK,null,null))}remove(e){return new Xe(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Me.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Fr(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Fr(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Fr(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Fr(this.root_,null,this.comparator_,!0,e)}}Xe.EMPTY_NODE=new Cy;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sy(t,e){return On(t.name,e.name)}function Qi(t,e){return On(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ks;function Ay(t){Ks=t}const hu=function(t){return typeof t=="number"?"number:"+Ul(t):"string:"+t},fu=function(t){if(t.isLeafNode()){const e=t.val();V(typeof e=="string"||typeof e=="number"||typeof e=="object"&&kt(e,".sv"),"Priority must be a string or number.")}else V(t===Ks||t.isEmpty(),"priority of unexpected type.");V(t===Ks||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ya;class Fe{constructor(e,n=Fe.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,V(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),fu(this.priorityNode_)}static set __childrenNodeConstructor(e){ya=e}static get __childrenNodeConstructor(){return ya}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Fe(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Fe.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ce(e)?this:he(e)===".priority"?this.priorityNode_:Fe.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Fe.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=he(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(V(r!==".priority"||Ut(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Fe.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ce(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+hu(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=Ul(this.value_):e+=this.value_,this.lazyHash_=Ll(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Fe.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Fe.__childrenNodeConstructor?-1:(V(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=Fe.VALUE_TYPE_ORDER.indexOf(n),i=Fe.VALUE_TYPE_ORDER.indexOf(r);return V(s>=0,"Unknown leaf type: "+n),V(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Fe.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pu,mu;function Ty(t){pu=t}function Iy(t){mu=t}class Ny extends us{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?On(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return fe.MIN}maxPost(){return new fe(sn,new Fe("[PRIORITY-POST]",mu))}makePost(e,n){const r=pu(e);return new fe(n,new Fe("[PRIORITY-POST]",r))}toString(){return".priority"}}const We=new Ny;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dy=Math.log(2);class Ry{constructor(e){const n=i=>parseInt(Math.log(i)/Dy,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Qr=function(t,e,n,r){t.sort(e);const s=function(u,l){const d=l-u;let c,m;if(d===0)return null;if(d===1)return c=t[u],m=n?n(c):c,new Me(m,c.node,Me.BLACK,null,null);{const $=parseInt(d/2,10)+u,v=s(u,$),S=s($+1,l);return c=t[$],m=n?n(c):c,new Me(m,c.node,Me.BLACK,v,S)}},i=function(u){let l=null,d=null,c=t.length;const m=function(v,S){const w=c-v,y=c;c-=v;const I=s(w+1,y),D=t[w],O=n?n(D):D;$(new Me(O,D.node,S,null,I))},$=function(v){l?(l.left=v,l=v):(d=v,l=v)};for(let v=0;v<u.count;++v){const S=u.nextBitIsOne(),w=Math.pow(2,u.count-(v+1));S?m(w,Me.BLACK):(m(w,Me.BLACK),m(w,Me.RED))}return d},o=new Ry(t.length),a=i(o);return new Xe(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ns;const vn={};class Nt{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return V(vn&&We,"ChildrenNode.ts has not been loaded"),Ns=Ns||new Nt({".priority":vn},{".priority":We}),Ns}get(e){const n=In(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Xe?n:null}hasIndex(e){return kt(this.indexSet_,e.toString())}addIndex(e,n){V(e!==Sn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(fe.Wrap);let o=i.getNext();for(;o;)s=s||e.isDefinedOn(o.node),r.push(o),o=i.getNext();let a;s?a=Qr(r,e.getCompare()):a=vn;const u=e.toString(),l=Object.assign({},this.indexSet_);l[u]=e;const d=Object.assign({},this.indexes_);return d[u]=a,new Nt(d,l)}addToIndexes(e,n){const r=Wr(this.indexes_,(s,i)=>{const o=In(this.indexSet_,i);if(V(o,"Missing index implementation for "+i),s===vn)if(o.isDefinedOn(e.node)){const a=[],u=n.getIterator(fe.Wrap);let l=u.getNext();for(;l;)l.name!==e.name&&a.push(l),l=u.getNext();return a.push(e),Qr(a,o.getCompare())}else return vn;else{const a=n.get(e.name);let u=s;return a&&(u=u.remove(new fe(e.name,a))),u.insert(e,e.node)}});return new Nt(r,this.indexSet_)}removeFromIndexes(e,n){const r=Wr(this.indexes_,s=>{if(s===vn)return s;{const i=n.get(e.name);return i?s.remove(new fe(e.name,i)):s}});return new Nt(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qn;class _e{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&fu(this.priorityNode_),this.children_.isEmpty()&&V(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Qn||(Qn=new _e(new Xe(Qi),null,Nt.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Qn}updatePriority(e){return this.children_.isEmpty()?this:new _e(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Qn:n}}getChild(e){const n=he(e);return n===null?this:this.getImmediateChild(n).getChild(Ce(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(V(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new fe(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const o=s.isEmpty()?Qn:this.priorityNode_;return new _e(s,o,i)}}updateChild(e,n){const r=he(e);if(r===null)return n;{V(he(e)!==".priority"||Ut(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Ce(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild(We,(o,a)=>{n[o]=a.val(e),r++,i&&_e.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):i=!1}),!e&&i&&s<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+hu(this.getPriority().val())+":"),this.forEachChild(We,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":Ll(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new fe(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new fe(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new fe(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,fe.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,fe.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===wr?-1:0}withIndex(e){if(e===Sn||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new _e(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Sn||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(We),s=n.getIterator(We);let i=r.getNext(),o=s.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=s.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Sn?null:this.indexMap_.get(e.toString())}}_e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Py extends _e{constructor(){super(new Xe(Qi),_e.EMPTY_NODE,Nt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return _e.EMPTY_NODE}isEmpty(){return!1}}const wr=new Py;Object.defineProperties(fe,{MIN:{value:new fe(Nn,_e.EMPTY_NODE)},MAX:{value:new fe(sn,wr)}});du.__EMPTY_NODE=_e.EMPTY_NODE;Fe.__childrenNodeConstructor=_e;Ay(wr);Iy(wr);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ky=!0;function He(t,e=null){if(t===null)return _e.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),V(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Fe(n,He(e))}if(!(t instanceof Array)&&ky){const n=[];let r=!1;if(ot(t,(o,a)=>{if(o.substring(0,1)!=="."){const u=He(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new fe(o,u)))}}),n.length===0)return _e.EMPTY_NODE;const i=Qr(n,Sy,o=>o.name,Qi);if(r){const o=Qr(n,We.getCompare());return new _e(i,He(e),new Nt({".priority":o},{".priority":We}))}else return new _e(i,He(e),Nt.Default)}else{let n=_e.EMPTY_NODE;return ot(t,(r,s)=>{if(kt(t,r)&&r.substring(0,1)!=="."){const i=He(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(He(e))}}Ty(He);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy extends us{constructor(e){super(),this.indexPath_=e,V(!ce(e)&&he(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?On(e.name,n.name):i}makePost(e,n){const r=He(e),s=_e.EMPTY_NODE.updateChild(this.indexPath_,r);return new fe(n,s)}maxPost(){const e=_e.EMPTY_NODE.updateChild(this.indexPath_,wr);return new fe(sn,e)}toString(){return au(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy extends us{compare(e,n){const r=e.node.compareTo(n.node);return r===0?On(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return fe.MIN}maxPost(){return fe.MAX}makePost(e,n){const r=He(e);return new fe(n,r)}toString(){return".value"}}const My=new Fy;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jy(t){return{type:"value",snapshotNode:t}}function By(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ly(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function va(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function xy(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=We}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return V(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return V(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Nn}hasEnd(){return this.endSet_}getIndexEndValue(){return V(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return V(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:sn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return V(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===We}copy(){const e=new Ji;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Ea(t){const e={};if(t.isDefault())return e;let n;return t.index_===We?n="$priority":t.index_===My?n="$value":t.index_===Sn?n="$key":(V(t.index_ instanceof Oy,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Ve(n),t.startSet_&&(e.startAt=Ve(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+Ve(t.indexStartName_))),t.endSet_&&(e.endAt=Ve(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+Ve(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function ba(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==We&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr extends su{constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=br("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(V(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=Jr.getListenId_(e,r),a={};this.listens_[o]=a;const u=Ea(e._queryParams);this.restRequest_(i+".json",u,(l,d)=>{let c=d;if(l===404&&(c=null,l=null),l===null&&this.onDataUpdate_(i,c,!1,r),In(this.listens_,o)===a){let m;l?l===401?m="permission_denied":m="rest_error:"+l:m="ok",s(m,null)}})}unlisten(e,n){const r=Jr.getListenId_(e,n);delete this.listens_[r]}get(e){const n=Ea(e._queryParams),r=e._path.toString(),s=new Tl;return this.restRequest_(r+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(r,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+b_(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=cr(a.responseText)}catch{et("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&et("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(){this.rootNode_=_e.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xr(){return{value:null,children:new Map}}function _u(t,e,n){if(ce(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=he(e);t.children.has(r)||t.children.set(r,Xr());const s=t.children.get(r);e=Ce(e),_u(s,e,n)}}function Gs(t,e,n){t.value!==null?n(e,t.value):Uy(t,(r,s)=>{const i=new Ae(e.toString()+"/"+r);Gs(s,i,n)})}function Uy(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&ot(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a=10*1e3,Hy=30*1e3,Wy=5*60*1e3;class zy{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new qy(e);const r=$a+(Hy-$a)*Math.random();ir(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;ot(e,(s,i)=>{i>0&&kt(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),ir(this.reportStats_.bind(this),Math.floor(Math.random()*2*Wy))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ct||(Ct={}));function gu(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function yu(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function vu(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Ct.ACK_USER_WRITE,this.source=gu()}operationForChild(e){if(ce(this.path)){if(this.affectedTree.value!=null)return V(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ae(e));return new Zr(ye(),n,this.revert)}}else return V(he(this.path)===e,"operationForChild called for unrelated child."),new Zr(Ce(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Ct.OVERWRITE}operationForChild(e){return ce(this.path)?new on(this.source,ye(),this.snap.getImmediateChild(e)):new on(this.source,Ce(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Ct.MERGE}operationForChild(e){if(ce(this.path)){const n=this.children.subtree(new Ae(e));return n.isEmpty()?null:n.value?new on(this.source,ye(),n.value):new fr(this.source,ye(),n)}else return V(he(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new fr(this.source,Ce(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ce(e))return this.isFullyInitialized()&&!this.filtered_;const n=he(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function Ky(t,e,n,r){const s=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(xy(o.childName,o.snapshotNode))}),Jn(t,s,"child_removed",e,r,n),Jn(t,s,"child_added",e,r,n),Jn(t,s,"child_moved",i,r,n),Jn(t,s,"child_changed",e,r,n),Jn(t,s,"value",e,r,n),s}function Jn(t,e,n,r,s,i){const o=r.filter(a=>a.type===n);o.sort((a,u)=>Yy(t,a,u)),o.forEach(a=>{const u=Gy(t,a,i);s.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(u,t.query_))})})}function Gy(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function Yy(t,e,n){if(e.childName==null||n.childName==null)throw kn("Should only compare child_ events.");const r=new fe(e.childName,e.snapshotNode),s=new fe(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eu(t,e){return{eventCache:t,serverCache:e}}function or(t,e,n,r){return Eu(new Xi(e,n,r),t.serverCache)}function bu(t,e,n,r){return Eu(t.eventCache,new Xi(e,n,r))}function Ys(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function an(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ds;const Qy=()=>(Ds||(Ds=new Xe(Fg)),Ds);class we{constructor(e,n=Qy()){this.value=e,this.children=n}static fromObject(e){let n=new we(null);return ot(e,(r,s)=>{n=n.set(new Ae(r),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ye(),value:this.value};if(ce(e))return null;{const r=he(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(Ce(e),n);return i!=null?{path:je(new Ae(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ce(e))return this;{const n=he(e),r=this.children.get(n);return r!==null?r.subtree(Ce(e)):new we(null)}}set(e,n){if(ce(e))return new we(n,this.children);{const r=he(e),i=(this.children.get(r)||new we(null)).set(Ce(e),n),o=this.children.insert(r,i);return new we(this.value,o)}}remove(e){if(ce(e))return this.children.isEmpty()?new we(null):new we(null,this.children);{const n=he(e),r=this.children.get(n);if(r){const s=r.remove(Ce(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new we(null):new we(this.value,i)}else return this}}get(e){if(ce(e))return this.value;{const n=he(e),r=this.children.get(n);return r?r.get(Ce(e)):null}}setTree(e,n){if(ce(e))return n;{const r=he(e),i=(this.children.get(r)||new we(null)).setTree(Ce(e),n);let o;return i.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,i),new we(this.value,o)}}fold(e){return this.fold_(ye(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(je(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ye(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(ce(e))return null;{const i=he(e),o=this.children.get(i);return o?o.findOnPath_(Ce(e),je(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ye(),n)}foreachOnPath_(e,n,r){if(ce(e))return this;{this.value&&r(n,this.value);const s=he(e),i=this.children.get(s);return i?i.foreachOnPath_(Ce(e),je(n,s),r):new we(null)}}foreach(e){this.foreach_(ye(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(je(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e){this.writeTree_=e}static empty(){return new pt(new we(null))}}function ar(t,e,n){if(ce(e))return new pt(new we(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const o=it(s,e);return i=i.updateChild(o,n),new pt(t.writeTree_.set(s,i))}else{const s=new we(n),i=t.writeTree_.setTree(e,s);return new pt(i)}}}function wa(t,e,n){let r=t;return ot(n,(s,i)=>{r=ar(r,je(e,s),i)}),r}function Ca(t,e){if(ce(e))return pt.empty();{const n=t.writeTree_.setTree(e,new we(null));return new pt(n)}}function Qs(t,e){return ln(t,e)!=null}function ln(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(it(n.path,e)):null}function Sa(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(We,(r,s)=>{e.push(new fe(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new fe(r,s.value))}),e}function Vt(t,e){if(ce(e))return t;{const n=ln(t,e);return n!=null?new pt(new we(n)):new pt(t.writeTree_.subtree(e))}}function Js(t){return t.writeTree_.isEmpty()}function Dn(t,e){return $u(ye(),t.writeTree_,e)}function $u(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(V(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=$u(je(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(je(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wu(t,e){return Iu(e,t)}function Jy(t,e,n,r,s){V(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=ar(t.visibleWrites,e,n)),t.lastWriteId=r}function Xy(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function Zy(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);V(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,o=t.allWrites.length-1;for(;s&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&ev(a,r.path)?s=!1:ht(r.path,a.path)&&(i=!0)),o--}if(s){if(i)return tv(t),!0;if(r.snap)t.visibleWrites=Ca(t.visibleWrites,r.path);else{const a=r.children;ot(a,u=>{t.visibleWrites=Ca(t.visibleWrites,je(r.path,u))})}return!0}else return!1}function ev(t,e){if(t.snap)return ht(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&ht(je(t.path,n),e))return!0;return!1}function tv(t){t.visibleWrites=Cu(t.allWrites,nv,ye()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function nv(t){return t.visible}function Cu(t,e,n){let r=pt.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const o=i.path;let a;if(i.snap)ht(n,o)?(a=it(n,o),r=ar(r,a,i.snap)):ht(o,n)&&(a=it(o,n),r=ar(r,ye(),i.snap.getChild(a)));else if(i.children){if(ht(n,o))a=it(n,o),r=wa(r,a,i.children);else if(ht(o,n))if(a=it(o,n),ce(a))r=wa(r,ye(),i.children);else{const u=In(i.children,he(a));if(u){const l=u.getChild(Ce(a));r=ar(r,ye(),l)}}}else throw kn("WriteRecord should have .snap or .children")}}return r}function Su(t,e,n,r,s){if(!r&&!s){const i=ln(t.visibleWrites,e);if(i!=null)return i;{const o=Vt(t.visibleWrites,e);if(Js(o))return n;if(n==null&&!Qs(o,ye()))return null;{const a=n||_e.EMPTY_NODE;return Dn(o,a)}}}else{const i=Vt(t.visibleWrites,e);if(!s&&Js(i))return n;if(!s&&n==null&&!Qs(i,ye()))return null;{const o=function(l){return(l.visible||s)&&(!r||!~r.indexOf(l.writeId))&&(ht(l.path,e)||ht(e,l.path))},a=Cu(t.allWrites,o,e),u=n||_e.EMPTY_NODE;return Dn(a,u)}}}function rv(t,e,n){let r=_e.EMPTY_NODE;const s=ln(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(We,(i,o)=>{r=r.updateImmediateChild(i,o)}),r;if(n){const i=Vt(t.visibleWrites,e);return n.forEachChild(We,(o,a)=>{const u=Dn(Vt(i,new Ae(o)),a);r=r.updateImmediateChild(o,u)}),Sa(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const i=Vt(t.visibleWrites,e);return Sa(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function sv(t,e,n,r,s){V(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=je(e,n);if(Qs(t.visibleWrites,i))return null;{const o=Vt(t.visibleWrites,i);return Js(o)?s.getChild(n):Dn(o,s.getChild(n))}}function iv(t,e,n,r){const s=je(e,n),i=ln(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const o=Vt(t.visibleWrites,s);return Dn(o,r.getNode().getImmediateChild(n))}else return null}function ov(t,e){return ln(t.visibleWrites,e)}function av(t,e,n,r,s,i,o){let a;const u=Vt(t.visibleWrites,e),l=ln(u,ye());if(l!=null)a=l;else if(n!=null)a=Dn(u,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const d=[],c=o.getCompare(),m=i?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let $=m.getNext();for(;$&&d.length<s;)c($,r)!==0&&d.push($),$=m.getNext();return d}else return[]}function lv(){return{visibleWrites:pt.empty(),allWrites:[],lastWriteId:-1}}function Xs(t,e,n,r){return Su(t.writeTree,t.treePath,e,n,r)}function Au(t,e){return rv(t.writeTree,t.treePath,e)}function Aa(t,e,n,r){return sv(t.writeTree,t.treePath,e,n,r)}function es(t,e){return ov(t.writeTree,je(t.treePath,e))}function uv(t,e,n,r,s,i){return av(t.writeTree,t.treePath,e,n,r,s,i)}function Zi(t,e,n){return iv(t.writeTree,t.treePath,e,n)}function Tu(t,e){return Iu(je(t.treePath,e),t.writeTree)}function Iu(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;V(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),V(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,va(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,Ly(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,By(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,va(r,e.snapshotNode,s.oldSnap));else throw kn("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const Nu=new dv;class eo{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Xi(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Zi(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:an(this.viewCache_),i=uv(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}function hv(t,e){V(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),V(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function fv(t,e,n,r,s){const i=new cv;let o,a;if(n.type===Ct.OVERWRITE){const l=n;l.source.fromUser?o=Zs(t,e,l.path,l.snap,r,s,i):(V(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!ce(l.path),o=ts(t,e,l.path,l.snap,r,s,a,i))}else if(n.type===Ct.MERGE){const l=n;l.source.fromUser?o=mv(t,e,l.path,l.children,r,s,i):(V(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=ei(t,e,l.path,l.children,r,s,a,i))}else if(n.type===Ct.ACK_USER_WRITE){const l=n;l.revert?o=yv(t,e,l.path,r,s,i):o=_v(t,e,l.path,l.affectedTree,r,s,i)}else if(n.type===Ct.LISTEN_COMPLETE)o=gv(t,e,n.path,r,i);else throw kn("Unknown operation type: "+n.type);const u=i.getChanges();return pv(e,o,u),{viewCache:o,changes:u}}function pv(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=Ys(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(jy(Ys(e)))}}function Du(t,e,n,r,s,i){const o=e.eventCache;if(es(r,n)!=null)return e;{let a,u;if(ce(n))if(V(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=an(e),d=l instanceof _e?l:_e.EMPTY_NODE,c=Au(r,d);a=t.filter.updateFullNode(e.eventCache.getNode(),c,i)}else{const l=Xs(r,an(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,i)}else{const l=he(n);if(l===".priority"){V(Ut(n)===1,"Can't have a priority with additional path components");const d=o.getNode();u=e.serverCache.getNode();const c=Aa(r,n,d,u);c!=null?a=t.filter.updatePriority(d,c):a=o.getNode()}else{const d=Ce(n);let c;if(o.isCompleteForChild(l)){u=e.serverCache.getNode();const m=Aa(r,n,o.getNode(),u);m!=null?c=o.getNode().getImmediateChild(l).updateChild(d,m):c=o.getNode().getImmediateChild(l)}else c=Zi(r,l,e.serverCache);c!=null?a=t.filter.updateChild(o.getNode(),l,c,d,s,i):a=o.getNode()}}return or(e,a,o.isFullyInitialized()||ce(n),t.filter.filtersNodes())}}function ts(t,e,n,r,s,i,o,a){const u=e.serverCache;let l;const d=o?t.filter:t.filter.getIndexedFilter();if(ce(n))l=d.updateFullNode(u.getNode(),r,null);else if(d.filtersNodes()&&!u.isFiltered()){const $=u.getNode().updateChild(n,r);l=d.updateFullNode(u.getNode(),$,null)}else{const $=he(n);if(!u.isCompleteForPath(n)&&Ut(n)>1)return e;const v=Ce(n),w=u.getNode().getImmediateChild($).updateChild(v,r);$===".priority"?l=d.updatePriority(u.getNode(),w):l=d.updateChild(u.getNode(),$,w,v,Nu,null)}const c=bu(e,l,u.isFullyInitialized()||ce(n),d.filtersNodes()),m=new eo(s,c,i);return Du(t,c,n,s,m,a)}function Zs(t,e,n,r,s,i,o){const a=e.eventCache;let u,l;const d=new eo(s,e,i);if(ce(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=or(e,l,!0,t.filter.filtersNodes());else{const c=he(n);if(c===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),r),u=or(e,l,a.isFullyInitialized(),a.isFiltered());else{const m=Ce(n),$=a.getNode().getImmediateChild(c);let v;if(ce(m))v=r;else{const S=d.getCompleteChild(c);S!=null?ou(m)===".priority"&&S.getChild(lu(m)).isEmpty()?v=S:v=S.updateChild(m,r):v=_e.EMPTY_NODE}if($.equals(v))u=e;else{const S=t.filter.updateChild(a.getNode(),c,v,m,d,o);u=or(e,S,a.isFullyInitialized(),t.filter.filtersNodes())}}}return u}function Ta(t,e){return t.eventCache.isCompleteForChild(e)}function mv(t,e,n,r,s,i,o){let a=e;return r.foreach((u,l)=>{const d=je(n,u);Ta(e,he(d))&&(a=Zs(t,a,d,l,s,i,o))}),r.foreach((u,l)=>{const d=je(n,u);Ta(e,he(d))||(a=Zs(t,a,d,l,s,i,o))}),a}function Ia(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function ei(t,e,n,r,s,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,l;ce(n)?l=r:l=new we(null).setTree(n,r);const d=e.serverCache.getNode();return l.children.inorderTraversal((c,m)=>{if(d.hasChild(c)){const $=e.serverCache.getNode().getImmediateChild(c),v=Ia(t,$,m);u=ts(t,u,new Ae(c),v,s,i,o,a)}}),l.children.inorderTraversal((c,m)=>{const $=!e.serverCache.isCompleteForChild(c)&&m.value===null;if(!d.hasChild(c)&&!$){const v=e.serverCache.getNode().getImmediateChild(c),S=Ia(t,v,m);u=ts(t,u,new Ae(c),S,s,i,o,a)}}),u}function _v(t,e,n,r,s,i,o){if(es(s,n)!=null)return e;const a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(ce(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return ts(t,e,n,u.getNode().getChild(n),s,i,a,o);if(ce(n)){let l=new we(null);return u.getNode().forEachChild(Sn,(d,c)=>{l=l.set(new Ae(d),c)}),ei(t,e,n,l,s,i,a,o)}else return e}else{let l=new we(null);return r.foreach((d,c)=>{const m=je(n,d);u.isCompleteForPath(m)&&(l=l.set(d,u.getNode().getChild(m)))}),ei(t,e,n,l,s,i,a,o)}}function gv(t,e,n,r,s){const i=e.serverCache,o=bu(e,i.getNode(),i.isFullyInitialized()||ce(n),i.isFiltered());return Du(t,o,n,r,Nu,s)}function yv(t,e,n,r,s,i){let o;if(es(r,n)!=null)return e;{const a=new eo(r,e,s),u=e.eventCache.getNode();let l;if(ce(n)||he(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=Xs(r,an(e));else{const c=e.serverCache.getNode();V(c instanceof _e,"serverChildren would be complete if leaf node"),d=Au(r,c)}d=d,l=t.filter.updateFullNode(u,d,i)}else{const d=he(n);let c=Zi(r,d,e.serverCache);c==null&&e.serverCache.isCompleteForChild(d)&&(c=u.getImmediateChild(d)),c!=null?l=t.filter.updateChild(u,d,c,Ce(n),a,i):e.eventCache.getNode().hasChild(d)?l=t.filter.updateChild(u,d,_e.EMPTY_NODE,Ce(n),a,i):l=u,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Xs(r,an(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,i)))}return o=e.serverCache.isFullyInitialized()||es(r,ye())!=null,or(e,l,o,t.filter.filtersNodes())}}function vv(t,e){const n=an(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ce(e)&&!n.getImmediateChild(he(e)).isEmpty())?n.getChild(e):null}function Na(t,e,n,r){e.type===Ct.MERGE&&e.source.queryId!==null&&(V(an(t.viewCache_),"We should always have a full cache before handling merges"),V(Ys(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=fv(t.processor_,s,e,n,r);return hv(t.processor_,i.viewCache),V(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,Ev(t,i.changes,i.viewCache.eventCache.getNode(),null)}function Ev(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return Ky(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Da;function bv(t){V(!Da,"__referenceConstructor has already been defined"),Da=t}function to(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return V(i!=null,"SyncTree gave us an op for an invalid query."),Na(i,e,n,r)}else{let i=[];for(const o of t.views.values())i=i.concat(Na(o,e,n,r));return i}}function no(t,e){let n=null;for(const r of t.views.values())n=n||vv(r,e);return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ra;function $v(t){V(!Ra,"__referenceConstructor has already been defined"),Ra=t}class Pa{constructor(e){this.listenProvider_=e,this.syncPointTree_=new we(null),this.pendingWriteTree_=lv(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function wv(t,e,n,r,s){return Jy(t.pendingWriteTree_,e,n,r,s),s?ds(t,new on(gu(),e,n)):[]}function $n(t,e,n=!1){const r=Xy(t.pendingWriteTree_,e);if(Zy(t.pendingWriteTree_,e)){let i=new we(null);return r.snap!=null?i=i.set(ye(),!0):ot(r.children,o=>{i=i.set(new Ae(o),!0)}),ds(t,new Zr(r.path,i,n))}else return[]}function cs(t,e,n){return ds(t,new on(yu(),e,n))}function Cv(t,e,n){const r=we.fromObject(n);return ds(t,new fr(yu(),e,r))}function Sv(t,e,n,r){const s=Ou(t,r);if(s!=null){const i=Fu(s),o=i.path,a=i.queryId,u=it(o,e),l=new on(vu(a),u,n);return Mu(t,o,l)}else return[]}function Av(t,e,n,r){const s=Ou(t,r);if(s){const i=Fu(s),o=i.path,a=i.queryId,u=it(o,e),l=we.fromObject(n),d=new fr(vu(a),u,l);return Mu(t,o,d)}else return[]}function Ru(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const u=it(o,e),l=no(a,u);if(l)return l});return Su(s,e,i,n,!0)}function ds(t,e){return Pu(e,t.syncPointTree_,null,wu(t.pendingWriteTree_,ye()))}function Pu(t,e,n,r){if(ce(t.path))return ku(t,e,n,r);{const s=e.get(ye());n==null&&s!=null&&(n=no(s,ye()));let i=[];const o=he(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){const l=n?n.getImmediateChild(o):null,d=Tu(r,o);i=i.concat(Pu(a,u,l,d))}return s&&(i=i.concat(to(s,t,r,n))),i}}function ku(t,e,n,r){const s=e.get(ye());n==null&&s!=null&&(n=no(s,ye()));let i=[];return e.children.inorderTraversal((o,a)=>{const u=n?n.getImmediateChild(o):null,l=Tu(r,o),d=t.operationForChild(o);d&&(i=i.concat(ku(d,a,u,l)))}),s&&(i=i.concat(to(s,t,r,n))),i}function Ou(t,e){return t.tagToQueryMap.get(e)}function Fu(t){const e=t.indexOf("$");return V(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ae(t.substr(0,e))}}function Mu(t,e,n){const r=t.syncPointTree_.get(e);V(r,"Missing sync point for query tag that we're tracking");const s=wu(t.pendingWriteTree_,e);return to(r,n,s,null)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new ro(n)}node(){return this.node_}}class so{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=je(this.path_,e);return new so(this.syncTree_,n)}node(){return Ru(this.syncTree_,this.path_)}}const Tv=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},ka=function(t,e,n){if(!t||typeof t!="object")return t;if(V(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Iv(t[".sv"],e,n);if(typeof t[".sv"]=="object")return Nv(t[".sv"],e);V(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Iv=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:V(!1,"Unexpected server value: "+t)}},Nv=function(t,e,n){t.hasOwnProperty("increment")||V(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&V(!1,"Unexpected increment value: "+r);const s=e.node();if(V(s!==null&&typeof s!="undefined","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const o=s.getValue();return typeof o!="number"?r:o+r},Dv=function(t,e,n,r){return io(e,new so(n,t),r)},Rv=function(t,e,n){return io(t,new ro(e),n)};function io(t,e,n){const r=t.getPriority().val(),s=ka(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=ka(o.getValue(),e,n);return a!==o.getValue()||s!==o.getPriority().val()?new Fe(a,He(s)):t}else{const o=t;return i=o,s!==o.getPriority().val()&&(i=i.updatePriority(new Fe(s))),o.forEachChild(We,(a,u)=>{const l=io(u,e.getImmediateChild(a),n);l!==u&&(i=i.updateImmediateChild(a,l))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function ao(t,e){let n=e instanceof Ae?e:new Ae(e),r=t,s=he(n);for(;s!==null;){const i=In(r.node.children,s)||{children:{},childCount:0};r=new oo(s,r,i),n=Ce(n),s=he(n)}return r}function Fn(t){return t.node.value}function ju(t,e){t.node.value=e,ti(t)}function Bu(t){return t.node.childCount>0}function Pv(t){return Fn(t)===void 0&&!Bu(t)}function hs(t,e){ot(t.node.children,(n,r)=>{e(new oo(n,t,r))})}function Lu(t,e,n,r){n&&!r&&e(t),hs(t,s=>{Lu(s,e,!0,r)}),n&&r&&e(t)}function kv(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Cr(t){return new Ae(t.parent===null?t.name:Cr(t.parent)+"/"+t.name)}function ti(t){t.parent!==null&&Ov(t.parent,t.name,t)}function Ov(t,e,n){const r=Pv(n),s=kt(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,ti(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,ti(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv=/[\[\].#$\/\u0000-\u001F\u007F]/,Mv=/[\[\].#$\u0000-\u001F\u007F]/,Rs=10*1024*1024,xu=function(t){return typeof t=="string"&&t.length!==0&&!Fv.test(t)},jv=function(t){return typeof t=="string"&&t.length!==0&&!Mv.test(t)},Bv=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),jv(t)},Vu=function(t,e,n){const r=n instanceof Ae?new gy(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Gt(r));if(typeof e=="function")throw new Error(t+"contains a function "+Gt(r)+" with contents = "+e.toString());if(xl(e))throw new Error(t+"contains "+e.toString()+" "+Gt(r));if(typeof e=="string"&&e.length>Rs/3&&ls(e)>Rs)throw new Error(t+"contains a string greater than "+Rs+" utf8 bytes "+Gt(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(ot(e,(o,a)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!xu(o)))throw new Error(t+" contains an invalid key ("+o+") "+Gt(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);yy(r,o),Vu(t,a,r),vy(r)}),s&&i)throw new Error(t+' contains ".value" child '+Gt(r)+" in addition to actual children.")}},Lv=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!xu(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!Bv(n))throw new Error(w_(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Vv(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!uu(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function un(t,e,n){Vv(t,n),Uv(t,r=>ht(r,e)||ht(e,r))}function Uv(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(qv(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function qv(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();Zt&&qe("event: "+n.toString()),$r(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hv="repo_interrupt",Wv=25;class zv{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new xv,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Xr(),this.transactionQueueTree_=new oo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Kv(t,e,n){if(t.stats_=Ki(t.repoInfo_),t.forceRestClient_||Vg())t.server_=new Jr(t.repoInfo_,(r,s,i,o)=>{Oa(t,r,s,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Fa(t,!0),0);else{if(typeof n!="undefined"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ve(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Pt(t.repoInfo_,e,(r,s,i,o)=>{Oa(t,r,s,i,o)},r=>{Fa(t,r)},r=>{Yv(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=Kg(t.repoInfo_,()=>new zy(t.stats_,t.server_)),t.infoData_=new Vy,t.infoSyncTree_=new Pa({startListening:(r,s,i,o)=>{let a=[];const u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=cs(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),lo(t,"connected",!1),t.serverSyncTree_=new Pa({startListening:(r,s,i,o)=>(t.server_.listen(r,i,s,(a,u)=>{const l=o(a,u);un(t.eventQueue_,r._path,l)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function Gv(t){const n=t.infoData_.getNode(new Ae(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Uu(t){return Tv({timestamp:Gv(t)})}function Oa(t,e,n,r,s){t.dataUpdateCount++;const i=new Ae(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(r){const u=Wr(n,l=>He(l));o=Av(t.serverSyncTree_,i,u,s)}else{const u=He(n);o=Sv(t.serverSyncTree_,i,u,s)}else if(r){const u=Wr(n,l=>He(l));o=Cv(t.serverSyncTree_,i,u)}else{const u=He(n);o=cs(t.serverSyncTree_,i,u)}let a=i;o.length>0&&(a=co(t,i)),un(t.eventQueue_,a,o)}function Fa(t,e){lo(t,"connected",e),e===!1&&Jv(t)}function Yv(t,e){ot(e,(n,r)=>{lo(t,n,r)})}function lo(t,e,n){const r=new Ae("/.info/"+e),s=He(n);t.infoData_.updateSnapshot(r,s);const i=cs(t.infoSyncTree_,r,s);un(t.eventQueue_,r,i)}function Qv(t){return t.nextWriteId_++}function Jv(t){qu(t,"onDisconnectEvents");const e=Uu(t),n=Xr();Gs(t.onDisconnect_,ye(),(s,i)=>{const o=Dv(s,i,t.serverSyncTree_,e);_u(n,s,o)});let r=[];Gs(n,ye(),(s,i)=>{r=r.concat(cs(t.serverSyncTree_,s,i));const o=t0(t,s);co(t,o)}),t.onDisconnect_=Xr(),un(t.eventQueue_,ye(),r)}function Xv(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Hv)}function qu(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),qe(n,...e)}function Hu(t,e,n){return Ru(t.serverSyncTree_,e,n)||_e.EMPTY_NODE}function uo(t,e=t.transactionQueueTree_){if(e||fs(t,e),Fn(e)){const n=zu(t,e);V(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&Zv(t,Cr(e),n)}else Bu(e)&&hs(e,n=>{uo(t,n)})}function Zv(t,e,n){const r=n.map(l=>l.currentWriteId),s=Hu(t,e,r);let i=s;const o=s.hash();for(let l=0;l<n.length;l++){const d=n[l];V(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const c=it(e,d.path);i=i.updateChild(c,d.currentOutputSnapshotRaw)}const a=i.val(!0),u=e;t.server_.put(u.toString(),a,l=>{qu(t,"transaction put response",{path:u.toString(),status:l});let d=[];if(l==="ok"){const c=[];for(let m=0;m<n.length;m++)n[m].status=2,d=d.concat($n(t.serverSyncTree_,n[m].currentWriteId)),n[m].onComplete&&c.push(()=>n[m].onComplete(null,!0,n[m].currentOutputSnapshotResolved)),n[m].unwatcher();fs(t,ao(t.transactionQueueTree_,e)),uo(t,t.transactionQueueTree_),un(t.eventQueue_,e,d);for(let m=0;m<c.length;m++)$r(c[m])}else{if(l==="datastale")for(let c=0;c<n.length;c++)n[c].status===3?n[c].status=4:n[c].status=0;else{et("transaction at "+u.toString()+" failed: "+l);for(let c=0;c<n.length;c++)n[c].status=4,n[c].abortReason=l}co(t,e)}},o)}function co(t,e){const n=Wu(t,e),r=Cr(n),s=zu(t,n);return e0(t,s,r),r}function e0(t,e,n){if(e.length===0)return;const r=[];let s=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const u=e[a],l=it(n,u.path);let d=!1,c;if(V(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)d=!0,c=u.abortReason,s=s.concat($n(t.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=Wv)d=!0,c="maxretry",s=s.concat($n(t.serverSyncTree_,u.currentWriteId,!0));else{const m=Hu(t,u.path,o);u.currentInputSnapshot=m;const $=e[a].update(m.val());if($!==void 0){Vu("transaction failed: Data returned ",$,u.path);let v=He($);typeof $=="object"&&$!=null&&kt($,".priority")||(v=v.updatePriority(m.getPriority()));const w=u.currentWriteId,y=Uu(t),I=Rv(v,m,y);u.currentOutputSnapshotRaw=v,u.currentOutputSnapshotResolved=I,u.currentWriteId=Qv(t),o.splice(o.indexOf(w),1),s=s.concat(wv(t.serverSyncTree_,u.path,I,u.currentWriteId,u.applyLocally)),s=s.concat($n(t.serverSyncTree_,w,!0))}else d=!0,c="nodata",s=s.concat($n(t.serverSyncTree_,u.currentWriteId,!0))}un(t.eventQueue_,n,s),s=[],d&&(e[a].status=2,function(m){setTimeout(m,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(c==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(c),!1,null))))}fs(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)$r(r[a]);uo(t,t.transactionQueueTree_)}function Wu(t,e){let n,r=t.transactionQueueTree_;for(n=he(e);n!==null&&Fn(r)===void 0;)r=ao(r,n),e=Ce(e),n=he(e);return r}function zu(t,e){const n=[];return Ku(t,e,n),n.sort((r,s)=>r.order-s.order),n}function Ku(t,e,n){const r=Fn(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);hs(e,s=>{Ku(t,s,n)})}function fs(t,e){const n=Fn(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,ju(e,n.length>0?n:void 0)}hs(e,r=>{fs(t,r)})}function t0(t,e){const n=Cr(Wu(t,e)),r=ao(t.transactionQueueTree_,e);return kv(r,s=>{Ps(t,s)}),Ps(t,r),Lu(r,s=>{Ps(t,s)}),n}function Ps(t,e){const n=Fn(e);if(n){const r=[];let s=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(V(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(V(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat($n(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?ju(e,void 0):n.length=i+1,un(t.eventQueue_,Cr(e),s);for(let o=0;o<r.length;o++)$r(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n0(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function r0(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):et(`Invalid query segment '${n}' in query '${t}'`)}return e}const Ma=function(t,e){const n=s0(t),r=n.namespace;n.domain==="firebase.com"&&rn(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&rn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||kg();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Hg(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new Ae(n.pathString)}},s0=function(t){let e="",n="",r="",s="",i="",o=!0,a="https",u=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let d=t.indexOf("/");d===-1&&(d=t.length);let c=t.indexOf("?");c===-1&&(c=t.length),e=t.substring(0,Math.min(d,c)),d<c&&(s=n0(t.substring(d,c)));const m=r0(t.substring(Math.min(t.length,c)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(l+1),10)):l=e.length;const $=e.slice(0,l);if($.toLowerCase()==="localhost")n="localhost";else if($.split(".").length<=2)n=$;else{const v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),i=r}"ns"in m&&(i=m.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return ce(this._path)?null:ou(this._path)}get ref(){return new Mn(this._repo,this._path)}get _queryIdentifier(){const e=ba(this._queryParams),n=Wi(e);return n==="{}"?"default":n}get _queryObject(){return ba(this._queryParams)}isEqual(e){if(e=S_(e),!(e instanceof ho))return!1;const n=this._repo===e._repo,r=uu(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+_y(this._path)}}class Mn extends ho{constructor(e,n){super(e,n,new Ji,!1)}get parent(){const e=lu(this._path);return e===null?null:new Mn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}bv(Mn);$v(Mn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i0="FIREBASE_DATABASE_EMULATOR_HOST",ni={};let o0=!1;function a0(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||rn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),qe("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Ma(i,s),a=o.repoInfo,u,l;typeof process!="undefined"&&process.env&&(l=process.env[i0]),l?(u=!0,i=`http://${l}?ns=${a.namespace}`,o=Ma(i,s),a=o.repoInfo):u=!o.repoInfo.secure;const d=s&&u?new Ws(Ws.OWNER):new qg(t.name,t.options,e);Lv("Invalid Firebase Database URL",o),ce(o.path)||rn("Database URL must point to the root of a Firebase Database (not including a child path).");const c=u0(a,t,d,new Ug(t.name,n));return new c0(c,t)}function l0(t,e){const n=ni[e];(!n||n[t.key]!==t)&&rn(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Xv(t),delete n[t.key]}function u0(t,e,n,r){let s=ni[e.name];s||(s={},ni[e.name]=s);let i=s[t.toURLString()];return i&&rn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new zv(t,o0,n,r),s[t.toURLString()]=i,i}class c0{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Kv(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Mn(this._repo,ye())),this._rootInternal}_delete(){return this._rootInternal!==null&&(l0(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&rn("Cannot call "+e+" on a deleted database.")}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d0(t){Ig(yg),Kr(new zr("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return a0(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),sr(ra,sa,t),sr(ra,sa,"esm2017")}Pt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Pt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};d0();const h0=E("h5",null,"6.\u9001\u51FA\u5831\u540D\u8CC7\u6599",-1),f0=ie(" \u8ACB\u78BA\u8A8D\u4EE5\u4E0B\u8CC7\u8A0A\uFF0C\u78BA\u8A8D\u597D\u5F8C\u6309\u4E0B\u9001\u51FA\u5373\u53EF\u5831\u540D\u3002 "),p0=E("td",null,"\u5152\u7AE5\u59D3\u540D",-1),m0=E("td",null,"\u5152\u7AE5\u5E74\u9F61",-1),_0=E("td",null,"\u5152\u7AE5\u8EAB\u5206\u8B49\u865F",-1),g0=E("td",null,"\u5BB6\u9577\u96FB\u8A71",-1),y0=E("td",null,"\u5BB6\u9577\u95DC\u4FC2",-1),v0=E("td",null,"\u5C31\u8A3A\u554F\u984C",-1),E0=E("td",null,"\u4E0A\u6B21\u8A55\u4F30",-1),b0=E("td",null,"\u4E0A\u6B21\u8A55\u4F30\u65E5\u671F",-1),$0=E("td",null,"\u4E0A\u6B21\u5EFA\u8B70\u8A55\u4F30\u65E5\u671F",-1),w0=E("tr",null,[E("td",{colspan:"2"},"\u5099\u8A3B\uFF1A")],-1),C0={colspan:"2"},S0=mt({__name:"EndPage",props:{jsondata:null},setup(t){const e=t,n=st(e.jsondata.registrationDate);e.jsondata.registrationDate;const r=n.year()-1911+n.format("\u5E74 MM\u6708 DD\u65E5"),s=me("\u9001\u51FA"),i=me("");function o(l){s.value=="\u9001\u51FA"&&(s.value="\u9001\u51FA\u4E2D",a(e.jsondata))}function a(l){l.userRelationshipOther||(l.userRelationshipOther=""),l.questionsAbouts||(l.questionsAbouts=""),l.previousAssessment||(l.previousAssessment=""),l.lastEvaluate||(l.lastEvaluate=""),l.SuggestEvaluate||(l.SuggestEvaluate=""),l.comment=i.value,l_(l).then(async d=>{if(d.status!=200){alert(JSON.stringify(await d.json())),s.value="\u932F\u8AA4\uFF0C\u5831\u540D\u5931\u6557";return}const c=`\u5831\u540D\u5B8C\u6210\u3002\u9810\u8A08\u770B\u8A3A\u65E5\u671F\u70BA ${r}\uFF0C\u7D93\u7CFB\u7D71\u5831\u540D\u6210\u529F\u4E0D\u7B49\u65BC\u639B\u865F\u6210\u529F\uFF0C\u7D93\u672C\u9662\u78BA\u8A8D\u8EAB\u4EFD\u8CC7\u683C\u7B26\u5408\u8A55\u4F30\u8CC7\u683C\u5F8C\uFF0C\u6703\u518D\u4EE5\u96FB\u8A71\u901A\u77E5\u3002
    
\u672A\u63A5\u5230\u96FB\u8A71\u901A\u77E5\u5373\u4E0D\u7B26\u5408\u770B\u8A3A\u8CC7\u683C\uFF0C\u8ACB\u52FF\u64C5\u81EA\u524D\u4F86\u770B\u8A3A\uFF0C\u4EE5\u514D\u767D\u8DD1\u4E00\u8D9F\u3002`;s.value="\u6210\u529F",alert(c),window.location.reload()})}function u(l){return l>360?Math.floor(l/360)+"\u6B72"+Math.floor(l%360/30)+"\u500B\u6708":Math.floor(l%360/30)+"\u500B\u6708"}return(l,d)=>(J(),se("table",null,[h0,f0,E("tr",null,[p0,E("td",null,Ne(e.jsondata.childName),1)]),E("tr",null,[m0,E("td",null,Ne(u(e.jsondata.kidday)),1)]),E("tr",null,[_0,E("td",null,Ne(e.jsondata.identityNumber),1)]),E("tr",null,[g0,E("td",null,Ne(e.jsondata.phoneNumber),1)]),E("tr",null,[y0,E("td",null,Ne(e.jsondata.userRelationship||e.jsondata.userRelationshipOther),1)]),E("tr",null,[v0,E("td",null,Ne(e.jsondata.questionsAbouts),1)]),E("tr",null,[E0,E("td",null,Ne(e.jsondata.previousAssessment),1)]),E("tr",null,[b0,E("td",null,Ne(e.jsondata.lastEvaluate),1)]),E("tr",null,[$0,E("td",null,Ne(e.jsondata.SuggestEvaluate),1)]),w0,E("tr",null,[E("td",C0,[It(E("textarea",{class:"form-control",rows:"3",style:{width:"100%"},"onUpdate:modelValue":d[0]||(d[0]=c=>i.value=c)},null,512),[[ri,i.value]])])]),E("button",{type:"button",class:"btn btn-primary",onClick:o},Ne(s.value),1)]))}});const A0=["onSubmit"],T0=E("h1",null,"\u5152\u7AE5\u767C\u5C55\u8A55\u4F30\u5831\u540D\u7CFB\u7D71",-1),I0=ie(" \u6B63\u78BA\u5E74\u9F61\u8A08\u7B97\u65B9\u5F0F\uFF1A"),N0=E("br",null,null,-1),D0=ie(" \u300C\u5BE6\u8DB3\u5E74\u9F61\u300D\uFF1A\u300C\u65BD\u6E2C\u65E5\u671F - \u51FA\u751F\u65E5\u671F = \u5BE6\u8DB3\u5E74\u9F61\u300D"),R0=E("br",null,null,-1),P0=ie(" \uFF0A\u65E9\u7522\u5152\u4E8C\u6B72\u524D\u5EFA\u8B70\u4EE5\u9810\u7522\u671F\u4EE3\u66FF\u51FA\u751F\u65E5\u671F\u8A08\u7B97"),k0=E("br",null,null,-1),O0={class:"kidBirthdayFrom"},F0=ie(" \u8ACB\u9078\u64C7\u60A8\u7684\u5BF6\u8C9D\u51FA\u751F\u65E5\u671F\u9032\u884C\u6AA2\u6E2C\uFF1A"),M0=E("br",null,null,-1),j0={class:"form-label"},B0=E("br",null,null,-1),L0={key:0,class:"col-md-12"},x0=E("div",{class:"alert alert-warning"},[ie(" \u5E74\u9F61\u4E0D\u7B26\u5408\u672C\u9662\u770B\u8A3A\u689D\u4EF6\uFF0C\u82E5\u4ECD\u9700\u8981\u672C\u9662\u5C31\u8A3A\uFF0C\u5EFA\u8B70\u8F49\u8A3A\u81F3\u4EE5\u4E0B\u79D1\u5225\uFF1A"),E("br"),ie(" \u52D5\u4F5C\u3001\u8A9E\u8A00\u985E\u767C\u5C55\u554F\u984C \u2192 \u8ACB\u639B "),E("a",{href:"https://register.vghtc.gov.tw/register/listDoctor.jsp?init=init&section=REHA"},"\u5FA9\u5065\u79D1"),E("br"),ie(" \u8A8D\u77E5\u3001\u4EBA\u969B\u3001\u60C5\u7DD2\u3001\u5C08\u6CE8\u529B\u3001\u904E\u52D5\u7B49 \u2192 \u8ACB\u639B"),E("a",{href:"https://register.vghtc.gov.tw/register/listDoctor.jsp?init=init&section=PSYC"},"\u5152\u7AE5\u5FC3\u667A\u79D1")],-1),V0=[x0],U0={key:1,class:"btn btn-primary",type:"submit"},q0=E("br",null,null,-1),H0=mt({__name:"UserFrom0",props:{disabled:{type:Boolean}},emits:["kidBirthdayChange","submit"],setup(t,{emit:e}){const n=me(st("2022-07-01").add(-106,"day")),r=me(st("2016-01-01").add(-106,"day"));me(r.value.format("YYYY\u5E74MM\u6708DD\u65E5")),me(n.value.format("YYYY\u5E74MM\u6708DD\u65E5")),me(r.value.format("YYYY\u5E74MM\u6708DD\u65E5")),me(n.value.format("YYYY\u5E74MM\u6708DD\u65E5")),me(n.value.format("YYYY\u5E74MM\u6708DD\u65E5"));const s=me(st().format("YYYY-MM-DD")),i=ms(()=>Math.floor(st().diff(s.value)/(1e3*60*60*24))),o=ms(()=>st(s.value)),a=ms(()=>(i.value>360?Math.floor(i.value/360)+"\u5E74":"")+(i.value>30?Math.floor(i.value%360/30)+"\u500B\u6708":"")+(i.value>0?i.value%360%30+"\u5929":"")),u=me(null);function l(d){e("kidBirthdayChange",o.value),u.value=o.value.isBefore(n.value)&&o.value.isAfter(r.value),e("submit",Object.assign({},mr(d),{kidday:i.value}),u.value)}return(d,c)=>(J(),se(Ge,null,[E("form",{id:"from",onSubmit:pr(l,["prevent"])},[T0,I0,N0,D0,R0,P0,k0,E("div",O0,[F0,M0,E("label",j0,[It(E("input",{type:"date",class:"form-control",name:"kidBirthday","onUpdate:modelValue":c[0]||(c[0]=m=>s.value=m),required:""},null,512),[[ri,s.value]])]),B0,ie(" \u8A66\u7B97\u7D50\u679C\uFF1A"+Ne(Bt(a)),1)]),u.value===!1?(J(),se("div",L0,V0)):De("",!0),u.value?De("",!0):(J(),se("button",U0,"\u78BA\u8A8D"))],40,A0),q0],64))}});const W0={key:0,class:"text-center"},z0=E("div",{class:"spinner-border",role:"status"},[E("span",{class:"visually-hidden"},"Loading...")],-1),K0=[z0],G0={key:1,class:"tablebox"},Y0={key:1,style:{"white-space":"nowrap",color:"red"}},Q0=E("br",null,null,-1),ja=mt({__name:"RegistrationTime",props:{dateStr:null,special:{type:Boolean}},emits:["submit"],setup(t,{emit:e}){const n=t,r=st(n.dateStr),s=n.dateStr,i=r.year()-1911+r.format(".MM.DD"),o=me(0),a=me(-1),u=me(!0),l=Ba(()=>o.value>=a.value);Promise.all([bl(),a_(s)]).then(([c,m])=>{m||(m={}),m=Object.fromEntries(Object.entries(m).filter(([S,w])=>w.doctorAppointment!=="\u8CC7\u683C\u4E0D\u7B26"));let $=Object.values(m).filter(S=>S.kidday<360*3).length,v=Object.keys(m).length-$;n.special?(o.value=v+$,a.value=c.quota+c.specialQuota):(o.value=v+Math.max($-c.specialQuota,0),a.value=c.quota),u.value=!1});function d(){e("submit",n.dateStr)}return(c,m)=>(J(),se(Ge,null,[u.value?(J(),se("div",W0,K0)):De("",!0),u.value?De("",!0):(J(),se("tr",G0,[E("td",null,[Bt(l)?De("",!0):(J(),se("a",{key:0,class:"red",onclick:d,style:{"white-space":"nowrap"}},"\u3010\u5831\u540D\u3011")),Bt(l)?(J(),se("a",Y0,"\u5831\u540D\u984D\u6EFF")):De("",!0)]),E("td",null,[ie(Ne(i)),Q0,ie("\u5DF2\u639B\u4EBA\u6578\uFF1A"+Ne(o.value+"/"+a.value),1)])]))],64))}});const J0=E("h5",null,"\u9078\u64C7\u770B\u8A3A\u65E5\u671F",-1),X0={class:"table table-sm"},Z0={class:"weekhead"},eE=E("th",null,[ie("\u661F\u671F/"),E("br"),ie("\u5348\u5225")],-1),tE={class:"weekbody"},nE=E("th",{class:"weekside"},[ie("\u4E0A\u5348"),E("br"),ie("08:30"),E("br"),ie("~"),E("br"),ie("12:00")],-1),rE=E("th",{class:"weekside"},[ie("\u4E0B\u5348"),E("br"),ie("13:30"),E("br"),ie("~"),E("br"),ie("17:00")],-1),sE=E("br",null,null,-1),iE=mt({__name:"RegistrationFrom",props:{jsondata:null},emits:["submit"],setup(t,{emit:e}){const r=me(t.jsondata.kidday<360*3),s=["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],i=me([[[],[],[],[],[],[],[]],[[],[],[],[],[],[],[]]]);bl().then(u=>{console.log(u),o(u.dayofweek,u.minday,u.maxday)});function o(u,l,d){let c=st().add(l,"day");for(let m=l;m<d;m++)c.day()==u&&i.value[0][u].push(c),c=c.add(1,"day")}function a(u){e("submit",{registrationDate:u},!0)}return(u,l)=>(J(),se(Ge,null,[J0,E("table",X0,[E("thead",Z0,[E("tr",null,[eE,(J(!0),se(Ge,null,ut(s.slice(1),d=>(J(),se("th",null,"\u661F\u671F"+Ne(d),1))),256)),E("th",null,"\u661F\u671F"+Ne(s[0]),1)])]),E("tbody",tE,[E("tr",null,[nE,(J(!0),se(Ge,null,ut(i.value[0].slice(1),(d,c,m)=>(J(),se("td",null,[(J(!0),se(Ge,null,ut(d,$=>(J(),bt(ja,{dateStr:$.format("YYYY-MM-DD"),onSubmit:a,special:r.value},null,8,["dateStr","special"]))),256))]))),256)),(J(!0),se(Ge,null,ut([i.value[0][0]],(d,c,m)=>(J(),se("td",null,[(J(!0),se(Ge,null,ut(d,$=>(J(),bt(ja,{dateStr:$.format("YYYY-MM-DD"),onSubmit:a,special:r.value},null,8,["dateStr","special"]))),256))]))),256))]),E("tr",null,[rE,(J(),se(Ge,null,ut(s,d=>E("td")),64))])])]),sE],64))}}),oE=E("br",null,null,-1),aE=E("br",null,null,-1),cE=mt({__name:"UserView",setup(t){const e=me(-1),n=me("");function r(a){n.value=a.format("YYYY-MM-DD")}const s=me(""),i={};function o(a,u){if(!!u){if(e.value==1&&(!a.questionsAbouts||a.questionsAbouts.split("|").length<=1)){mc.push("SuggestReferral");return}e.value+=1;for(const l of Object.keys(a))i[l]=a[l];s.value=JSON.stringify(i,null,2)}}return(a,u)=>(J(),se("div",null,[oE,pc(yc),e.value==-10?(J(),bt(gh,{key:0})):De("",!0),e.value==-1?(J(),bt(H0,{key:1,disabled:e.value!=-1,onSubmit:o,onKidBirthdayChange:r},null,8,["disabled"])):De("",!0),e.value==0?(J(),bt(iE,{key:2,onSubmit:o,jsondata:Bt(i)},null,8,["jsondata"])):De("",!0),e.value==1?(J(),bt(zc,{key:3,disabled:e.value!=1,onSubmit:o},null,8,["disabled"])):De("",!0),e.value==2?(J(),bt(Sd,{key:4,disabled:e.value!=2,onSubmit:o},null,8,["disabled"])):De("",!0),e.value==3?(J(),bt(Ud,{key:5,disabled:e.value!=3,onSubmit:o},null,8,["disabled"])):De("",!0),e.value==4?(J(),bt(uh,{key:6,disabled:e.value!=4,onSubmit:o,"kid-birthday":n.value},null,8,["disabled","kid-birthday"])):De("",!0),e.value==5?(J(),bt(S0,{key:7,jsondata:Bt(i)},null,8,["jsondata"])):De("",!0),aE]))}});export{cE as default};
//# sourceMappingURL=UserView.cd33aff3.js.map
