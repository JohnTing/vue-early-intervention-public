var rh=Object.defineProperty,sh=Object.defineProperties;var ih=Object.getOwnPropertyDescriptors;var Ma=Object.getOwnPropertySymbols;var oh=Object.prototype.hasOwnProperty,ah=Object.prototype.propertyIsEnumerable;var Fa=(t,e,n)=>e in t?rh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ue=(t,e)=>{for(var n in e||(e={}))oh.call(e,n)&&Fa(t,n,e[n]);if(Ma)for(var n of Ma(e))ah.call(e,n)&&Fa(t,n,e[n]);return t},Nt=(t,e)=>sh(t,ih(e));import{d as gt,r as _e,o as lh,M as uh,a as Q,c as ie,b,F as Je,e as dt,f as Ne,w as Vr,g as oe,h as Dt,v as Or,t as ke,i as ro,j as ch,k as au,u as Qt,n as dh,l as ai,m as St,p as hh,q as fh}from"./index.b2a74552.js";const ph=b("div",{class:"modal-dialog"},[b("div",{class:"modal-content"},[b("div",{class:"modal-header"},[b("h4",{class:"modal-title"},"\u5831\u540D\u524D\u8ACB\u5BB6\u9577\u8A73\u95B1\u898F\u5B9A"),b("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})]),b("div",{class:"modal-body"},[b("ol",null,[b("li",null,"\u672C\u9580\u8A3A\u770B\u8A3A\u689D\u4EF6\u9700\u70BA\u300C\u591A\u9762\u5411\u767C\u5C55\u9072\u7DE9\u300D\uFF0C\u82E5\u70BA\u55AE\u4E00\u9762\u9805\u767C\u5C55\u9072\u7DE9\uFF0C\u8ACB\u76F4\u63A5\u639B\u55AE\u4E00\u79D1\u5225\u5C31\u8A3A\uFF0C\u8ACB\u52FF\u639B\u865F"),b("ul",null,[b("li",null,"\u55AE\u7D14\u52D5\u4F5C\u3001\u8A9E\u8A00\u554F\u984C\u2192\u8ACB\u639B\u5FA9\u5065\u79D1"),b("li",null,"\u8A8D\u77E5\u3001\u4EBA\u969B\u3001\u60C5\u7DD2\u3001\u5C08\u6CE8\u529B\u3001\u904E\u52D5\u7B49\u2192\u8ACB\u639B\u5152\u7AE5\u5FC3\u667A\u79D1"),b("li",null,"\u751F\u9577\u554F\u984C\uFF08\u8EAB\u9AD8\u3001\u9AD4\u91CD\u3001\u6027\u65E9\u719F\u7B49\uFF09\u2192\u8ACB\u639B\u907A\u50B3\u4EE3\u8B1D\u79D1")]),b("br"),b("li",null,"\u672C\u9580\u8A3A\u7684\u770B\u8A3A\u5E74\u9F61\u70BA\u300C\u5B78\u9F61\u524D\uFF08\u5165\u5C0F\u5B78\u524D\uFF09\u300D\uFF0C\u82E5\u60A8\u7684\u5152\u7AE5\u73FE\u76EE\u524D\u5DF2\u8B80\u5927\u73ED\uFF0C\u82E5\u9580\u8A3A\u53EF\u770B\u8A3A\u65E5\u671F\u5DF2\u8D85\u904E\u4E94\u6708\uFF0C\u5247\u4E0D\u7B26\u5408\u672C\u9662\u770B\u8A3A\u5E74\u9F61\uFF1B\u5EFA\u8B70\u60A8\u8F49\u81F3\u5B83\u9662\u639B\u865F\uFF0C\u6216\u55AE\u4E00\u79D1\u5225\u5C31\u8A3A\u3002"),b("br"),b("li",null,"\u76EE\u524D\u570B\u5065\u7F72\u5DF2\u63D0\u4F9B\u7CFB\u7D71\u53EF\u67E5\u8A62\u5152\u7AE5\u5728\u5404\u5BB6\u91AB\u9662\u5152\u7AE5\u767C\u5C55\u79D1\u662F\u5426\u6709\u5C31\u8A3A\u7D00\u9304\uFF0C\u56E0\u6B64\u82E5\u4E00\u5E74\u5167\u66FE\u7D93\u5C31\u8A3A\u6216\u5230\u671F\u65E5\u672A\u8005\uFF0C\u8ACB\u52FF\u639B\u865F\u3002"),b("br"),b("li",null,"\u7CFB\u7D71\u5A92\u5408\u5230\u7684\u5C31\u8A3A\u65E5\u671F\u70BA\u6700\u9069\u5C31\u8A3A\u65E5\u671F\uFF0C\u8ACB\u52FF\u8981\u6C42\u66F4\u52D5\u3002")])]),b("div",{class:"modal-footer"},[b("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onclick:"sessionStorage.setItem('isReadRegulations', 'true');"},"\u78BA\u8A8D")])])],-1),mh=[ph],_h=gt({__name:"ReadRegulations",setup(t){let e=_e(),n=null;return lh(()=>{n=new uh(e.value,{}),sessionStorage.getItem("isReadRegulations")!=="true"&&n.show()}),(r,s)=>(Q(),ie("div",{class:"modal fade",id:"myModal",tabindex:"-1",ref_key:"myModalRef",ref:e},mh,512))}});var lu=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function gh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var uu={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(lu,function(){var n=1e3,r=6e4,s=36e5,i="millisecond",o="second",a="minute",u="hour",l="day",c="week",d="month",p="quarter",E="year",v="date",C="Invalid Date",S=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,T={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},A=function(Y,j,U){var X=String(Y);return!X||X.length>=j?Y:""+Array(j+1-X.length).join(U)+Y},O={s:A,z:function(Y){var j=-Y.utcOffset(),U=Math.abs(j),X=Math.floor(U/60),V=U%60;return(j<=0?"+":"-")+A(X,2,"0")+":"+A(V,2,"0")},m:function Y(j,U){if(j.date()<U.date())return-Y(U,j);var X=12*(U.year()-j.year())+(U.month()-j.month()),V=j.clone().add(X,d),ee=U-V<0,Z=j.clone().add(X+(ee?-1:1),d);return+(-(X+(U-V)/(ee?V-Z:Z-V))||0)},a:function(Y){return Y<0?Math.ceil(Y)||0:Math.floor(Y)},p:function(Y){return{M:d,y:E,w:c,d:l,D:v,h:u,m:a,s:o,ms:i,Q:p}[Y]||String(Y||"").toLowerCase().replace(/s$/,"")},u:function(Y){return Y===void 0}},L="en",$={};$[L]=T;var N=function(Y){return Y instanceof ye},F=function Y(j,U,X){var V;if(!j)return L;if(typeof j=="string"){var ee=j.toLowerCase();$[ee]&&(V=ee),U&&($[ee]=U,V=ee);var Z=j.split("-");if(!V&&Z.length>1)return Y(Z[0])}else{var M=j.name;$[M]=j,V=M}return!X&&V&&(L=V),V||!X&&L},q=function(Y,j){if(N(Y))return Y.clone();var U=typeof j=="object"?j:{};return U.date=Y,U.args=arguments,new ye(U)},W=O;W.l=F,W.i=N,W.w=function(Y,j){return q(Y,{locale:j.$L,utc:j.$u,x:j.$x,$offset:j.$offset})};var ye=function(){function Y(U){this.$L=F(U.locale,null,!0),this.parse(U)}var j=Y.prototype;return j.parse=function(U){this.$d=function(X){var V=X.date,ee=X.utc;if(V===null)return new Date(NaN);if(W.u(V))return new Date;if(V instanceof Date)return new Date(V);if(typeof V=="string"&&!/Z$/i.test(V)){var Z=V.match(S);if(Z){var M=Z[2]-1||0,w=(Z[7]||"0").substring(0,3);return ee?new Date(Date.UTC(Z[1],M,Z[3]||1,Z[4]||0,Z[5]||0,Z[6]||0,w)):new Date(Z[1],M,Z[3]||1,Z[4]||0,Z[5]||0,Z[6]||0,w)}}return new Date(V)}(U),this.$x=U.x||{},this.init()},j.init=function(){var U=this.$d;this.$y=U.getFullYear(),this.$M=U.getMonth(),this.$D=U.getDate(),this.$W=U.getDay(),this.$H=U.getHours(),this.$m=U.getMinutes(),this.$s=U.getSeconds(),this.$ms=U.getMilliseconds()},j.$utils=function(){return W},j.isValid=function(){return this.$d.toString()!==C},j.isSame=function(U,X){var V=q(U);return this.startOf(X)<=V&&V<=this.endOf(X)},j.isAfter=function(U,X){return q(U)<this.startOf(X)},j.isBefore=function(U,X){return this.endOf(X)<q(U)},j.$g=function(U,X,V){return W.u(U)?this[X]:this.set(V,U)},j.unix=function(){return Math.floor(this.valueOf()/1e3)},j.valueOf=function(){return this.$d.getTime()},j.startOf=function(U,X){var V=this,ee=!!W.u(X)||X,Z=W.p(U),M=function(H,J){var ne=W.w(V.$u?Date.UTC(V.$y,J,H):new Date(V.$y,J,H),V);return ee?ne:ne.endOf(l)},w=function(H,J){return W.w(V.toDate()[H].apply(V.toDate("s"),(ee?[0,0,0,0]:[23,59,59,999]).slice(J)),V)},P=this.$W,I=this.$M,h=this.$D,m="set"+(this.$u?"UTC":"");switch(Z){case E:return ee?M(1,0):M(31,11);case d:return ee?M(1,I):M(0,I+1);case c:var D=this.$locale().weekStart||0,B=(P<D?P+7:P)-D;return M(ee?h-B:h+(6-B),I);case l:case v:return w(m+"Hours",0);case u:return w(m+"Minutes",1);case a:return w(m+"Seconds",2);case o:return w(m+"Milliseconds",3);default:return this.clone()}},j.endOf=function(U){return this.startOf(U,!1)},j.$set=function(U,X){var V,ee=W.p(U),Z="set"+(this.$u?"UTC":""),M=(V={},V[l]=Z+"Date",V[v]=Z+"Date",V[d]=Z+"Month",V[E]=Z+"FullYear",V[u]=Z+"Hours",V[a]=Z+"Minutes",V[o]=Z+"Seconds",V[i]=Z+"Milliseconds",V)[ee],w=ee===l?this.$D+(X-this.$W):X;if(ee===d||ee===E){var P=this.clone().set(v,1);P.$d[M](w),P.init(),this.$d=P.set(v,Math.min(this.$D,P.daysInMonth())).$d}else M&&this.$d[M](w);return this.init(),this},j.set=function(U,X){return this.clone().$set(U,X)},j.get=function(U){return this[W.p(U)]()},j.add=function(U,X){var V,ee=this;U=Number(U);var Z=W.p(X),M=function(I){var h=q(ee);return W.w(h.date(h.date()+Math.round(I*U)),ee)};if(Z===d)return this.set(d,this.$M+U);if(Z===E)return this.set(E,this.$y+U);if(Z===l)return M(1);if(Z===c)return M(7);var w=(V={},V[a]=r,V[u]=s,V[o]=n,V)[Z]||1,P=this.$d.getTime()+U*w;return W.w(P,this)},j.subtract=function(U,X){return this.add(-1*U,X)},j.format=function(U){var X=this,V=this.$locale();if(!this.isValid())return V.invalidDate||C;var ee=U||"YYYY-MM-DDTHH:mm:ssZ",Z=W.z(this),M=this.$H,w=this.$m,P=this.$M,I=V.weekdays,h=V.months,m=function(J,ne,be,Ge){return J&&(J[ne]||J(X,ee))||be[ne].slice(0,Ge)},D=function(J){return W.s(M%12||12,J,"0")},B=V.meridiem||function(J,ne,be){var Ge=J<12?"AM":"PM";return be?Ge.toLowerCase():Ge},H={YY:String(this.$y).slice(-2),YYYY:this.$y,M:P+1,MM:W.s(P+1,2,"0"),MMM:m(V.monthsShort,P,h,3),MMMM:m(h,P),D:this.$D,DD:W.s(this.$D,2,"0"),d:String(this.$W),dd:m(V.weekdaysMin,this.$W,I,2),ddd:m(V.weekdaysShort,this.$W,I,3),dddd:I[this.$W],H:String(M),HH:W.s(M,2,"0"),h:D(1),hh:D(2),a:B(M,w,!0),A:B(M,w,!1),m:String(w),mm:W.s(w,2,"0"),s:String(this.$s),ss:W.s(this.$s,2,"0"),SSS:W.s(this.$ms,3,"0"),Z};return ee.replace(g,function(J,ne){return ne||H[J]||Z.replace(":","")})},j.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},j.diff=function(U,X,V){var ee,Z=W.p(X),M=q(U),w=(M.utcOffset()-this.utcOffset())*r,P=this-M,I=W.m(this,M);return I=(ee={},ee[E]=I/12,ee[d]=I,ee[p]=I/3,ee[c]=(P-w)/6048e5,ee[l]=(P-w)/864e5,ee[u]=P/s,ee[a]=P/r,ee[o]=P/n,ee)[Z]||P,V?I:W.a(I)},j.daysInMonth=function(){return this.endOf(d).$D},j.$locale=function(){return $[this.$L]},j.locale=function(U,X){if(!U)return this.$L;var V=this.clone(),ee=F(U,X,!0);return ee&&(V.$L=ee),V},j.clone=function(){return W.w(this.$d,this)},j.toDate=function(){return new Date(this.valueOf())},j.toJSON=function(){return this.isValid()?this.toISOString():null},j.toISOString=function(){return this.$d.toISOString()},j.toString=function(){return this.$d.toUTCString()},Y}(),ue=ye.prototype;return q.prototype=ue,[["$ms",i],["$s",o],["$m",a],["$H",u],["$W",l],["$M",d],["$y",E],["$D",v]].forEach(function(Y){ue[Y[1]]=function(j){return this.$g(j,Y[0],Y[1])}}),q.extend=function(Y,j){return Y.$i||(Y(j,ye,q),Y.$i=!0),q},q.locale=F,q.isDayjs=N,q.unix=function(Y){return q(1e3*Y)},q.en=$[L],q.Ls=$,q.p={},q})})(uu);var ot=uu.exports;function Hr(t){const e={},n=new FormData(t.target);for(const r of n.keys())e[r]=n.getAll(r).join("|");return e}const yh=["onSubmit"],vh=b("h5",null,"1.\u5152\u7AE5\u57FA\u672C\u8CC7\u6599",-1),Eh={class:"row"},bh={class:"col-md-4"},wh=oe(" \u5152\u7AE5\u8EAB\u4EFD\u8B49\u865F\uFF1A "),Sh=["readonly"],Ch={class:"col-md-4"},Ih=oe(" \u5152\u7AE5\u59D3\u540D\uFF1A "),$h=["readonly"],Th=b("br",null,null,-1),Ah={class:"row"},Rh={class:"col-md-12"},kh=oe(" \u586B\u5BEB\u4EBA\u8207\u5152\u7AE5\u95DC\u4FC2\uFF1A "),Nh={class:"form-inline"},Dh={class:"form-check-inline"},Ph={class:"form-check-label"},Oh=["value","disabled"],Mh=["placeholder","disabled","readonly"],Fh=b("div",{class:"row"},[b("div",{class:"col-md-4"},[b("label",null,[oe(" \u586B\u8868\u4EBA\u806F\u7E6B\u96FB\u8A71\uFF1A "),b("input",{type:"text",class:"form-control",placeholder:"(\u52D9\u5FC5\u7559\u4E0B\u53EF\u806F\u7E6B\u96FB\u8A71)",name:"phoneNumber",required:""})])])],-1),Lh={class:"row"},jh=oe(" \u5C31\u8A3A\u554F\u984C(\u53EF\u8907\u9078)\uFF1A"),Uh=b("br",null,null,-1),Bh={class:"form-check-label"},xh=["value","disabled"],Vh=b("br",null,null,-1),Hh={key:0,class:"btn btn-primary",type:"submit"},qh=gt({__name:"UserFrom1",props:{disabled:{type:Boolean}},emits:["kidBirthdayChange","submit"],setup(t,{emit:e}){const n=["\u7236\u6BCD/\u76E3\u8B77\u4EBA","\u8001\u5E2B","\u793E\u5DE5","\u8B77\u7406\u5E2B","\u5176\u4ED6"],r=["\u52D5\u4F5C","\u8A9E\u8A00","\u5B78\u7FD2","\u60C5\u7DD2","\u5C08\u6CE8\u529B\u3001\u904E\u52D5","\u5B78\u524D\u9451\u5B9A"],s=_e("");ot();const i=_e(null);function o(a){e("submit",Hr(a),!0)}return(a,u)=>(Q(),ie("form",{id:"from",onSubmit:Vr(o,["prevent"])},[vh,b("div",Eh,[b("div",bh,[wh,b("input",{type:"text",class:"form-control",name:"identityNumber",required:"",pattern:"[A-Z][01][0-9]{8}",readonly:t.disabled},null,8,Sh)]),b("div",Ch,[Ih,b("input",{type:"text",class:"form-control",name:"childName",required:"",readonly:t.disabled},null,8,$h)])]),Th,b("div",Ah,[b("div",Rh,[kh,b("div",Nh,[(Q(),ie(Je,null,dt(n,(l,c)=>b("div",Dh,[b("label",Ph,[Dt(b("input",{class:"form-check-input",type:"radio",name:"userRelationship",value:l,"onUpdate:modelValue":u[0]||(u[0]=d=>s.value=d),required:"",disabled:t.disabled},null,8,Oh),[[Or,s.value]]),oe(ke(l),1)])])),64)),b("div",null,[b("input",{type:"text",class:"form-control",name:"userRelationshipOther",placeholder:s.value==n[n.length-1]?"\u8ACB\u8F38\u5165\u95DC\u4FC2":"",disabled:s.value!=n[n.length-1],readonly:t.disabled},null,8,Mh)])])])]),Fh,b("div",Lh,[jh,Uh,(Q(),ie(Je,null,dt(r,l=>b("label",Bh,[b("input",{class:"form-check-input",type:"checkbox",name:"questionsAbouts",value:l,disabled:t.disabled},null,8,xh),oe(" "+ke(l)+"\u2003 ",1)])),64))]),Vh,i.value?Ne("",!0):(Q(),ie("button",Hh,"\u78BA\u8A8D"))],40,yh))}}),Wh=["onSubmit"],zh=b("h5",null,"2.\u662F\u5426\u66FE\u7D93\u65BC\u672C\u9662/\u4ED6\u9662\u770B\u904E\u5152\u7AE5\u767C\u5C55\u806F\u5408\u8A55\u4F30\u9580\u8A3A\uFF1F",-1),Kh={class:"col-md-12"},Gh={class:"form-check"},Yh={class:"form-check-label"},Jh=["disabled"],Qh=oe("\u5426 "),Xh={class:"form-check"},Zh={class:"form-check-label"},ef=["disabled"],tf=oe("\u662F "),nf={key:0},rf={class:"row"},sf={class:"form-inline col-md-6"},of=oe(" \u524D\u6B21\u8A55\u4F30\u65E5\u671F\uFF1A"),af=["disabled"],lf={class:"form-inline col-md-6"},uf=oe(" \u5EFA\u8B70\u8907\u8A55\u6642\u9593\uFF1A"),cf=["disabled"],df=b("br",null,null,-1),hf={key:0},ff=b("h5",null,"\u524D\u6B21\u8A55\u4F30\u9072\u7DE9/\u81E8\u754C\u9072\u7DE9\uFF1A",-1),pf={class:"col-md-12"},mf={class:"form-inline"},_f={class:"form-check"},gf={class:"form-check-label"},yf=["value","disabled"],vf={key:1,class:"alert alert-warning"},Ef=oe(" \u2027\u7121\u8AD6\u65BC\u672C\u9662\u6216\u4ED6\u9662\u8A55\u4F30\u4E00\u5E74\u5167\u4E0D\u5F97\u91CD\u8A55\uFF0C\u67E5\u8A62\u5F8C\u82E5\u91CD\u8986\u770B\u8A3A\uFF0C\u5C07\u6703\u62D2\u7D55\u8A55\u4F30"),bf=b("br",null,null,-1),wf=[Ef,bf],Sf={key:2,class:"btn btn-primary",type:"submit"},Cf=gt({__name:"UserFrom2",props:{disabled:{type:Boolean}},emits:["submit"],setup(t,{emit:e}){const n=_e(!1),r=_e(null),s=_e(null),i=["\u52D5\u4F5C\u985E","\u8A9E\u8A00","\u8A8D\u77E5\u3001\u793E\u6703\u60C5\u7DD2\u3001\u5C08\u6CE8\u529B\u3001\u904E\u52D5\u7B49"],o=_e([]);function a(u){const l=ot().diff(r.value);r.value&&n.value?s.value=l/(1e3*60*60*24)>365-61:s.value=!0,e("submit",Hr(u),!0)}return(u,l)=>(Q(),ie("form",{id:"from",onSubmit:Vr(a,["prevent"])},[zh,b("div",Kh,[b("div",Gh,[b("label",Yh,[Dt(b("input",{type:"radio",class:"form-check-input",value:!1,"onUpdate:modelValue":l[0]||(l[0]=c=>n.value=c),required:"",disabled:t.disabled},null,8,Jh),[[Or,n.value]]),Qh])]),b("div",Xh,[b("label",Zh,[Dt(b("input",{type:"radio",class:"form-check-input",value:!0,"onUpdate:modelValue":l[1]||(l[1]=c=>n.value=c),required:"",disabled:t.disabled},null,8,ef),[[Or,n.value]]),tf]),n.value?(Q(),ie("div",nf,[b("div",rf,[b("div",sf,[of,Dt(b("input",{type:"date",class:"form-control",name:"lastEvaluate",required:"","onUpdate:modelValue":l[2]||(l[2]=c=>r.value=c),disabled:t.disabled},null,8,af),[[ro,r.value]])]),b("div",lf,[uf,b("input",{type:"date",class:"form-control",name:"SuggestEvaluate",required:"",disabled:t.disabled},null,8,cf)])])])):Ne("",!0)])]),df,n.value?(Q(),ie("div",hf,[ff,b("div",pf,[(Q(),ie(Je,null,dt(i,(c,d)=>b("div",mf,[b("div",_f,[b("label",gf,[Dt(b("input",{type:"checkbox",class:"form-check-input",name:"previousAssessment","onUpdate:modelValue":l[3]||(l[3]=p=>o.value=p),value:c,disabled:t.disabled},null,8,yf),[[ch,o.value]]),oe(ke(c),1)])])])),64))])])):Ne("",!0),n.value?(Q(),ie("div",vf,wf)):Ne("",!0),s.value?Ne("",!0):(Q(),ie("button",Sf,"\u78BA\u8A8D"))],40,Wh))}}),If=["onSubmit"],$f=b("h5",null,"3\u3001\u662F\u5426\u6709\u7279\u6B8A\u75BE\u75C5\uFF1F",-1),Tf={class:"col-md-12"},Af={class:"form-check"},Rf={class:"form-check-label"},kf=["disabled"],Nf=oe("\u5426 "),Df={class:"form-check"},Pf={class:"form-check-label"},Of=["disabled"],Mf=oe("\u662F "),Ff={class:"form-check form-check-inline"},Lf={class:"form-check-label"},jf=["value","disabled"],Uf=b("br",null,null,-1),Bf={key:0,class:"btn btn-primary",type:"submit"},xf=gt({__name:"UserFrom3",props:{disabled:{type:Boolean}},emits:["submit"],setup(t,{emit:e}){const n=_e(!1),r=["\u795E\u7D93\u7CFB\u7D71","\u5167\u5206\u6CCC","\u7F55\u898B\u75BE\u75C5","\u65E9\u7522"],s=_e(null);function i(o){s.value=!0,e("submit",Hr(o),s.value)}return(o,a)=>(Q(),ie("form",{id:"from",onSubmit:Vr(i,["prevent"])},[$f,b("div",Tf,[b("div",Af,[b("label",Rf,[Dt(b("input",{type:"radio",class:"form-check-input",value:!1,"onUpdate:modelValue":a[0]||(a[0]=u=>n.value=u),required:"",disabled:t.disabled},null,8,kf),[[Or,n.value]]),Nf])]),b("div",Df,[b("label",Pf,[Dt(b("input",{type:"radio",class:"form-check-input",value:!0,"onUpdate:modelValue":a[1]||(a[1]=u=>n.value=u),required:"",disabled:t.disabled},null,8,Of),[[Or,n.value]]),Mf]),b("div",null,[(Q(),ie(Je,null,dt(r,(u,l)=>b("div",Ff,[b("label",Lf,[b("input",{type:"checkbox",class:"form-check-input",name:"specialDisease",value:u,disabled:t.disabled||!n.value},null,8,jf),oe(ke(u),1)])])),64))])])]),Uf,s.value?Ne("",!0):(Q(),ie("button",Bf,"\u78BA\u8A8D"))],40,If))}});const Vf=["onSubmit"],Hf=b("h5",null,"5\u3001TAIPEI II \u7BE9\u6AA2\u8868",-1),qf={class:"col-md-12"},Wf={key:0},zf=b("div",{class:"text-center"},[b("div",{class:"spinner-border",role:"status"},[b("span",{class:"visually-hidden"},"Loading...")])],-1),Kf=[zf],Gf={key:1},Yf={class:"row"},Jf={class:"col-md-1"},Qf={style:{color:"red"}},Xf={class:"col-md-9"},Zf={class:"form-check-label"},ep={class:"col-md-2 text-center"},tp=["id","name"],np=["for"],rp=["id","name"],sp=["for"],ip=["src"],op=b("br",null,null,-1),ap={key:0,class:"btn btn-primary",type:"submit"},lp=gt({__name:"UserFrom5",props:{kidBirthday:null},emits:["submit"],setup(t,{emit:e}){const n=t,r=_e({}),s=_e({questions:[],image:""});fetch("assets/monthRoot.json").then(u=>u.json()).then(u=>{r.value=u});const i=au(()=>{const l=ot().diff(ot(n.kidBirthday))/(1e3*60*60*24);let c="";for(const d in r.value)if(r.value[d].min<=l&&r.value[d].max>=l){c=r.value[d].title,fetch(d).then(p=>p.json()).then(p=>{p.questions.forEach((E,v,C)=>{E.title=E.title.replace(/^\d+\./gm,""),E.answer=!!E.answer}),s.value=p});break}return c}),o=_e(null);function a(u){const l=Hr(u),c=[];s.value.questions.forEach((d,p,E)=>{const v=d.answer?"true":"false";l["q_"+p]==v&&c.push(p+1),delete l["q_"+p]}),l.wrongAnswers=c.join("|"),e("submit",l,!!i.value)}return(u,l)=>(Q(),ie("form",{id:"from",onSubmit:Vr(a,["prevent"])},[Hf,b("div",qf,[Qt(i)?Ne("",!0):(Q(),ie("div",Wf,Kf)),Qt(i)?(Q(),ie("div",Gf,[b("h6",null,ke(Qt(i)),1),b("div",null,[(Q(!0),ie(Je,null,dt(s.value.questions,(c,d)=>(Q(),ie("div",{class:dh(d%2==0?"q_white_line":"q_gray_line")},[b("div",Yf,[b("div",Jf,[oe(ke(d+1),1),b("span",Qf,ke(c.special?"\u2605":""),1)]),b("div",Xf,[b("label",Zf,ke(c.title),1)]),b("div",ep,[b("input",{type:"radio",class:"slist_radio_input",id:`q5t_${d}`,name:`q_${d}`,required:"",value:!0},null,8,tp),b("label",{class:"slist_radio_label",for:`q5t_${d}`},"\u662F",8,np),b("input",{type:"radio",class:"slist_radio_input",id:`q5f_${d}`,name:`q_${d}`,required:"",value:!1},null,8,rp),b("label",{class:"slist_radio_label",for:`q5f_${d}`},"\u5426",8,sp)])])],2))),256)),b("img",{src:s.value.image,style:{width:"100%"}},null,8,ip)])])):Ne("",!0)]),op,o.value?Ne("",!0):(Q(),ie("button",ap,"\u78BA\u8A8D"))],40,Vf))}}),up=oe(" \u4E0D\u7B26\u5408\u672C\u9662\u770B\u8A3A\u689D\u4EF6\uFF0C\u82E5\u4ECD\u9700\u8981\u672C\u9662\u5C31\u8A3A\uFF0C\u5EFA\u8B70\u8F49\u8A3A\u81F3\u4EE5\u4E0B\u79D1\u5225\uFF1A"),cp=b("br",null,null,-1),dp=oe(" \u52D5\u4F5C\u3001\u8A9E\u8A00\u985E\u767C\u5C55\u554F\u984C \u2192 \u8ACB\u639B "),hp=b("a",{href:"https://register.vghtc.gov.tw/register/listDoctor.jsp?init=init&section=REHA"},"\u5FA9\u5065\u79D1",-1),fp=b("br",null,null,-1),pp=oe(" \u8A8D\u77E5\u3001\u4EBA\u969B\u3001\u60C5\u7DD2\u3001\u5C08\u6CE8\u529B\u3001\u904E\u52D5\u7B49 \u2192 \u8ACB\u639B"),mp=b("a",{href:"https://register.vghtc.gov.tw/register/listDoctor.jsp?init=init&section=PSYC"},"\u5152\u7AE5\u5FC3\u667A\u79D1",-1),_p=gt({__name:"SuggestReferral",setup(t){return(e,n)=>(Q(),ie(Je,null,[up,cp,dp,hp,fp,pp,mp],64))}});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cu={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x=function(t,e){if(!t)throw nr(e)},nr=function(t){return new Error("Firebase Database ("+cu.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const du=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},gp=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},so={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,u=s+2<t.length,l=u?t[s+2]:0,c=i>>2,d=(i&3)<<4|a>>4;let p=(a&15)<<2|l>>6,E=l&63;u||(E=64,o||(p=64)),r.push(n[c],n[d],n[p],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(du(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):gp(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const l=s<t.length?n[t.charAt(s)]:64;++s;const d=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||l==null||d==null)throw Error();const p=i<<2|a>>4;if(r.push(p),l!==64){const E=a<<4&240|l>>2;if(r.push(E),d!==64){const v=l<<6&192|d;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},hu=function(t){const e=du(t);return so.encodeByteArray(e,!0)},fu=function(t){return hu(t).replace(/\./g,"")},Ai=function(t){try{return so.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yp(t){return pu(void 0,t)}function pu(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!vp(n)||(t[n]=pu(t[n],e[n]));return t}function vp(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function oo(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ke())}function Ep(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function mu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function bp(){const t=Ke();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function _u(){return cu.NODE_ADMIN===!0}function wp(){return typeof indexedDB=="object"}function Sp(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cp="FirebaseError";class sn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Cp,Object.setPrototypeOf(this,sn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qr.prototype.create)}}class qr{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Ip(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new sn(s,a,r)}}function Ip(t,e){return t.replace($p,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const $p=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mr(t){return JSON.parse(t)}function Ve(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gu=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=Mr(Ai(i[0])||""),n=Mr(Ai(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},Tp=function(t){const e=gu(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},Ap=function(t){const e=gu(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Jn(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Ri(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Cs(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function Is(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(La(i)&&La(o)){if(!Is(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function La(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rr(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)r[d]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let d=0;d<16;d++)r[d]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let d=16;d<80;d++){const p=r[d-3]^r[d-8]^r[d-14]^r[d-16];r[d]=(p<<1|p>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],u=this.chain_[4],l,c;for(let d=0;d<80;d++){d<40?d<20?(l=a^i&(o^a),c=1518500249):(l=i^o^a,c=1859775393):d<60?(l=i&o|a&(i|o),c=2400959708):(l=i^o^a,c=3395469782);const p=(s<<5|s>>>27)+l+u+c+r[d]&4294967295;u=a,a=o,o=(i<<30|i>>>2)&4294967295,i=s,s=p}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let o=this.inbuf_;for(;s<n;){if(o===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}else for(;s<n;)if(i[o]=e[s],++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function kp(t,e){const n=new Np(t,e);return n.subscribe.bind(n)}class Np{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Dp(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=li),s.error===void 0&&(s.error=li),s.complete===void 0&&(s.complete=li);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console!="undefined"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Dp(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function li(){}function Pp(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Op=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,x(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;s=65536+(i<<10)+o}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},qs=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wr(t){return t&&t._delegate?t._delegate:t}class vn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new io;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Lp(e))try{this.getOrInitializeService({instanceIdentifier:dn})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=dn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=dn){return this.instances.has(e)}getOptions(e=dn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(!!r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Fp(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=dn){return this.component?this.component.multipleInstances?e:dn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Fp(t){return t===dn?void 0:t}function Lp(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Mp(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ee;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ee||(Ee={}));const Up={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},Bp=Ee.INFO,xp={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},Vp=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=xp[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ao{constructor(e){this.name=e,this._logLevel=Bp,this._logHandler=Vp,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Up[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}}const Hp=(t,e)=>e.some(n=>t instanceof n);let ja,Ua;function qp(){return ja||(ja=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Wp(){return Ua||(Ua=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yu=new WeakMap,ki=new WeakMap,vu=new WeakMap,ui=new WeakMap,lo=new WeakMap;function zp(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Xt(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&yu.set(n,t)}).catch(()=>{}),lo.set(e,t),e}function Kp(t){if(ki.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});ki.set(t,e)}let Ni={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ki.get(t);if(e==="objectStoreNames")return t.objectStoreNames||vu.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Xt(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Gp(t){Ni=t(Ni)}function Yp(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(ci(this),e,...n);return vu.set(r,e.sort?e.sort():[e]),Xt(r)}:Wp().includes(t)?function(...e){return t.apply(ci(this),e),Xt(yu.get(this))}:function(...e){return Xt(t.apply(ci(this),e))}}function Jp(t){return typeof t=="function"?Yp(t):(t instanceof IDBTransaction&&Kp(t),Hp(t,qp())?new Proxy(t,Ni):t)}function Xt(t){if(t instanceof IDBRequest)return zp(t);if(ui.has(t))return ui.get(t);const e=Jp(t);return e!==t&&(ui.set(t,e),lo.set(e,t)),e}const ci=t=>lo.get(t);function Qp(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Xt(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Xt(o.result),u.oldVersion,u.newVersion,Xt(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}const Xp=["get","getKey","getAll","getAllKeys","count"],Zp=["put","add","delete","clear"],di=new Map;function Ba(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(di.get(e))return di.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Zp.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Xp.includes(n)))return;const i=async function(o,...a){const u=this.transaction(o,s?"readwrite":"readonly");let l=u.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),s&&u.done]))[0]};return di.set(e,i),i}Gp(t=>Nt(Ue({},t),{get:(e,n,r)=>Ba(e,n)||t.get(e,n,r),has:(e,n)=>!!Ba(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(tm(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function tm(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Di="@firebase/app",xa="0.7.32";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const En=new ao("@firebase/app"),nm="@firebase/app-compat",rm="@firebase/analytics-compat",sm="@firebase/analytics",im="@firebase/app-check-compat",om="@firebase/app-check",am="@firebase/auth",lm="@firebase/auth-compat",um="@firebase/database",cm="@firebase/database-compat",dm="@firebase/functions",hm="@firebase/functions-compat",fm="@firebase/installations",pm="@firebase/installations-compat",mm="@firebase/messaging",_m="@firebase/messaging-compat",gm="@firebase/performance",ym="@firebase/performance-compat",vm="@firebase/remote-config",Em="@firebase/remote-config-compat",bm="@firebase/storage",wm="@firebase/storage-compat",Sm="@firebase/firestore",Cm="@firebase/firestore-compat",Im="firebase",$m="9.9.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eu="[DEFAULT]",Tm={[Di]:"fire-core",[nm]:"fire-core-compat",[sm]:"fire-analytics",[rm]:"fire-analytics-compat",[om]:"fire-app-check",[im]:"fire-app-check-compat",[am]:"fire-auth",[lm]:"fire-auth-compat",[um]:"fire-rtdb",[cm]:"fire-rtdb-compat",[dm]:"fire-fn",[hm]:"fire-fn-compat",[fm]:"fire-iid",[pm]:"fire-iid-compat",[mm]:"fire-fcm",[_m]:"fire-fcm-compat",[gm]:"fire-perf",[ym]:"fire-perf-compat",[vm]:"fire-rc",[Em]:"fire-rc-compat",[bm]:"fire-gcs",[wm]:"fire-gcs-compat",[Sm]:"fire-fst",[Cm]:"fire-fst-compat","fire-js":"fire-js",[Im]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s=new Map,Pi=new Map;function Am(t,e){try{t.container.addComponent(e)}catch(n){En.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Qn(t){const e=t.name;if(Pi.has(e))return En.debug(`There were multiple attempts to register component ${e}.`),!1;Pi.set(e,t);for(const n of $s.values())Am(n,t);return!0}function bu(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rm={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},bn=new qr("app","Firebase",Rm);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new vn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr=$m;function Nm(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:Eu,automaticDataCollectionEnabled:!1},e),r=n.name;if(typeof r!="string"||!r)throw bn.create("bad-app-name",{appName:String(r)});const s=$s.get(r);if(s){if(Is(t,s.options)&&Is(n,s.config))return s;throw bn.create("duplicate-app",{appName:r})}const i=new jp(r);for(const a of Pi.values())i.addComponent(a);const o=new km(t,n,i);return $s.set(r,o),o}function Dm(t=Eu){const e=$s.get(t);if(!e)throw bn.create("no-app",{appName:t});return e}function Zt(t,e,n){var r;let s=(r=Tm[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),En.warn(a.join(" "));return}Qn(new vn(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pm="firebase-heartbeat-database",Om=1,Fr="firebase-heartbeat-store";let hi=null;function wu(){return hi||(hi=Qp(Pm,Om,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Fr)}}}).catch(t=>{throw bn.create("idb-open",{originalErrorMessage:t.message})})),hi}async function Mm(t){var e;try{return(await wu()).transaction(Fr).objectStore(Fr).get(Su(t))}catch(n){if(n instanceof sn)En.warn(n.message);else{const r=bn.create("idb-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message});En.warn(r.message)}}}async function Va(t,e){var n;try{const s=(await wu()).transaction(Fr,"readwrite");return await s.objectStore(Fr).put(e,Su(t)),s.done}catch(r){if(r instanceof sn)En.warn(r.message);else{const s=bn.create("idb-set",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message});En.warn(s.message)}}}function Su(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm=1024,Lm=30*24*60*60*1e3;class jm{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Bm(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ha();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=Lm}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Ha(),{heartbeatsToSend:n,unsentEntries:r}=Um(this._heartbeatsCache.heartbeats),s=fu(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Ha(){return new Date().toISOString().substring(0,10)}function Um(t,e=Fm){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),qa(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),qa(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Bm{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return wp()?Sp().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Mm(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Va(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Va(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function qa(t){return fu(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xm(t){Qn(new vn("platform-logger",e=>new em(e),"PRIVATE")),Qn(new vn("heartbeat",e=>new jm(e),"PRIVATE")),Zt(Di,xa,t),Zt(Di,xa,"esm2017"),Zt("fire-js","")}xm("");var Vm="firebase",Hm="9.9.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zt(Vm,Hm,"app");function uo(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Cu(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const qm=Cu,Iu=new qr("auth","Firebase",Cu());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wa=new ao("@firebase/auth");function _s(t,...e){Wa.logLevel<=Ee.ERROR&&Wa.error(`Auth (${zr}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ut(t,...e){throw co(t,...e)}function Tt(t,...e){return co(t,...e)}function Wm(t,e,n){const r=Object.assign(Object.assign({},qm()),{[e]:n});return new qr("auth","Firebase",r).create(e,{appName:t.name})}function co(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Iu.create(t,...e)}function se(t,e,...n){if(!t)throw co(e,...n)}function Pt(t){const e="INTERNAL ASSERTION FAILED: "+t;throw _s(e),new Error(e)}function Bt(t,e){t||Pt(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const za=new Map;function Ot(t){Bt(t instanceof Function,"Expected a class definition");let e=za.get(t);return e?(Bt(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,za.set(t,e),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zm(t,e){const n=bu(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Is(i,e!=null?e:{}))return s;Ut(s,"already-initialized")}return n.initialize({options:e})}function Km(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ot);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oi(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Gm(){return Ka()==="http:"||Ka()==="https:"}function Ka(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ym(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Gm()||Ep()||"connection"in navigator)?navigator.onLine:!0}function Jm(){if(typeof navigator=="undefined")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e,n){this.shortDelay=e,this.longDelay=n,Bt(n>e,"Short delay should be less than long delay!"),this.isMobile=oo()||mu()}get(){return Ym()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ho(t,e){Bt(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;Pt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;Pt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;Pt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qm={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xm=new Kr(3e4,6e4);function Tu(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ws(t,e,n,r,s={}){return Au(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=rr(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),$u.fetch()(ku(t,t.config.apiHost,n,a),Object.assign({method:e,headers:u,referrerPolicy:"no-referrer"},i))})}async function Au(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Qm),e);try{const s=new Zm(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw ls(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[u,l]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw ls(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw ls(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw ls(t,"user-disabled",o);const c=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw Wm(t,c,l);Ut(t,c)}}catch(s){if(s instanceof sn)throw s;Ut(t,"network-request-failed")}}async function Ru(t,e,n,r,s={}){const i=await Ws(t,e,n,r,s);return"mfaPendingCredential"in i&&Ut(t,"multi-factor-auth-required",{_serverResponse:i}),i}function ku(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?ho(t.config,s):`${t.config.apiScheme}://${s}`}class Zm{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Tt(this.auth,"network-request-failed")),Xm.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ls(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Tt(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e_(t,e){return Ws(t,"POST","/v1/accounts:delete",e)}async function t_(t,e){return Ws(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(t){if(!!t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function n_(t,e=!1){const n=Wr(t),r=await n.getIdToken(e),s=fo(r);se(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Ir(fi(s.auth_time)),issuedAtTime:Ir(fi(s.iat)),expirationTime:Ir(fi(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function fi(t){return Number(t)*1e3}function fo(t){var e;const[n,r,s]=t.split(".");if(n===void 0||r===void 0||s===void 0)return _s("JWT malformed, contained fewer than 3 sections"),null;try{const i=Ai(r);return i?JSON.parse(i):(_s("Failed to decode base64 JWT payload"),null)}catch(i){return _s("Caught error parsing JWT payload as JSON",(e=i)===null||e===void 0?void 0:e.toString()),null}}function r_(t){const e=fo(t);return se(e,"internal-error"),se(typeof e.exp!="undefined","internal-error"),se(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lr(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof sn&&s_(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function s_({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){var e;try{await this.user.getIdToken(!0)}catch(n){((e=n)===null||e===void 0?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ir(this.lastLoginAt),this.creationTime=Ir(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ts(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Lr(t,t_(n,{idToken:r}));se(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?l_(i.providerUserInfo):[],a=a_(t.providerData,o),u=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),c=u?l:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Nu(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(t,d)}async function o_(t){const e=Wr(t);await Ts(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function a_(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function l_(t){return t.map(e=>{var{providerId:n}=e,r=uo(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u_(t,e){const n=await Au(t,{},async()=>{const r=rr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=ku(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",$u.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){se(e.idToken,"internal-error"),se(typeof e.idToken!="undefined","internal-error"),se(typeof e.refreshToken!="undefined","internal-error");const n="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):r_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return se(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await u_(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new jr;return r&&(se(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(se(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(se(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jr,this.toJSON())}_performRefresh(){return Pt("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(t,e){se(typeof t=="string"||typeof t=="undefined","internal-error",{appName:e})}class gn{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=uo(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new i_(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Nu(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Lr(this,this.stsTokenManager.getToken(this.auth,e));return se(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return n_(this,e)}reload(){return o_(this)}_assign(e){this!==e&&(se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new gn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Ts(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Lr(this,e_(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,a,u,l,c;const d=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,E=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,v=(o=n.photoURL)!==null&&o!==void 0?o:void 0,C=(a=n.tenantId)!==null&&a!==void 0?a:void 0,S=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,g=(l=n.createdAt)!==null&&l!==void 0?l:void 0,T=(c=n.lastLoginAt)!==null&&c!==void 0?c:void 0,{uid:A,emailVerified:O,isAnonymous:L,providerData:$,stsTokenManager:N}=n;se(A&&N,e,"internal-error");const F=jr.fromJSON(this.name,N);se(typeof A=="string",e,"internal-error"),Ht(d,e.name),Ht(p,e.name),se(typeof O=="boolean",e,"internal-error"),se(typeof L=="boolean",e,"internal-error"),Ht(E,e.name),Ht(v,e.name),Ht(C,e.name),Ht(S,e.name),Ht(g,e.name),Ht(T,e.name);const q=new gn({uid:A,auth:e,email:p,emailVerified:O,displayName:d,isAnonymous:L,photoURL:v,phoneNumber:E,tenantId:C,stsTokenManager:F,createdAt:g,lastLoginAt:T});return $&&Array.isArray($)&&(q.providerData=$.map(W=>Object.assign({},W))),S&&(q._redirectEventId=S),q}static async _fromIdTokenResponse(e,n,r=!1){const s=new jr;s.updateFromServerResponse(n);const i=new gn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Ts(i),i}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Du.type="NONE";const Ga=Du;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gs(t,e,n){return`firebase:${t}:${e}:${n}`}class Wn{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=gs(this.userKey,s.apiKey,i),this.fullPersistenceKey=gs("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?gn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Wn(Ot(Ga),e,r);const s=(await Promise.all(n.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let i=s[0]||Ot(Ga);const o=gs(r,e.config.apiKey,e.name);let a=null;for(const l of n)try{const c=await l._get(o);if(c){const d=gn._fromJSON(e,c);l!==i&&(a=d),i=l;break}}catch{}const u=s.filter(l=>l._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Wn(i,e,r):(i=u[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async l=>{if(l!==i)try{await l._remove(o)}catch{}})),new Wn(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ya(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Mu(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Pu(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Lu(e))return"Blackberry";if(ju(e))return"Webos";if(po(e))return"Safari";if((e.includes("chrome/")||Ou(e))&&!e.includes("edge/"))return"Chrome";if(Fu(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Pu(t=Ke()){return/firefox\//i.test(t)}function po(t=Ke()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ou(t=Ke()){return/crios\//i.test(t)}function Mu(t=Ke()){return/iemobile/i.test(t)}function Fu(t=Ke()){return/android/i.test(t)}function Lu(t=Ke()){return/blackberry/i.test(t)}function ju(t=Ke()){return/webos/i.test(t)}function zs(t=Ke()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function c_(t=Ke()){var e;return zs(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function d_(){return bp()&&document.documentMode===10}function Uu(t=Ke()){return zs(t)||Fu(t)||ju(t)||Lu(t)||/windows phone/i.test(t)||Mu(t)}function h_(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bu(t,e=[]){let n;switch(t){case"Browser":n=Ya(Ke());break;case"Worker":n=`${Ya(Ke())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${zr}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const u=e(i);o(u)}catch(u){a(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){var n;if(this.auth.currentUser===e)return;const r=[];try{for(const s of this.queue)await s(e),s.onAbort&&r.push(s.onAbort)}catch(s){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:(n=s)===null||n===void 0?void 0:n.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(e,n,r){this.app=e,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ja(this),this.idTokenSubscription=new Ja(this),this.beforeStateQueue=new f_(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Iu,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ot(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Wn.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===a)&&(u==null?void 0:u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){var n;try{await Ts(e)}catch(r){if(((n=r)===null||n===void 0?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Jm()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?Wr(e):null;return n&&se(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Ot(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new qr("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ot(e)||this._popupRedirectResolver;se(n,this,"argument-error"),this.redirectPersistenceManager=await Wn.create(this,[Ot(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n),o=this._isInitialized?Promise.resolve():this._initializationPromise;return se(o,this,"internal-error"),o.then(()=>i(this.currentUser)),typeof n=="function"?e.addObserver(n,r,s):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Bu(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());return r&&(n["X-Firebase-Client"]=r),n}}function mo(t){return Wr(t)}class Ja{constructor(e){this.auth=e,this.observer=null,this.addObserver=kp(n=>this.observer=n)}get next(){return se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Pt("not implemented")}_getIdTokenResponse(e){return Pt("not implemented")}_linkToIdToken(e,n){return Pt("not implemented")}_getReauthenticationResolver(e){return Pt("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zn(t,e){return Ru(t,"POST","/v1/accounts:signInWithIdp",Tu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_="http://localhost";class wn extends xu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new wn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ut("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=uo(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new wn(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return zn(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,zn(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,zn(e,n)}buildRequest(){const e={requestUri:m_,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=rr(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr extends Vu{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt extends Gr{constructor(){super("facebook.com")}static credential(e){return wn._fromParams({providerId:zt.PROVIDER_ID,signInMethod:zt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zt.credentialFromTaggedObject(e)}static credentialFromError(e){return zt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zt.credential(e.oauthAccessToken)}catch{return null}}}zt.FACEBOOK_SIGN_IN_METHOD="facebook.com";zt.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt extends Gr{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return wn._fromParams({providerId:Kt.PROVIDER_ID,signInMethod:Kt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Kt.credentialFromTaggedObject(e)}static credentialFromError(e){return Kt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Kt.credential(n,r)}catch{return null}}}Kt.GOOGLE_SIGN_IN_METHOD="google.com";Kt.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt extends Gr{constructor(){super("github.com")}static credential(e){return wn._fromParams({providerId:Gt.PROVIDER_ID,signInMethod:Gt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gt.credentialFromTaggedObject(e)}static credentialFromError(e){return Gt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gt.credential(e.oauthAccessToken)}catch{return null}}}Gt.GITHUB_SIGN_IN_METHOD="github.com";Gt.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt extends Gr{constructor(){super("twitter.com")}static credential(e,n){return wn._fromParams({providerId:Yt.PROVIDER_ID,signInMethod:Yt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Yt.credentialFromTaggedObject(e)}static credentialFromError(e){return Yt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Yt.credential(n,r)}catch{return null}}}Yt.TWITTER_SIGN_IN_METHOD="twitter.com";Yt.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function __(t,e){return Ru(t,"POST","/v1/accounts:signUp",Tu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await gn._fromIdTokenResponse(e,r,s),o=Qa(r);return new nn({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Qa(r);return new nn({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Qa(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g_(t){var e;const n=mo(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new nn({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await __(n,{returnSecureToken:!0}),s=await nn._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends sn{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,As.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new As(e,n,r,s)}}function Hu(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?As._fromErrorAndOperation(t,i,e,r):i})}async function y_(t,e,n=!1){const r=await Lr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return nn._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v_(t,e,n=!1){var r;const{auth:s}=t,i="reauthenticate";try{const o=await Lr(t,Hu(s,i,e,t),n);se(o.idToken,s,"internal-error");const a=fo(o.idToken);se(a,s,"internal-error");const{sub:u}=a;return se(t.uid===u,s,"user-mismatch"),nn._forOperation(t,i,o)}catch(o){throw((r=o)===null||r===void 0?void 0:r.code)==="auth/user-not-found"&&Ut(s,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E_(t,e,n=!1){const r="signIn",s=await Hu(t,r,e),i=await nn._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}const Rs="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Rs,"1"),this.storage.removeItem(Rs),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b_(){const t=Ke();return po(t)||zs(t)}const w_=1e3,S_=10;class Wu extends qu{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=b_()&&h_(),this.fallbackToPolling=Uu(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,u)=>{this.notifyListeners(o,u)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);d_()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,S_):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},w_)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Wu.type="LOCAL";const C_=Wu;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu extends qu{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}zu.type="SESSION";const Ku=zu;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I_(t){return Promise.all(t.map(async e=>{try{const n=await e;return{fulfilled:!0,value:n}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Ks(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async l=>l(n.origin,i)),u=await I_(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ks.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _o(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,u)=>{const l=_o("",20);s.port1.start();const c=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(d){const p=d;if(p.data.eventId===l)switch(p.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(p.data.response);break;default:clearTimeout(c),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(){return window}function T_(t){At().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gu(){return typeof At().WorkerGlobalScope!="undefined"&&typeof At().importScripts=="function"}async function A_(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function R_(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function k_(){return Gu()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yu="firebaseLocalStorageDb",N_=1,ks="firebaseLocalStorage",Ju="fbase_key";class Yr{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Gs(t,e){return t.transaction([ks],e?"readwrite":"readonly").objectStore(ks)}function D_(){const t=indexedDB.deleteDatabase(Yu);return new Yr(t).toPromise()}function Mi(){const t=indexedDB.open(Yu,N_);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(ks,{keyPath:Ju})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(ks)?e(r):(r.close(),await D_(),e(await Mi()))})})}async function Xa(t,e,n){const r=Gs(t,!0).put({[Ju]:e,value:n});return new Yr(r).toPromise()}async function P_(t,e){const n=Gs(t,!1).get(e),r=await new Yr(n).toPromise();return r===void 0?null:r.value}function Za(t,e){const n=Gs(t,!0).delete(e);return new Yr(n).toPromise()}const O_=800,M_=3;class Qu{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Mi(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>M_)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Gu()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ks._getInstance(k_()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await A_(),!this.activeServiceWorker)return;this.sender=new $_(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);!r||((e=r[0])===null||e===void 0?void 0:e.fulfilled)&&((n=r[0])===null||n===void 0?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||R_()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Mi();return await Xa(e,Rs,"1"),await Za(e,Rs),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Xa(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>P_(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Za(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Gs(s,!1).getAll();return new Yr(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),O_)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Qu.type="LOCAL";const F_=Qu;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function j_(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Tt("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",L_().appendChild(r)})}function U_(t){return`__${t}${Math.floor(Math.random()*1e6)}`}new Kr(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B_(t,e){return e?Ot(e):(se(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go extends xu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return zn(e,this._buildIdpRequest())}_linkToIdToken(e,n){return zn(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return zn(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function x_(t){return E_(t.auth,new go(t),t.bypassAuthState)}function V_(t){const{auth:e,user:n}=t;return se(n,e,"internal-error"),v_(n,new go(t),t.bypassAuthState)}async function H_(t){const{auth:e,user:n}=t;return se(n,e,"internal-error"),y_(n,new go(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return x_;case"linkViaPopup":case"linkViaRedirect":return H_;case"reauthViaPopup":case"reauthViaRedirect":return V_;default:Ut(this.auth,"internal-error")}}resolve(e){Bt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_=new Kr(2e3,1e4);class Vn extends Xu{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Vn.currentPopupAction&&Vn.currentPopupAction.cancel(),Vn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return se(e,this.auth,"internal-error"),e}async onExecution(){Bt(this.filter.length===1,"Popup operations only handle one event");const e=_o();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Tt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Tt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vn.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Tt(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,q_.get())};e()}}Vn.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W_="pendingRedirect",ys=new Map;class z_ extends Xu{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=ys.get(this.auth._key());if(!e){try{const r=await K_(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}ys.set(this.auth._key(),e)}return this.bypassAuthState||ys.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function K_(t,e){const n=J_(e),r=Y_(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function G_(t,e){ys.set(t._key(),e)}function Y_(t){return Ot(t._redirectPersistence)}function J_(t){return gs(W_,t.config.apiKey,t.name)}async function Q_(t,e,n=!1){const r=mo(t),s=B_(r,e),o=await new z_(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_=10*60*1e3;class Z_{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!eg(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Zu(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Tt(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=X_&&this.cachedEventUids.clear(),this.cachedEventUids.has(el(e))}saveEventToCache(e){this.cachedEventUids.add(el(e)),this.lastProcessedEventTime=Date.now()}}function el(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Zu({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function eg(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Zu(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tg(t,e={}){return Ws(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rg=/^https?/;async function sg(t){if(t.config.emulator)return;const{authorizedDomains:e}=await tg(t);for(const n of e)try{if(ig(n))return}catch{}Ut(t,"unauthorized-domain")}function ig(t){const e=Oi(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!rg.test(n))return!1;if(ng.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og=new Kr(3e4,6e4);function tl(){const t=At().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function ag(t){return new Promise((e,n)=>{var r,s,i;function o(){tl(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{tl(),n(Tt(t,"network-request-failed"))},timeout:og.get()})}if(!((s=(r=At().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=At().gapi)===null||i===void 0)&&i.load)o();else{const a=U_("iframefcb");return At()[a]=()=>{gapi.load?o():n(Tt(t,"network-request-failed"))},j_(`https://apis.google.com/js/api.js?onload=${a}`).catch(u=>n(u))}}).catch(e=>{throw vs=null,e})}let vs=null;function lg(t){return vs=vs||ag(t),vs}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ug=new Kr(5e3,15e3),cg="__/auth/iframe",dg="emulator/auth/iframe",hg={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fg=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pg(t){const e=t.config;se(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ho(e,dg):`https://${t.config.authDomain}/${cg}`,r={apiKey:e.apiKey,appName:t.name,v:zr},s=fg.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${rr(r).slice(1)}`}async function mg(t){const e=await lg(t),n=At().gapi;return se(n,t,"internal-error"),e.open({where:document.body,url:pg(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hg,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Tt(t,"network-request-failed"),a=At().setTimeout(()=>{i(o)},ug.get());function u(){At().clearTimeout(a),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _g={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},gg=500,yg=600,vg="_blank",Eg="http://localhost";class nl{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function bg(t,e,n,r=gg,s=yg){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const u=Object.assign(Object.assign({},_g),{width:r.toString(),height:s.toString(),top:i,left:o}),l=Ke().toLowerCase();n&&(a=Ou(l)?vg:n),Pu(l)&&(e=e||Eg,u.scrollbars="yes");const c=Object.entries(u).reduce((p,[E,v])=>`${p}${E}=${v},`,"");if(c_(l)&&a!=="_self")return wg(e||"",a),new nl(null);const d=window.open(e||"",a,c);se(d,t,"popup-blocked");try{d.focus()}catch{}return new nl(d)}function wg(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sg="__/auth/handler",Cg="emulator/auth/handler";function rl(t,e,n,r,s,i){se(t.config.authDomain,t,"auth-domain-config-required"),se(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:zr,eventId:s};if(e instanceof Vu){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Ri(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,l]of Object.entries(i||{}))o[u]=l}if(e instanceof Gr){const u=e.getScopes().filter(l=>l!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];return`${Ig(t)}?${rr(a).slice(1)}`}function Ig({config:t}){return t.emulator?ho(t,Cg):`https://${t.authDomain}/${Sg}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi="webStorageSupport";class $g{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ku,this._completeRedirectFn=Q_,this._overrideRedirectResult=G_}async _openPopup(e,n,r,s){var i;Bt((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=rl(e,n,r,Oi(),s);return bg(e,o,_o())}async _openRedirect(e,n,r,s){return await this._originValidation(e),T_(rl(e,n,r,Oi(),s)),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Bt(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await mg(e),r=new Z_(e);return n.register("authEvent",s=>(se(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(pi,{type:pi},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[pi];o!==void 0&&n(!!o),Ut(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=sg(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Uu()||po()||zs()}}const Tg=$g;var sl="@firebase/auth",il="0.20.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{var s;e(((s=r)===null||s===void 0?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);!n||(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rg(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function kg(t){Qn(new vn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),{apiKey:i,authDomain:o}=r.options;return((a,u)=>{se(i&&!i.includes(":"),"invalid-api-key",{appName:a.name}),se(!(o!=null&&o.includes(":")),"argument-error",{appName:a.name});const l={apiKey:i,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Bu(t)},c=new p_(a,u,l);return Km(c,n),c})(r,s)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Qn(new vn("auth-internal",e=>{const n=mo(e.getProvider("auth").getImmediate());return(r=>new Ag(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zt(sl,il,Rg(t)),Zt(sl,il,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ng(t=Dm()){const e=bu(t,"auth");return e.isInitialized()?e.getImmediate():zm(t,{popupRedirectResolver:Tg,persistence:[F_,C_,Ku]})}kg("Browser");const ol="@firebase/database",al="0.13.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ec="";function Dg(t){ec=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ve(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Mr(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Og{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return xt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tc=function(t){try{if(typeof window!="undefined"&&typeof window[t]!="undefined"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Pg(e)}}catch{}return new Og},_n=tc("localStorage"),Fi=tc("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn=new ao("@firebase/database"),Mg=function(){let t=1;return function(){return t++}}(),nc=function(t){const e=Op(t),n=new Rp;n.update(e);const r=n.digest();return so.encodeByteArray(r)},Jr=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Jr.apply(null,r):typeof r=="object"?e+=Ve(r):e+=r,e+=" "}return e};let yn=null,ll=!0;const Fg=function(t,e){x(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Kn.logLevel=Ee.VERBOSE,yn=Kn.log.bind(Kn),e&&Fi.set("logging_enabled",!0)):typeof t=="function"?yn=t:(yn=null,Fi.remove("logging_enabled"))},qe=function(...t){if(ll===!0&&(ll=!1,yn===null&&Fi.get("logging_enabled")===!0&&Fg(!0)),yn){const e=Jr.apply(null,t);yn(e)}},Qr=function(t){return function(...e){qe(t,...e)}},Li=function(...t){const e="FIREBASE INTERNAL ERROR: "+Jr(...t);Kn.error(e)},Sn=function(...t){const e=`FIREBASE FATAL ERROR: ${Jr(...t)}`;throw Kn.error(e),new Error(e)},nt=function(...t){const e="FIREBASE WARNING: "+Jr(...t);Kn.warn(e)},Lg=function(){typeof window!="undefined"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&nt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},rc=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},jg=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Xn="[MIN_NAME]",Cn="[MAX_NAME]",sr=function(t,e){if(t===e)return 0;if(t===Xn||e===Cn)return-1;if(e===Xn||t===Cn)return 1;{const n=ul(t),r=ul(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},Ug=function(t,e){return t===e?0:t<e?-1:1},yr=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Ve(e))},yo=function(t){if(typeof t!="object"||t===null)return Ve(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Ve(e[r]),n+=":",n+=yo(t[e[r]]);return n+="}",n},sc=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function lt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const ic=function(t){x(!rc(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,o,a,u;t===0?(i=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-r-n))));const l=[];for(u=n;u;u-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)l.push(i%2?1:0),i=Math.floor(i/2);l.push(s?1:0),l.reverse();const c=l.join("");let d="";for(u=0;u<64;u+=8){let p=parseInt(c.substr(u,8),2).toString(16);p.length===1&&(p="0"+p),d=d+p}return d.toLowerCase()},Bg=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},xg=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},Vg=new RegExp("^-?(0*)\\d{1,10}$"),Hg=-2147483648,qg=2147483647,ul=function(t){if(Vg.test(t)){const e=Number(t);if(e>=Hg&&e<=qg)return e}return null},Xr=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw nt("Exception was thrown by user callback.",n),e},Math.floor(0))}},Wg=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},$r=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno!="undefined"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){nt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(qe("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',nt(e)}}class ji{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}ji.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo="5",oc="v",ac="s",lc="r",uc="f",cc=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,dc="ls",hc="p",Ui="ac",fc="websocket",pc="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e,n,r,s,i=!1,o="",a=!1){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=_n.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&_n.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function Yg(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function mc(t,e,n){x(typeof e=="string","typeof type must == string"),x(typeof n=="object","typeof params must == object");let r;if(e===fc)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===pc)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Yg(t)&&(n.ns=t.namespace);const s=[];return lt(n,(i,o)=>{s.push(i+"="+o)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(){this.counters_={}}incrementCounter(e,n=1){xt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return yp(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi={},_i={};function Eo(t){const e=t.toString();return mi[e]||(mi[e]=new Jg),mi[e]}function Qg(t,e){const n=t.toString();return _i[n]||(_i[n]=e()),_i[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&Xr(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl="start",Zg="close",ey="pLPCommand",ty="pRTLPCB",_c="id",gc="pw",yc="ser",ny="cb",ry="seg",sy="ts",iy="d",oy="dframe",vc=1870,Ec=30,ay=vc-Ec,ly=25e3,uy=3e4;class Hn{constructor(e,n,r,s,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Qr(e),this.stats_=Eo(n),this.urlFn=u=>(this.appCheckToken&&(u[Ui]=this.appCheckToken),mc(n,pc,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Xg(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(uy)),jg(()=>{if(this.isClosed_)return;this.scriptTagHolder=new bo((...i)=>{const[o,a,u,l,c]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===cl)this.id=a,this.password=u;else if(o===Zg)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[cl]="t",r[yc]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[ny]=this.scriptTagHolder.uniqueCallbackIdentifier),r[oc]=vo,this.transportSessionId&&(r[ac]=this.transportSessionId),this.lastSessionId&&(r[dc]=this.lastSessionId),this.applicationId&&(r[hc]=this.applicationId),this.appCheckToken&&(r[Ui]=this.appCheckToken),typeof location!="undefined"&&location.hostname&&cc.test(location.hostname)&&(r[lc]=uc);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Hn.forceAllow_=!0}static forceDisallow(){Hn.forceDisallow_=!0}static isAvailable(){return Hn.forceAllow_?!0:!Hn.forceDisallow_&&typeof document!="undefined"&&document.createElement!=null&&!Bg()&&!xg()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Ve(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=hu(n),s=sc(r,ay);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[oy]="t",r[_c]=e,r[gc]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Ve(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class bo{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Mg(),window[ey+this.uniqueCallbackIdentifier]=e,window[ty+this.uniqueCallbackIdentifier]=n,this.myIFrame=bo.createIFrame_();let i="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){const a=document.domain;i='<script>document.domain="'+a+'";<\/script>'}const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){qe("frame writing exception"),a.stack&&qe(a.stack),qe(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||qe("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[_c]=this.myID,e[gc]=this.myPW,e[yc]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Ec+r.length<=vc;){const o=this.pendingSegs.shift();r=r+"&"+ry+s+"="+o.seg+"&"+sy+s+"="+o.ts+"&"+iy+s+"="+o.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(ly)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{qe("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy=16384,dy=45e3;let Ns=null;typeof MozWebSocket!="undefined"?Ns=MozWebSocket:typeof WebSocket!="undefined"&&(Ns=WebSocket);class ht{constructor(e,n,r,s,i,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Qr(this.connId),this.stats_=Eo(n),this.connURL=ht.connectionURL_(n,o,a,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const o={};return o[oc]=vo,typeof location!="undefined"&&location.hostname&&cc.test(location.hostname)&&(o[lc]=uc),n&&(o[ac]=n),r&&(o[dc]=r),s&&(o[Ui]=s),i&&(o[hc]=i),mc(e,fc,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,_n.set("previous_websocket_failure",!0);try{let r;_u(),this.mySock=new Ns(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){ht.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator!="undefined"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Ns!==null&&!ht.forceDisallow_}static previouslyFailed(){return _n.isInMemoryStorage||_n.get("previous_websocket_failure")===!0}markConnectionHealthy(){_n.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=Mr(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(x(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=Ve(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=sc(n,cy);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(dy))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ht.responsesRequiredToBeHealthy=2;ht.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Hn,ht]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=ht&&ht.isAvailable();let r=n&&!ht.previouslyFailed();if(e.webSocketOnly&&(n||nt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[ht];else{const s=this.transports_=[];for(const i of Ur.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);Ur.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ur.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hy=6e4,fy=5e3,py=10*1024,my=100*1024,gi="t",dl="d",_y="s",hl="r",gy="e",fl="o",pl="a",ml="n",_l="p",yy="h";class vy{constructor(e,n,r,s,i,o,a,u,l,c){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Qr("c:"+this.id+":"),this.transportManager_=new Ur(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=$r(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>my?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>py?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(gi in e){const n=e[gi];n===pl?this.upgradeIfSecondaryHealthy_():n===hl?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===fl&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=yr("t",e),r=yr("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:_l,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:pl,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:ml,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=yr("t",e),r=yr("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=yr(gi,e);if(dl in e){const r=e[dl];if(n===yy)this.onHandshake_(r);else if(n===ml){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===_y?this.onConnectionShutdown_(r):n===hl?this.onReset_(r):n===gy?Li("Server Error: "+r):n===fl?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Li("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),vo!==r&&nt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),$r(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(hy))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):$r(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(fy))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:_l,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(_n.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e){this.allowedEvents_=e,this.listeners_={},x(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){x(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds extends wc{constructor(){super(["online"]),this.online_=!0,typeof window!="undefined"&&typeof window.addEventListener!="undefined"&&!oo()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Ds}getInitialEvent(e){return x(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gl=32,yl=768;class Te{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function ve(){return new Te("")}function fe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function rn(t){return t.pieces_.length-t.pieceNum_}function Ie(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Te(t.pieces_,e)}function Sc(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Ey(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Cc(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Ic(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Te(e,0)}function je(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Te)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new Te(n,0)}function de(t){return t.pieceNum_>=t.pieces_.length}function at(t,e){const n=fe(t),r=fe(e);if(n===null)return e;if(n===r)return at(Ie(t),Ie(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function $c(t,e){if(rn(t)!==rn(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function pt(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(rn(t)>rn(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class by{constructor(e,n){this.errorPrefix_=n,this.parts_=Cc(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=qs(this.parts_[r]);Tc(this)}}function wy(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=qs(e),Tc(t)}function Sy(t){const e=t.parts_.pop();t.byteLength_-=qs(e),t.parts_.length>0&&(t.byteLength_-=1)}function Tc(t){if(t.byteLength_>yl)throw new Error(t.errorPrefix_+"has a key path longer than "+yl+" bytes ("+t.byteLength_+").");if(t.parts_.length>gl)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+gl+") or object contains a cycle "+hn(t))}function hn(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo extends wc{constructor(){super(["visible"]);let e,n;typeof document!="undefined"&&typeof document.addEventListener!="undefined"&&(typeof document.hidden!="undefined"?(n="visibilitychange",e="hidden"):typeof document.mozHidden!="undefined"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden!="undefined"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new wo}getInitialEvent(e){return x(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vr=1e3,Cy=60*5*1e3,vl=30*1e3,Iy=1.3,$y=3e4,Ty="server_kill",El=3;class Ft extends bc{constructor(e,n,r,s,i,o,a,u){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=u,this.id=Ft.nextPersistentConnectionId_++,this.log_=Qr("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=vr,this.maxReconnectDelay_=Cy,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!_u())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");wo.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Ds.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(Ve(i)),x(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new io,r={p:e._path.toString(),q:e._queryObject},s={action:"g",request:r,onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),x(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),x(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const u=a.d,l=a.s;Ft.warnOnListenWarnings_(u,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",a),l!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(l,u))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&xt(e,"w")){const r=Jn(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();nt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Ap(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=vl)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=Tp(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,o=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),x(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";s&&(i.q=r,i.t=s),this.sendRequest(o,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const o={p:n,d:r};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Ve(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Li("Unrecognized action received from server: "+Ve(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){x(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=vr,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=vr,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>$y&&(this.reconnectDelay_=vr),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Iy)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Ft.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const u=function(){a?a.close():(o=!0,r())},l=function(d){x(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:u,sendRequest:l};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,p]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);o?qe("getToken() completed but was canceled"):(qe("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=p&&p.token,a=new vy(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,E=>{nt(E+" ("+this.repoInfo_.toString()+")"),this.interrupt(Ty)},i))}catch(d){this.log_("Failed to get token: "+d),o||(this.repoInfo_.nodeAdmin&&nt(d),u())}}}interrupt(e){qe("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){qe("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Ri(this.interruptReasons_)&&(this.reconnectDelay_=vr,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>yo(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new Te(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){qe("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=El&&(this.reconnectDelay_=vl,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){qe("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=El&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+ec.replace(/\./g,"-")]=1,oo()?e["framework.cordova"]=1:mu()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Ds.getInstance().currentlyOnline();return Ri(this.interruptReasons_)&&e}}Ft.nextPersistentConnectionId_=0;Ft.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new pe(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new pe(Xn,e),s=new pe(Xn,n);return this.compare(r,s)!==0}minPost(){return pe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let us;class Ac extends Ys{static get __EMPTY_NODE(){return us}static set __EMPTY_NODE(e){us=e}compare(e,n){return sr(e.name,n.name)}isDefinedOn(e){throw nr("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return pe.MIN}maxPost(){return new pe(Cn,us)}makePost(e,n){return x(typeof e=="string","KeyIndex indexValue must always be a string."),new pe(e,us)}toString(){return".key"}}const Gn=new Ac;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Le{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r!=null?r:Le.RED,this.left=s!=null?s:et.EMPTY_NODE,this.right=i!=null?i:et.EMPTY_NODE}copy(e,n,r,s,i){return new Le(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,s!=null?s:this.left,i!=null?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return et.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return et.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Le.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Le.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Le.RED=!0;Le.BLACK=!1;class Ay{copy(e,n,r,s,i){return this}insert(e,n,r){return new Le(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class et{constructor(e,n=et.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new et(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Le.BLACK,null,null))}remove(e){return new et(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Le.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new cs(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new cs(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new cs(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new cs(this.root_,null,this.comparator_,!0,e)}}et.EMPTY_NODE=new Ay;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ry(t,e){return sr(t.name,e.name)}function So(t,e){return sr(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bi;function ky(t){Bi=t}const Rc=function(t){return typeof t=="number"?"number:"+ic(t):"string:"+t},kc=function(t){if(t.isLeafNode()){const e=t.val();x(typeof e=="string"||typeof e=="number"||typeof e=="object"&&xt(e,".sv"),"Priority must be a string or number.")}else x(t===Bi||t.isEmpty(),"priority of unexpected type.");x(t===Bi||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bl;class Fe{constructor(e,n=Fe.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,x(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),kc(this.priorityNode_)}static set __childrenNodeConstructor(e){bl=e}static get __childrenNodeConstructor(){return bl}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Fe(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Fe.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return de(e)?this:fe(e)===".priority"?this.priorityNode_:Fe.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Fe.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=fe(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(x(r!==".priority"||rn(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Fe.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ie(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Rc(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=ic(this.value_):e+=this.value_,this.lazyHash_=nc(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Fe.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Fe.__childrenNodeConstructor?-1:(x(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=Fe.VALUE_TYPE_ORDER.indexOf(n),i=Fe.VALUE_TYPE_ORDER.indexOf(r);return x(s>=0,"Unknown leaf type: "+n),x(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Fe.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nc,Dc;function Ny(t){Nc=t}function Dy(t){Dc=t}class Py extends Ys{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?sr(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return pe.MIN}maxPost(){return new pe(Cn,new Fe("[PRIORITY-POST]",Dc))}makePost(e,n){const r=Nc(e);return new pe(n,new Fe("[PRIORITY-POST]",r))}toString(){return".priority"}}const ze=new Py;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oy=Math.log(2);class My{constructor(e){const n=i=>parseInt(Math.log(i)/Oy,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Ps=function(t,e,n,r){t.sort(e);const s=function(u,l){const c=l-u;let d,p;if(c===0)return null;if(c===1)return d=t[u],p=n?n(d):d,new Le(p,d.node,Le.BLACK,null,null);{const E=parseInt(c/2,10)+u,v=s(u,E),C=s(E+1,l);return d=t[E],p=n?n(d):d,new Le(p,d.node,Le.BLACK,v,C)}},i=function(u){let l=null,c=null,d=t.length;const p=function(v,C){const S=d-v,g=d;d-=v;const T=s(S+1,g),A=t[S],O=n?n(A):A;E(new Le(O,A.node,C,null,T))},E=function(v){l?(l.left=v,l=v):(c=v,l=v)};for(let v=0;v<u.count;++v){const C=u.nextBitIsOne(),S=Math.pow(2,u.count-(v+1));C?p(S,Le.BLACK):(p(S,Le.BLACK),p(S,Le.RED))}return c},o=new My(t.length),a=i(o);return new et(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yi;const jn={};class Mt{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return x(jn&&ze,"ChildrenNode.ts has not been loaded"),yi=yi||new Mt({".priority":jn},{".priority":ze}),yi}get(e){const n=Jn(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof et?n:null}hasIndex(e){return xt(this.indexSet_,e.toString())}addIndex(e,n){x(e!==Gn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(pe.Wrap);let o=i.getNext();for(;o;)s=s||e.isDefinedOn(o.node),r.push(o),o=i.getNext();let a;s?a=Ps(r,e.getCompare()):a=jn;const u=e.toString(),l=Object.assign({},this.indexSet_);l[u]=e;const c=Object.assign({},this.indexes_);return c[u]=a,new Mt(c,l)}addToIndexes(e,n){const r=Cs(this.indexes_,(s,i)=>{const o=Jn(this.indexSet_,i);if(x(o,"Missing index implementation for "+i),s===jn)if(o.isDefinedOn(e.node)){const a=[],u=n.getIterator(pe.Wrap);let l=u.getNext();for(;l;)l.name!==e.name&&a.push(l),l=u.getNext();return a.push(e),Ps(a,o.getCompare())}else return jn;else{const a=n.get(e.name);let u=s;return a&&(u=u.remove(new pe(e.name,a))),u.insert(e,e.node)}});return new Mt(r,this.indexSet_)}removeFromIndexes(e,n){const r=Cs(this.indexes_,s=>{if(s===jn)return s;{const i=n.get(e.name);return i?s.remove(new pe(e.name,i)):s}});return new Mt(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Er;class ge{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&kc(this.priorityNode_),this.children_.isEmpty()&&x(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Er||(Er=new ge(new et(So),null,Mt.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Er}updatePriority(e){return this.children_.isEmpty()?this:new ge(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Er:n}}getChild(e){const n=fe(e);return n===null?this:this.getImmediateChild(n).getChild(Ie(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(x(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new pe(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const o=s.isEmpty()?Er:this.priorityNode_;return new ge(s,o,i)}}updateChild(e,n){const r=fe(e);if(r===null)return n;{x(fe(e)!==".priority"||rn(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Ie(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild(ze,(o,a)=>{n[o]=a.val(e),r++,i&&ge.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):i=!1}),!e&&i&&s<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Rc(this.getPriority().val())+":"),this.forEachChild(ze,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":nc(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new pe(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new pe(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new pe(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,pe.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,pe.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Zr?-1:0}withIndex(e){if(e===Gn||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new ge(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Gn||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(ze),s=n.getIterator(ze);let i=r.getNext(),o=s.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=s.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Gn?null:this.indexMap_.get(e.toString())}}ge.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Fy extends ge{constructor(){super(new et(So),ge.EMPTY_NODE,Mt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ge.EMPTY_NODE}isEmpty(){return!1}}const Zr=new Fy;Object.defineProperties(pe,{MIN:{value:new pe(Xn,ge.EMPTY_NODE)},MAX:{value:new pe(Cn,Zr)}});Ac.__EMPTY_NODE=ge.EMPTY_NODE;Fe.__childrenNodeConstructor=ge;ky(Zr);Dy(Zr);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ly=!0;function We(t,e=null){if(t===null)return ge.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),x(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Fe(n,We(e))}if(!(t instanceof Array)&&Ly){const n=[];let r=!1;if(lt(t,(o,a)=>{if(o.substring(0,1)!=="."){const u=We(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new pe(o,u)))}}),n.length===0)return ge.EMPTY_NODE;const i=Ps(n,Ry,o=>o.name,So);if(r){const o=Ps(n,ze.getCompare());return new ge(i,We(e),new Mt({".priority":o},{".priority":ze}))}else return new ge(i,We(e),Mt.Default)}else{let n=ge.EMPTY_NODE;return lt(t,(r,s)=>{if(xt(t,r)&&r.substring(0,1)!=="."){const i=We(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(We(e))}}Ny(We);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy extends Ys{constructor(e){super(),this.indexPath_=e,x(!de(e)&&fe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?sr(e.name,n.name):i}makePost(e,n){const r=We(e),s=ge.EMPTY_NODE.updateChild(this.indexPath_,r);return new pe(n,s)}maxPost(){const e=ge.EMPTY_NODE.updateChild(this.indexPath_,Zr);return new pe(Cn,e)}toString(){return Cc(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy extends Ys{compare(e,n){const r=e.node.compareTo(n.node);return r===0?sr(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return pe.MIN}maxPost(){return pe.MAX}makePost(e,n){const r=We(e);return new pe(n,r)}toString(){return".value"}}const By=new Uy;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xy(t){return{type:"value",snapshotNode:t}}function Vy(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Hy(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function wl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function qy(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ze}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return x(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return x(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Xn}hasEnd(){return this.endSet_}getIndexEndValue(){return x(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return x(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Cn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return x(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ze}copy(){const e=new Co;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Sl(t){const e={};if(t.isDefault())return e;let n;return t.index_===ze?n="$priority":t.index_===By?n="$value":t.index_===Gn?n="$key":(x(t.index_ instanceof jy,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Ve(n),t.startSet_&&(e.startAt=Ve(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+Ve(t.indexStartName_))),t.endSet_&&(e.endAt=Ve(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+Ve(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Cl(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==ze&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os extends bc{constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=Qr("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(x(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=Os.getListenId_(e,r),a={};this.listens_[o]=a;const u=Sl(e._queryParams);this.restRequest_(i+".json",u,(l,c)=>{let d=c;if(l===404&&(d=null,l=null),l===null&&this.onDataUpdate_(i,d,!1,r),Jn(this.listens_,o)===a){let p;l?l===401?p="permission_denied":p="rest_error:"+l:p="ok",s(p,null)}})}unlisten(e,n){const r=Os.getListenId_(e,n);delete this.listens_[r]}get(e){const n=Sl(e._queryParams),r=e._path.toString(),s=new io;return this.restRequest_(r+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(r,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+rr(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=Mr(a.responseText)}catch{nt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&nt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(){this.rootNode_=ge.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(){return{value:null,children:new Map}}function Pc(t,e,n){if(de(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=fe(e);t.children.has(r)||t.children.set(r,Ms());const s=t.children.get(r);e=Ie(e),Pc(s,e,n)}}function xi(t,e,n){t.value!==null?n(e,t.value):zy(t,(r,s)=>{const i=new Te(e.toString()+"/"+r);xi(s,i,n)})}function zy(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&lt(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Il=10*1e3,Gy=30*1e3,Yy=5*60*1e3;class Jy{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Ky(e);const r=Il+(Gy-Il)*Math.random();$r(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;lt(e,(s,i)=>{i>0&&xt(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),$r(this.reportStats_.bind(this),Math.floor(Math.random()*2*Yy))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(It||(It={}));function Oc(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Mc(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Fc(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=It.ACK_USER_WRITE,this.source=Oc()}operationForChild(e){if(de(this.path)){if(this.affectedTree.value!=null)return x(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Te(e));return new Fs(ve(),n,this.revert)}}else return x(fe(this.path)===e,"operationForChild called for unrelated child."),new Fs(Ie(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=It.OVERWRITE}operationForChild(e){return de(this.path)?new In(this.source,ve(),this.snap.getImmediateChild(e)):new In(this.source,Ie(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=It.MERGE}operationForChild(e){if(de(this.path)){const n=this.children.subtree(new Te(e));return n.isEmpty()?null:n.value?new In(this.source,ve(),n.value):new Br(this.source,ve(),n)}else return x(fe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Br(this.source,Ie(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(de(e))return this.isFullyInitialized()&&!this.filtered_;const n=fe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function Qy(t,e,n,r){const s=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(qy(o.childName,o.snapshotNode))}),br(t,s,"child_removed",e,r,n),br(t,s,"child_added",e,r,n),br(t,s,"child_moved",i,r,n),br(t,s,"child_changed",e,r,n),br(t,s,"value",e,r,n),s}function br(t,e,n,r,s,i){const o=r.filter(a=>a.type===n);o.sort((a,u)=>Zy(t,a,u)),o.forEach(a=>{const u=Xy(t,a,i);s.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(u,t.query_))})})}function Xy(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function Zy(t,e,n){if(e.childName==null||n.childName==null)throw nr("Should only compare child_ events.");const r=new pe(e.childName,e.snapshotNode),s=new pe(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lc(t,e){return{eventCache:t,serverCache:e}}function Tr(t,e,n,r){return Lc(new Io(e,n,r),t.serverCache)}function jc(t,e,n,r){return Lc(t.eventCache,new Io(e,n,r))}function Vi(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function $n(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vi;const ev=()=>(vi||(vi=new et(Ug)),vi);class Ce{constructor(e,n=ev()){this.value=e,this.children=n}static fromObject(e){let n=new Ce(null);return lt(e,(r,s)=>{n=n.set(new Te(r),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ve(),value:this.value};if(de(e))return null;{const r=fe(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(Ie(e),n);return i!=null?{path:je(new Te(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(de(e))return this;{const n=fe(e),r=this.children.get(n);return r!==null?r.subtree(Ie(e)):new Ce(null)}}set(e,n){if(de(e))return new Ce(n,this.children);{const r=fe(e),i=(this.children.get(r)||new Ce(null)).set(Ie(e),n),o=this.children.insert(r,i);return new Ce(this.value,o)}}remove(e){if(de(e))return this.children.isEmpty()?new Ce(null):new Ce(null,this.children);{const n=fe(e),r=this.children.get(n);if(r){const s=r.remove(Ie(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new Ce(null):new Ce(this.value,i)}else return this}}get(e){if(de(e))return this.value;{const n=fe(e),r=this.children.get(n);return r?r.get(Ie(e)):null}}setTree(e,n){if(de(e))return n;{const r=fe(e),i=(this.children.get(r)||new Ce(null)).setTree(Ie(e),n);let o;return i.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,i),new Ce(this.value,o)}}fold(e){return this.fold_(ve(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(je(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ve(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(de(e))return null;{const i=fe(e),o=this.children.get(i);return o?o.findOnPath_(Ie(e),je(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ve(),n)}foreachOnPath_(e,n,r){if(de(e))return this;{this.value&&r(n,this.value);const s=fe(e),i=this.children.get(s);return i?i.foreachOnPath_(Ie(e),je(n,s),r):new Ce(null)}}foreach(e){this.foreach_(ve(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(je(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.writeTree_=e}static empty(){return new mt(new Ce(null))}}function Ar(t,e,n){if(de(e))return new mt(new Ce(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const o=at(s,e);return i=i.updateChild(o,n),new mt(t.writeTree_.set(s,i))}else{const s=new Ce(n),i=t.writeTree_.setTree(e,s);return new mt(i)}}}function $l(t,e,n){let r=t;return lt(n,(s,i)=>{r=Ar(r,je(e,s),i)}),r}function Tl(t,e){if(de(e))return mt.empty();{const n=t.writeTree_.setTree(e,new Ce(null));return new mt(n)}}function Hi(t,e){return Rn(t,e)!=null}function Rn(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(at(n.path,e)):null}function Al(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(ze,(r,s)=>{e.push(new pe(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new pe(r,s.value))}),e}function en(t,e){if(de(e))return t;{const n=Rn(t,e);return n!=null?new mt(new Ce(n)):new mt(t.writeTree_.subtree(e))}}function qi(t){return t.writeTree_.isEmpty()}function Zn(t,e){return Uc(ve(),t.writeTree_,e)}function Uc(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(x(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=Uc(je(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(je(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(t,e){return Wc(e,t)}function tv(t,e,n,r,s){x(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=Ar(t.visibleWrites,e,n)),t.lastWriteId=r}function nv(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function rv(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);x(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,o=t.allWrites.length-1;for(;s&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&sv(a,r.path)?s=!1:pt(r.path,a.path)&&(i=!0)),o--}if(s){if(i)return iv(t),!0;if(r.snap)t.visibleWrites=Tl(t.visibleWrites,r.path);else{const a=r.children;lt(a,u=>{t.visibleWrites=Tl(t.visibleWrites,je(r.path,u))})}return!0}else return!1}function sv(t,e){if(t.snap)return pt(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&pt(je(t.path,n),e))return!0;return!1}function iv(t){t.visibleWrites=xc(t.allWrites,ov,ve()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function ov(t){return t.visible}function xc(t,e,n){let r=mt.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const o=i.path;let a;if(i.snap)pt(n,o)?(a=at(n,o),r=Ar(r,a,i.snap)):pt(o,n)&&(a=at(o,n),r=Ar(r,ve(),i.snap.getChild(a)));else if(i.children){if(pt(n,o))a=at(n,o),r=$l(r,a,i.children);else if(pt(o,n))if(a=at(o,n),de(a))r=$l(r,ve(),i.children);else{const u=Jn(i.children,fe(a));if(u){const l=u.getChild(Ie(a));r=Ar(r,ve(),l)}}}else throw nr("WriteRecord should have .snap or .children")}}return r}function Vc(t,e,n,r,s){if(!r&&!s){const i=Rn(t.visibleWrites,e);if(i!=null)return i;{const o=en(t.visibleWrites,e);if(qi(o))return n;if(n==null&&!Hi(o,ve()))return null;{const a=n||ge.EMPTY_NODE;return Zn(o,a)}}}else{const i=en(t.visibleWrites,e);if(!s&&qi(i))return n;if(!s&&n==null&&!Hi(i,ve()))return null;{const o=function(l){return(l.visible||s)&&(!r||!~r.indexOf(l.writeId))&&(pt(l.path,e)||pt(e,l.path))},a=xc(t.allWrites,o,e),u=n||ge.EMPTY_NODE;return Zn(a,u)}}}function av(t,e,n){let r=ge.EMPTY_NODE;const s=Rn(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(ze,(i,o)=>{r=r.updateImmediateChild(i,o)}),r;if(n){const i=en(t.visibleWrites,e);return n.forEachChild(ze,(o,a)=>{const u=Zn(en(i,new Te(o)),a);r=r.updateImmediateChild(o,u)}),Al(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const i=en(t.visibleWrites,e);return Al(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function lv(t,e,n,r,s){x(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=je(e,n);if(Hi(t.visibleWrites,i))return null;{const o=en(t.visibleWrites,i);return qi(o)?s.getChild(n):Zn(o,s.getChild(n))}}function uv(t,e,n,r){const s=je(e,n),i=Rn(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const o=en(t.visibleWrites,s);return Zn(o,r.getNode().getImmediateChild(n))}else return null}function cv(t,e){return Rn(t.visibleWrites,e)}function dv(t,e,n,r,s,i,o){let a;const u=en(t.visibleWrites,e),l=Rn(u,ve());if(l!=null)a=l;else if(n!=null)a=Zn(u,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const c=[],d=o.getCompare(),p=i?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let E=p.getNext();for(;E&&c.length<s;)d(E,r)!==0&&c.push(E),E=p.getNext();return c}else return[]}function hv(){return{visibleWrites:mt.empty(),allWrites:[],lastWriteId:-1}}function Wi(t,e,n,r){return Vc(t.writeTree,t.treePath,e,n,r)}function Hc(t,e){return av(t.writeTree,t.treePath,e)}function Rl(t,e,n,r){return lv(t.writeTree,t.treePath,e,n,r)}function Ls(t,e){return cv(t.writeTree,je(t.treePath,e))}function fv(t,e,n,r,s,i){return dv(t.writeTree,t.treePath,e,n,r,s,i)}function $o(t,e,n){return uv(t.writeTree,t.treePath,e,n)}function qc(t,e){return Wc(je(t.treePath,e),t.writeTree)}function Wc(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;x(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),x(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,wl(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,Hy(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,Vy(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,wl(r,e.snapshotNode,s.oldSnap));else throw nr("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const zc=new mv;class To{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Io(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return $o(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:$n(this.viewCache_),i=fv(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}function _v(t,e){x(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),x(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function gv(t,e,n,r,s){const i=new pv;let o,a;if(n.type===It.OVERWRITE){const l=n;l.source.fromUser?o=zi(t,e,l.path,l.snap,r,s,i):(x(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!de(l.path),o=js(t,e,l.path,l.snap,r,s,a,i))}else if(n.type===It.MERGE){const l=n;l.source.fromUser?o=vv(t,e,l.path,l.children,r,s,i):(x(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=Ki(t,e,l.path,l.children,r,s,a,i))}else if(n.type===It.ACK_USER_WRITE){const l=n;l.revert?o=wv(t,e,l.path,r,s,i):o=Ev(t,e,l.path,l.affectedTree,r,s,i)}else if(n.type===It.LISTEN_COMPLETE)o=bv(t,e,n.path,r,i);else throw nr("Unknown operation type: "+n.type);const u=i.getChanges();return yv(e,o,u),{viewCache:o,changes:u}}function yv(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=Vi(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(xy(Vi(e)))}}function Kc(t,e,n,r,s,i){const o=e.eventCache;if(Ls(r,n)!=null)return e;{let a,u;if(de(n))if(x(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=$n(e),c=l instanceof ge?l:ge.EMPTY_NODE,d=Hc(r,c);a=t.filter.updateFullNode(e.eventCache.getNode(),d,i)}else{const l=Wi(r,$n(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,i)}else{const l=fe(n);if(l===".priority"){x(rn(n)===1,"Can't have a priority with additional path components");const c=o.getNode();u=e.serverCache.getNode();const d=Rl(r,n,c,u);d!=null?a=t.filter.updatePriority(c,d):a=o.getNode()}else{const c=Ie(n);let d;if(o.isCompleteForChild(l)){u=e.serverCache.getNode();const p=Rl(r,n,o.getNode(),u);p!=null?d=o.getNode().getImmediateChild(l).updateChild(c,p):d=o.getNode().getImmediateChild(l)}else d=$o(r,l,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),l,d,c,s,i):a=o.getNode()}}return Tr(e,a,o.isFullyInitialized()||de(n),t.filter.filtersNodes())}}function js(t,e,n,r,s,i,o,a){const u=e.serverCache;let l;const c=o?t.filter:t.filter.getIndexedFilter();if(de(n))l=c.updateFullNode(u.getNode(),r,null);else if(c.filtersNodes()&&!u.isFiltered()){const E=u.getNode().updateChild(n,r);l=c.updateFullNode(u.getNode(),E,null)}else{const E=fe(n);if(!u.isCompleteForPath(n)&&rn(n)>1)return e;const v=Ie(n),S=u.getNode().getImmediateChild(E).updateChild(v,r);E===".priority"?l=c.updatePriority(u.getNode(),S):l=c.updateChild(u.getNode(),E,S,v,zc,null)}const d=jc(e,l,u.isFullyInitialized()||de(n),c.filtersNodes()),p=new To(s,d,i);return Kc(t,d,n,s,p,a)}function zi(t,e,n,r,s,i,o){const a=e.eventCache;let u,l;const c=new To(s,e,i);if(de(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=Tr(e,l,!0,t.filter.filtersNodes());else{const d=fe(n);if(d===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),r),u=Tr(e,l,a.isFullyInitialized(),a.isFiltered());else{const p=Ie(n),E=a.getNode().getImmediateChild(d);let v;if(de(p))v=r;else{const C=c.getCompleteChild(d);C!=null?Sc(p)===".priority"&&C.getChild(Ic(p)).isEmpty()?v=C:v=C.updateChild(p,r):v=ge.EMPTY_NODE}if(E.equals(v))u=e;else{const C=t.filter.updateChild(a.getNode(),d,v,p,c,o);u=Tr(e,C,a.isFullyInitialized(),t.filter.filtersNodes())}}}return u}function kl(t,e){return t.eventCache.isCompleteForChild(e)}function vv(t,e,n,r,s,i,o){let a=e;return r.foreach((u,l)=>{const c=je(n,u);kl(e,fe(c))&&(a=zi(t,a,c,l,s,i,o))}),r.foreach((u,l)=>{const c=je(n,u);kl(e,fe(c))||(a=zi(t,a,c,l,s,i,o))}),a}function Nl(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function Ki(t,e,n,r,s,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,l;de(n)?l=r:l=new Ce(null).setTree(n,r);const c=e.serverCache.getNode();return l.children.inorderTraversal((d,p)=>{if(c.hasChild(d)){const E=e.serverCache.getNode().getImmediateChild(d),v=Nl(t,E,p);u=js(t,u,new Te(d),v,s,i,o,a)}}),l.children.inorderTraversal((d,p)=>{const E=!e.serverCache.isCompleteForChild(d)&&p.value===null;if(!c.hasChild(d)&&!E){const v=e.serverCache.getNode().getImmediateChild(d),C=Nl(t,v,p);u=js(t,u,new Te(d),C,s,i,o,a)}}),u}function Ev(t,e,n,r,s,i,o){if(Ls(s,n)!=null)return e;const a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(de(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return js(t,e,n,u.getNode().getChild(n),s,i,a,o);if(de(n)){let l=new Ce(null);return u.getNode().forEachChild(Gn,(c,d)=>{l=l.set(new Te(c),d)}),Ki(t,e,n,l,s,i,a,o)}else return e}else{let l=new Ce(null);return r.foreach((c,d)=>{const p=je(n,c);u.isCompleteForPath(p)&&(l=l.set(c,u.getNode().getChild(p)))}),Ki(t,e,n,l,s,i,a,o)}}function bv(t,e,n,r,s){const i=e.serverCache,o=jc(e,i.getNode(),i.isFullyInitialized()||de(n),i.isFiltered());return Kc(t,o,n,r,zc,s)}function wv(t,e,n,r,s,i){let o;if(Ls(r,n)!=null)return e;{const a=new To(r,e,s),u=e.eventCache.getNode();let l;if(de(n)||fe(n)===".priority"){let c;if(e.serverCache.isFullyInitialized())c=Wi(r,$n(e));else{const d=e.serverCache.getNode();x(d instanceof ge,"serverChildren would be complete if leaf node"),c=Hc(r,d)}c=c,l=t.filter.updateFullNode(u,c,i)}else{const c=fe(n);let d=$o(r,c,e.serverCache);d==null&&e.serverCache.isCompleteForChild(c)&&(d=u.getImmediateChild(c)),d!=null?l=t.filter.updateChild(u,c,d,Ie(n),a,i):e.eventCache.getNode().hasChild(c)?l=t.filter.updateChild(u,c,ge.EMPTY_NODE,Ie(n),a,i):l=u,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Wi(r,$n(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,i)))}return o=e.serverCache.isFullyInitialized()||Ls(r,ve())!=null,Tr(e,l,o,t.filter.filtersNodes())}}function Sv(t,e){const n=$n(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!de(e)&&!n.getImmediateChild(fe(e)).isEmpty())?n.getChild(e):null}function Dl(t,e,n,r){e.type===It.MERGE&&e.source.queryId!==null&&(x($n(t.viewCache_),"We should always have a full cache before handling merges"),x(Vi(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=gv(t.processor_,s,e,n,r);return _v(t.processor_,i.viewCache),x(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,Cv(t,i.changes,i.viewCache.eventCache.getNode(),null)}function Cv(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return Qy(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pl;function Iv(t){x(!Pl,"__referenceConstructor has already been defined"),Pl=t}function Ao(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return x(i!=null,"SyncTree gave us an op for an invalid query."),Dl(i,e,n,r)}else{let i=[];for(const o of t.views.values())i=i.concat(Dl(o,e,n,r));return i}}function Ro(t,e){let n=null;for(const r of t.views.values())n=n||Sv(r,e);return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ol;function $v(t){x(!Ol,"__referenceConstructor has already been defined"),Ol=t}class Ml{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ce(null),this.pendingWriteTree_=hv(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Tv(t,e,n,r,s){return tv(t.pendingWriteTree_,e,n,r,s),s?Qs(t,new In(Oc(),e,n)):[]}function qn(t,e,n=!1){const r=nv(t.pendingWriteTree_,e);if(rv(t.pendingWriteTree_,e)){let i=new Ce(null);return r.snap!=null?i=i.set(ve(),!0):lt(r.children,o=>{i=i.set(new Te(o),!0)}),Qs(t,new Fs(r.path,i,n))}else return[]}function Js(t,e,n){return Qs(t,new In(Mc(),e,n))}function Av(t,e,n){const r=Ce.fromObject(n);return Qs(t,new Br(Mc(),e,r))}function Rv(t,e,n,r){const s=Qc(t,r);if(s!=null){const i=Xc(s),o=i.path,a=i.queryId,u=at(o,e),l=new In(Fc(a),u,n);return Zc(t,o,l)}else return[]}function kv(t,e,n,r){const s=Qc(t,r);if(s){const i=Xc(s),o=i.path,a=i.queryId,u=at(o,e),l=Ce.fromObject(n),c=new Br(Fc(a),u,l);return Zc(t,o,c)}else return[]}function Gc(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const u=at(o,e),l=Ro(a,u);if(l)return l});return Vc(s,e,i,n,!0)}function Qs(t,e){return Yc(e,t.syncPointTree_,null,Bc(t.pendingWriteTree_,ve()))}function Yc(t,e,n,r){if(de(t.path))return Jc(t,e,n,r);{const s=e.get(ve());n==null&&s!=null&&(n=Ro(s,ve()));let i=[];const o=fe(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){const l=n?n.getImmediateChild(o):null,c=qc(r,o);i=i.concat(Yc(a,u,l,c))}return s&&(i=i.concat(Ao(s,t,r,n))),i}}function Jc(t,e,n,r){const s=e.get(ve());n==null&&s!=null&&(n=Ro(s,ve()));let i=[];return e.children.inorderTraversal((o,a)=>{const u=n?n.getImmediateChild(o):null,l=qc(r,o),c=t.operationForChild(o);c&&(i=i.concat(Jc(c,a,u,l)))}),s&&(i=i.concat(Ao(s,t,r,n))),i}function Qc(t,e){return t.tagToQueryMap.get(e)}function Xc(t){const e=t.indexOf("$");return x(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Te(t.substr(0,e))}}function Zc(t,e,n){const r=t.syncPointTree_.get(e);x(r,"Missing sync point for query tag that we're tracking");const s=Bc(t.pendingWriteTree_,e);return Ao(r,n,s,null)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new ko(n)}node(){return this.node_}}class No{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=je(this.path_,e);return new No(this.syncTree_,n)}node(){return Gc(this.syncTree_,this.path_)}}const Nv=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Fl=function(t,e,n){if(!t||typeof t!="object")return t;if(x(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Dv(t[".sv"],e,n);if(typeof t[".sv"]=="object")return Pv(t[".sv"],e);x(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Dv=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:x(!1,"Unexpected server value: "+t)}},Pv=function(t,e,n){t.hasOwnProperty("increment")||x(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&x(!1,"Unexpected increment value: "+r);const s=e.node();if(x(s!==null&&typeof s!="undefined","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const o=s.getValue();return typeof o!="number"?r:o+r},Ov=function(t,e,n,r){return Do(e,new No(n,t),r)},Mv=function(t,e,n){return Do(t,new ko(e),n)};function Do(t,e,n){const r=t.getPriority().val(),s=Fl(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=Fl(o.getValue(),e,n);return a!==o.getValue()||s!==o.getPriority().val()?new Fe(a,We(s)):t}else{const o=t;return i=o,s!==o.getPriority().val()&&(i=i.updatePriority(new Fe(s))),o.forEachChild(ze,(a,u)=>{const l=Do(u,e.getImmediateChild(a),n);l!==u&&(i=i.updateImmediateChild(a,l))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function Oo(t,e){let n=e instanceof Te?e:new Te(e),r=t,s=fe(n);for(;s!==null;){const i=Jn(r.node.children,s)||{children:{},childCount:0};r=new Po(s,r,i),n=Ie(n),s=fe(n)}return r}function ir(t){return t.node.value}function ed(t,e){t.node.value=e,Gi(t)}function td(t){return t.node.childCount>0}function Fv(t){return ir(t)===void 0&&!td(t)}function Xs(t,e){lt(t.node.children,(n,r)=>{e(new Po(n,t,r))})}function nd(t,e,n,r){n&&!r&&e(t),Xs(t,s=>{nd(s,e,!0,r)}),n&&r&&e(t)}function Lv(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function es(t){return new Te(t.parent===null?t.name:es(t.parent)+"/"+t.name)}function Gi(t){t.parent!==null&&jv(t.parent,t.name,t)}function jv(t,e,n){const r=Fv(n),s=xt(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,Gi(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,Gi(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uv=/[\[\].#$\/\u0000-\u001F\u007F]/,Bv=/[\[\].#$\u0000-\u001F\u007F]/,Ei=10*1024*1024,rd=function(t){return typeof t=="string"&&t.length!==0&&!Uv.test(t)},xv=function(t){return typeof t=="string"&&t.length!==0&&!Bv.test(t)},Vv=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),xv(t)},sd=function(t,e,n){const r=n instanceof Te?new by(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+hn(r));if(typeof e=="function")throw new Error(t+"contains a function "+hn(r)+" with contents = "+e.toString());if(rc(e))throw new Error(t+"contains "+e.toString()+" "+hn(r));if(typeof e=="string"&&e.length>Ei/3&&qs(e)>Ei)throw new Error(t+"contains a string greater than "+Ei+" utf8 bytes "+hn(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(lt(e,(o,a)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!rd(o)))throw new Error(t+" contains an invalid key ("+o+") "+hn(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);wy(r,o),sd(t,a,r),Sy(r)}),s&&i)throw new Error(t+' contains ".value" child '+hn(r)+" in addition to actual children.")}},Hv=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!rd(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!Vv(n))throw new Error(Pp(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Wv(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!$c(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function kn(t,e,n){Wv(t,n),zv(t,r=>pt(r,e)||pt(e,r))}function zv(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(Kv(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Kv(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();yn&&qe("event: "+n.toString()),Xr(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="repo_interrupt",Yv=25;class Jv{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new qv,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ms(),this.transactionQueueTree_=new Po,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Qv(t,e,n){if(t.stats_=Eo(t.repoInfo_),t.forceRestClient_||Wg())t.server_=new Os(t.repoInfo_,(r,s,i,o)=>{Ll(t,r,s,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>jl(t,!0),0);else{if(typeof n!="undefined"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ve(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Ft(t.repoInfo_,e,(r,s,i,o)=>{Ll(t,r,s,i,o)},r=>{jl(t,r)},r=>{Zv(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=Qg(t.repoInfo_,()=>new Jy(t.stats_,t.server_)),t.infoData_=new Wy,t.infoSyncTree_=new Ml({startListening:(r,s,i,o)=>{let a=[];const u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=Js(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Mo(t,"connected",!1),t.serverSyncTree_=new Ml({startListening:(r,s,i,o)=>(t.server_.listen(r,i,s,(a,u)=>{const l=o(a,u);kn(t.eventQueue_,r._path,l)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function Xv(t){const n=t.infoData_.getNode(new Te(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function id(t){return Nv({timestamp:Xv(t)})}function Ll(t,e,n,r,s){t.dataUpdateCount++;const i=new Te(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(r){const u=Cs(n,l=>We(l));o=kv(t.serverSyncTree_,i,u,s)}else{const u=We(n);o=Rv(t.serverSyncTree_,i,u,s)}else if(r){const u=Cs(n,l=>We(l));o=Av(t.serverSyncTree_,i,u)}else{const u=We(n);o=Js(t.serverSyncTree_,i,u)}let a=i;o.length>0&&(a=Lo(t,i)),kn(t.eventQueue_,a,o)}function jl(t,e){Mo(t,"connected",e),e===!1&&t0(t)}function Zv(t,e){lt(e,(n,r)=>{Mo(t,n,r)})}function Mo(t,e,n){const r=new Te("/.info/"+e),s=We(n);t.infoData_.updateSnapshot(r,s);const i=Js(t.infoSyncTree_,r,s);kn(t.eventQueue_,r,i)}function e0(t){return t.nextWriteId_++}function t0(t){od(t,"onDisconnectEvents");const e=id(t),n=Ms();xi(t.onDisconnect_,ve(),(s,i)=>{const o=Ov(s,i,t.serverSyncTree_,e);Pc(n,s,o)});let r=[];xi(n,ve(),(s,i)=>{r=r.concat(Js(t.serverSyncTree_,s,i));const o=i0(t,s);Lo(t,o)}),t.onDisconnect_=Ms(),kn(t.eventQueue_,ve(),r)}function n0(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Gv)}function od(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),qe(n,...e)}function ad(t,e,n){return Gc(t.serverSyncTree_,e,n)||ge.EMPTY_NODE}function Fo(t,e=t.transactionQueueTree_){if(e||Zs(t,e),ir(e)){const n=ud(t,e);x(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&r0(t,es(e),n)}else td(e)&&Xs(e,n=>{Fo(t,n)})}function r0(t,e,n){const r=n.map(l=>l.currentWriteId),s=ad(t,e,r);let i=s;const o=s.hash();for(let l=0;l<n.length;l++){const c=n[l];x(c.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;const d=at(e,c.path);i=i.updateChild(d,c.currentOutputSnapshotRaw)}const a=i.val(!0),u=e;t.server_.put(u.toString(),a,l=>{od(t,"transaction put response",{path:u.toString(),status:l});let c=[];if(l==="ok"){const d=[];for(let p=0;p<n.length;p++)n[p].status=2,c=c.concat(qn(t.serverSyncTree_,n[p].currentWriteId)),n[p].onComplete&&d.push(()=>n[p].onComplete(null,!0,n[p].currentOutputSnapshotResolved)),n[p].unwatcher();Zs(t,Oo(t.transactionQueueTree_,e)),Fo(t,t.transactionQueueTree_),kn(t.eventQueue_,e,c);for(let p=0;p<d.length;p++)Xr(d[p])}else{if(l==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{nt("transaction at "+u.toString()+" failed: "+l);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=l}Lo(t,e)}},o)}function Lo(t,e){const n=ld(t,e),r=es(n),s=ud(t,n);return s0(t,s,r),r}function s0(t,e,n){if(e.length===0)return;const r=[];let s=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const u=e[a],l=at(n,u.path);let c=!1,d;if(x(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)c=!0,d=u.abortReason,s=s.concat(qn(t.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=Yv)c=!0,d="maxretry",s=s.concat(qn(t.serverSyncTree_,u.currentWriteId,!0));else{const p=ad(t,u.path,o);u.currentInputSnapshot=p;const E=e[a].update(p.val());if(E!==void 0){sd("transaction failed: Data returned ",E,u.path);let v=We(E);typeof E=="object"&&E!=null&&xt(E,".priority")||(v=v.updatePriority(p.getPriority()));const S=u.currentWriteId,g=id(t),T=Mv(v,p,g);u.currentOutputSnapshotRaw=v,u.currentOutputSnapshotResolved=T,u.currentWriteId=e0(t),o.splice(o.indexOf(S),1),s=s.concat(Tv(t.serverSyncTree_,u.path,T,u.currentWriteId,u.applyLocally)),s=s.concat(qn(t.serverSyncTree_,S,!0))}else c=!0,d="nodata",s=s.concat(qn(t.serverSyncTree_,u.currentWriteId,!0))}kn(t.eventQueue_,n,s),s=[],c&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}Zs(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Xr(r[a]);Fo(t,t.transactionQueueTree_)}function ld(t,e){let n,r=t.transactionQueueTree_;for(n=fe(e);n!==null&&ir(r)===void 0;)r=Oo(r,n),e=Ie(e),n=fe(e);return r}function ud(t,e){const n=[];return cd(t,e,n),n.sort((r,s)=>r.order-s.order),n}function cd(t,e,n){const r=ir(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);Xs(e,s=>{cd(t,s,n)})}function Zs(t,e){const n=ir(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,ed(e,n.length>0?n:void 0)}Xs(e,r=>{Zs(t,r)})}function i0(t,e){const n=es(ld(t,e)),r=Oo(t.transactionQueueTree_,e);return Lv(r,s=>{bi(t,s)}),bi(t,r),nd(r,s=>{bi(t,s)}),n}function bi(t,e){const n=ir(e);if(n){const r=[];let s=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(x(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(x(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(qn(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?ed(e,void 0):n.length=i+1,kn(t.eventQueue_,es(e),s);for(let o=0;o<r.length;o++)Xr(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function a0(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):nt(`Invalid query segment '${n}' in query '${t}'`)}return e}const Ul=function(t,e){const n=l0(t),r=n.namespace;n.domain==="firebase.com"&&Sn(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Sn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||Lg();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Gg(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new Te(n.pathString)}},l0=function(t){let e="",n="",r="",s="",i="",o=!0,a="https",u=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let c=t.indexOf("/");c===-1&&(c=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(c,d)),c<d&&(s=o0(t.substring(c,d)));const p=a0(t.substring(Math.min(t.length,d)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(l+1),10)):l=e.length;const E=e.slice(0,l);if(E.toLowerCase()==="localhost")n="localhost";else if(E.split(".").length<=2)n=E;else{const v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),i=r}"ns"in p&&(i=p.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return de(this._path)?null:Sc(this._path)}get ref(){return new or(this._repo,this._path)}get _queryIdentifier(){const e=Cl(this._queryParams),n=yo(e);return n==="{}"?"default":n}get _queryObject(){return Cl(this._queryParams)}isEqual(e){if(e=Wr(e),!(e instanceof jo))return!1;const n=this._repo===e._repo,r=$c(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+Ey(this._path)}}class or extends jo{constructor(e,n){super(e,n,new Co,!1)}get parent(){const e=Ic(this._path);return e===null?null:new or(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}Iv(or);$v(or);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0="FIREBASE_DATABASE_EMULATOR_HOST",Yi={};let c0=!1;function d0(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||Sn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),qe("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Ul(i,s),a=o.repoInfo,u,l;typeof process!="undefined"&&process.env&&(l=process.env[u0]),l?(u=!0,i=`http://${l}?ns=${a.namespace}`,o=Ul(i,s),a=o.repoInfo):u=!o.repoInfo.secure;const c=s&&u?new ji(ji.OWNER):new Kg(t.name,t.options,e);Hv("Invalid Firebase Database URL",o),de(o.path)||Sn("Database URL must point to the root of a Firebase Database (not including a child path).");const d=f0(a,t,c,new zg(t.name,n));return new p0(d,t)}function h0(t,e){const n=Yi[e];(!n||n[t.key]!==t)&&Sn(`Database ${e}(${t.repoInfo_}) has already been deleted.`),n0(t),delete n[t.key]}function f0(t,e,n,r){let s=Yi[e.name];s||(s={},Yi[e.name]=s);let i=s[t.toURLString()];return i&&Sn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new Jv(t,c0,n,r),s[t.toURLString()]=i,i}class p0{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Qv(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new or(this._repo,ve())),this._rootInternal}_delete(){return this._rootInternal!==null&&(h0(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Sn("Cannot call "+e+" on a deleted database.")}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(t){Dg(zr),Qn(new vn("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return d0(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),Zt(ol,al,t),Zt(ol,al,"esm2017")}Ft.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Ft.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};m0();var Ji={exports:{}},dd={},_t={},er={},ts={},le={},xr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class e{}t._CodeOrName=e,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends e{constructor(T){if(super(),!t.IDENTIFIER.test(T))throw new Error("CodeGen: name must be a valid identifier");this.str=T}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=n;class r extends e{constructor(T){super(),this._items=typeof T=="string"?[T]:T}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const T=this._items[0];return T===""||T==='""'}get str(){var T;return(T=this._str)!==null&&T!==void 0?T:this._str=this._items.reduce((A,O)=>`${A}${O}`,"")}get names(){var T;return(T=this._names)!==null&&T!==void 0?T:this._names=this._items.reduce((A,O)=>(O instanceof n&&(A[O.str]=(A[O.str]||0)+1),A),{})}}t._Code=r,t.nil=new r("");function s(g,...T){const A=[g[0]];let O=0;for(;O<T.length;)a(A,T[O]),A.push(g[++O]);return new r(A)}t._=s;const i=new r("+");function o(g,...T){const A=[E(g[0])];let O=0;for(;O<T.length;)A.push(i),a(A,T[O]),A.push(i,E(g[++O]));return u(A),new r(A)}t.str=o;function a(g,T){T instanceof r?g.push(...T._items):T instanceof n?g.push(T):g.push(d(T))}t.addCodeArg=a;function u(g){let T=1;for(;T<g.length-1;){if(g[T]===i){const A=l(g[T-1],g[T+1]);if(A!==void 0){g.splice(T-1,3,A);continue}g[T++]="+"}T++}}function l(g,T){if(T==='""')return g;if(g==='""')return T;if(typeof g=="string")return T instanceof n||g[g.length-1]!=='"'?void 0:typeof T!="string"?`${g.slice(0,-1)}${T}"`:T[0]==='"'?g.slice(0,-1)+T.slice(1):void 0;if(typeof T=="string"&&T[0]==='"'&&!(g instanceof n))return`"${g}${T.slice(1)}`}function c(g,T){return T.emptyStr()?g:g.emptyStr()?T:o`${g}${T}`}t.strConcat=c;function d(g){return typeof g=="number"||typeof g=="boolean"||g===null?g:E(Array.isArray(g)?g.join(","):g)}function p(g){return new r(E(g))}t.stringify=p;function E(g){return JSON.stringify(g).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.safeStringify=E;function v(g){return typeof g=="string"&&t.IDENTIFIER.test(g)?new r(`.${g}`):s`[${g}]`}t.getProperty=v;function C(g){if(typeof g=="string"&&t.IDENTIFIER.test(g))return new r(`${g}`);throw new Error(`CodeGen: invalid export name: ${g}, use explicit $id name mapping`)}t.getEsmExportName=C;function S(g){return new r(g.toString())}t.regexpCode=S})(xr);var Qi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const e=xr;class n extends Error{constructor(l){super(`CodeGen: "code" for ${l} not defined`),this.value=l.value}}var r;(function(u){u[u.Started=0]="Started",u[u.Completed=1]="Completed"})(r=t.UsedValueState||(t.UsedValueState={})),t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};class s{constructor({prefixes:l,parent:c}={}){this._names={},this._prefixes=l,this._parent=c}toName(l){return l instanceof e.Name?l:this.name(l)}name(l){return new e.Name(this._newName(l))}_newName(l){const c=this._names[l]||this._nameGroup(l);return`${l}${c.index++}`}_nameGroup(l){var c,d;if(((d=(c=this._parent)===null||c===void 0?void 0:c._prefixes)===null||d===void 0?void 0:d.has(l))||this._prefixes&&!this._prefixes.has(l))throw new Error(`CodeGen: prefix "${l}" is not allowed in this scope`);return this._names[l]={prefix:l,index:0}}}t.Scope=s;class i extends e.Name{constructor(l,c){super(c),this.prefix=l}setValue(l,{property:c,itemIndex:d}){this.value=l,this.scopePath=(0,e._)`.${new e.Name(c)}[${d}]`}}t.ValueScopeName=i;const o=(0,e._)`\n`;class a extends s{constructor(l){super(l),this._values={},this._scope=l.scope,this.opts=Nt(Ue({},l),{_n:l.lines?o:e.nil})}get(){return this._scope}name(l){return new i(l,this._newName(l))}value(l,c){var d;if(c.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const p=this.toName(l),{prefix:E}=p,v=(d=c.key)!==null&&d!==void 0?d:c.ref;let C=this._values[E];if(C){const T=C.get(v);if(T)return T}else C=this._values[E]=new Map;C.set(v,p);const S=this._scope[E]||(this._scope[E]=[]),g=S.length;return S[g]=c.ref,p.setValue(c,{property:E,itemIndex:g}),p}getValue(l,c){const d=this._values[l];if(!!d)return d.get(c)}scopeRefs(l,c=this._values){return this._reduceValues(c,d=>{if(d.scopePath===void 0)throw new Error(`CodeGen: name "${d}" has no value`);return(0,e._)`${l}${d.scopePath}`})}scopeCode(l=this._values,c,d){return this._reduceValues(l,p=>{if(p.value===void 0)throw new Error(`CodeGen: name "${p}" has no value`);return p.value.code},c,d)}_reduceValues(l,c,d={},p){let E=e.nil;for(const v in l){const C=l[v];if(!C)continue;const S=d[v]=d[v]||new Map;C.forEach(g=>{if(S.has(g))return;S.set(g,r.Started);let T=c(g);if(T){const A=this.opts.es5?t.varKinds.var:t.varKinds.const;E=(0,e._)`${E}${A} ${g} = ${T};${this.opts._n}`}else if(T=p==null?void 0:p(g))E=(0,e._)`${E}${T}${this.opts._n}`;else throw new n(g);S.set(g,r.Completed)})}return E}}t.ValueScope=a})(Qi);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const e=xr,n=Qi;var r=xr;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return r.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return r.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return r.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}});var s=Qi;Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return s.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return s.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return s.varKinds}}),t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};class i{optimizeNodes(){return this}optimizeNames(h,m){return this}}class o extends i{constructor(h,m,D){super(),this.varKind=h,this.name=m,this.rhs=D}render({es5:h,_n:m}){const D=h?n.varKinds.var:this.varKind,B=this.rhs===void 0?"":` = ${this.rhs}`;return`${D} ${this.name}${B};`+m}optimizeNames(h,m){if(!!h[this.name.str])return this.rhs&&(this.rhs=j(this.rhs,h,m)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}}class a extends i{constructor(h,m,D){super(),this.lhs=h,this.rhs=m,this.sideEffects=D}render({_n:h}){return`${this.lhs} = ${this.rhs};`+h}optimizeNames(h,m){if(!(this.lhs instanceof e.Name&&!h[this.lhs.str]&&!this.sideEffects))return this.rhs=j(this.rhs,h,m),this}get names(){const h=this.lhs instanceof e.Name?{}:Ue({},this.lhs.names);return Y(h,this.rhs)}}class u extends a{constructor(h,m,D,B){super(h,D,B),this.op=m}render({_n:h}){return`${this.lhs} ${this.op}= ${this.rhs};`+h}}class l extends i{constructor(h){super(),this.label=h,this.names={}}render({_n:h}){return`${this.label}:`+h}}class c extends i{constructor(h){super(),this.label=h,this.names={}}render({_n:h}){return`break${this.label?` ${this.label}`:""};`+h}}class d extends i{constructor(h){super(),this.error=h}render({_n:h}){return`throw ${this.error};`+h}get names(){return this.error.names}}class p extends i{constructor(h){super(),this.code=h}render({_n:h}){return`${this.code};`+h}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(h,m){return this.code=j(this.code,h,m),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}}class E extends i{constructor(h=[]){super(),this.nodes=h}render(h){return this.nodes.reduce((m,D)=>m+D.render(h),"")}optimizeNodes(){const{nodes:h}=this;let m=h.length;for(;m--;){const D=h[m].optimizeNodes();Array.isArray(D)?h.splice(m,1,...D):D?h[m]=D:h.splice(m,1)}return h.length>0?this:void 0}optimizeNames(h,m){const{nodes:D}=this;let B=D.length;for(;B--;){const H=D[B];H.optimizeNames(h,m)||(U(h,H.names),D.splice(B,1))}return D.length>0?this:void 0}get names(){return this.nodes.reduce((h,m)=>ue(h,m.names),{})}}class v extends E{render(h){return"{"+h._n+super.render(h)+"}"+h._n}}class C extends E{}class S extends v{}S.kind="else";class g extends v{constructor(h,m){super(m),this.condition=h}render(h){let m=`if(${this.condition})`+super.render(h);return this.else&&(m+="else "+this.else.render(h)),m}optimizeNodes(){super.optimizeNodes();const h=this.condition;if(h===!0)return this.nodes;let m=this.else;if(m){const D=m.optimizeNodes();m=this.else=Array.isArray(D)?new S(D):D}if(m)return h===!1?m instanceof g?m:m.nodes:this.nodes.length?this:new g(X(h),m instanceof g?[m]:m.nodes);if(!(h===!1||!this.nodes.length))return this}optimizeNames(h,m){var D;if(this.else=(D=this.else)===null||D===void 0?void 0:D.optimizeNames(h,m),!!(super.optimizeNames(h,m)||this.else))return this.condition=j(this.condition,h,m),this}get names(){const h=super.names;return Y(h,this.condition),this.else&&ue(h,this.else.names),h}}g.kind="if";class T extends v{}T.kind="for";class A extends T{constructor(h){super(),this.iteration=h}render(h){return`for(${this.iteration})`+super.render(h)}optimizeNames(h,m){if(!!super.optimizeNames(h,m))return this.iteration=j(this.iteration,h,m),this}get names(){return ue(super.names,this.iteration.names)}}class O extends T{constructor(h,m,D,B){super(),this.varKind=h,this.name=m,this.from=D,this.to=B}render(h){const m=h.es5?n.varKinds.var:this.varKind,{name:D,from:B,to:H}=this;return`for(${m} ${D}=${B}; ${D}<${H}; ${D}++)`+super.render(h)}get names(){const h=Y(super.names,this.from);return Y(h,this.to)}}class L extends T{constructor(h,m,D,B){super(),this.loop=h,this.varKind=m,this.name=D,this.iterable=B}render(h){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(h)}optimizeNames(h,m){if(!!super.optimizeNames(h,m))return this.iterable=j(this.iterable,h,m),this}get names(){return ue(super.names,this.iterable.names)}}class $ extends v{constructor(h,m,D){super(),this.name=h,this.args=m,this.async=D}render(h){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(h)}}$.kind="func";class N extends E{render(h){return"return "+super.render(h)}}N.kind="return";class F extends v{render(h){let m="try"+super.render(h);return this.catch&&(m+=this.catch.render(h)),this.finally&&(m+=this.finally.render(h)),m}optimizeNodes(){var h,m;return super.optimizeNodes(),(h=this.catch)===null||h===void 0||h.optimizeNodes(),(m=this.finally)===null||m===void 0||m.optimizeNodes(),this}optimizeNames(h,m){var D,B;return super.optimizeNames(h,m),(D=this.catch)===null||D===void 0||D.optimizeNames(h,m),(B=this.finally)===null||B===void 0||B.optimizeNames(h,m),this}get names(){const h=super.names;return this.catch&&ue(h,this.catch.names),this.finally&&ue(h,this.finally.names),h}}class q extends v{constructor(h){super(),this.error=h}render(h){return`catch(${this.error})`+super.render(h)}}q.kind="catch";class W extends v{render(h){return"finally"+super.render(h)}}W.kind="finally";class ye{constructor(h,m={}){this._values={},this._blockStarts=[],this._constants={},this.opts=Nt(Ue({},m),{_n:m.lines?`
`:""}),this._extScope=h,this._scope=new n.Scope({parent:h}),this._nodes=[new C]}toString(){return this._root.render(this.opts)}name(h){return this._scope.name(h)}scopeName(h){return this._extScope.name(h)}scopeValue(h,m){const D=this._extScope.value(h,m);return(this._values[D.prefix]||(this._values[D.prefix]=new Set)).add(D),D}getScopeValue(h,m){return this._extScope.getValue(h,m)}scopeRefs(h){return this._extScope.scopeRefs(h,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(h,m,D,B){const H=this._scope.toName(m);return D!==void 0&&B&&(this._constants[H.str]=D),this._leafNode(new o(h,H,D)),H}const(h,m,D){return this._def(n.varKinds.const,h,m,D)}let(h,m,D){return this._def(n.varKinds.let,h,m,D)}var(h,m,D){return this._def(n.varKinds.var,h,m,D)}assign(h,m,D){return this._leafNode(new a(h,m,D))}add(h,m){return this._leafNode(new u(h,t.operators.ADD,m))}code(h){return typeof h=="function"?h():h!==e.nil&&this._leafNode(new p(h)),this}object(...h){const m=["{"];for(const[D,B]of h)m.length>1&&m.push(","),m.push(D),(D!==B||this.opts.es5)&&(m.push(":"),(0,e.addCodeArg)(m,B));return m.push("}"),new e._Code(m)}if(h,m,D){if(this._blockNode(new g(h)),m&&D)this.code(m).else().code(D).endIf();else if(m)this.code(m).endIf();else if(D)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(h){return this._elseNode(new g(h))}else(){return this._elseNode(new S)}endIf(){return this._endBlockNode(g,S)}_for(h,m){return this._blockNode(h),m&&this.code(m).endFor(),this}for(h,m){return this._for(new A(h),m)}forRange(h,m,D,B,H=this.opts.es5?n.varKinds.var:n.varKinds.let){const J=this._scope.toName(h);return this._for(new O(H,J,m,D),()=>B(J))}forOf(h,m,D,B=n.varKinds.const){const H=this._scope.toName(h);if(this.opts.es5){const J=m instanceof e.Name?m:this.var("_arr",m);return this.forRange("_i",0,(0,e._)`${J}.length`,ne=>{this.var(H,(0,e._)`${J}[${ne}]`),D(H)})}return this._for(new L("of",B,H,m),()=>D(H))}forIn(h,m,D,B=this.opts.es5?n.varKinds.var:n.varKinds.const){if(this.opts.ownProperties)return this.forOf(h,(0,e._)`Object.keys(${m})`,D);const H=this._scope.toName(h);return this._for(new L("in",B,H,m),()=>D(H))}endFor(){return this._endBlockNode(T)}label(h){return this._leafNode(new l(h))}break(h){return this._leafNode(new c(h))}return(h){const m=new N;if(this._blockNode(m),this.code(h),m.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(N)}try(h,m,D){if(!m&&!D)throw new Error('CodeGen: "try" without "catch" and "finally"');const B=new F;if(this._blockNode(B),this.code(h),m){const H=this.name("e");this._currNode=B.catch=new q(H),m(H)}return D&&(this._currNode=B.finally=new W,this.code(D)),this._endBlockNode(q,W)}throw(h){return this._leafNode(new d(h))}block(h,m){return this._blockStarts.push(this._nodes.length),h&&this.code(h).endBlock(m),this}endBlock(h){const m=this._blockStarts.pop();if(m===void 0)throw new Error("CodeGen: not in self-balancing block");const D=this._nodes.length-m;if(D<0||h!==void 0&&D!==h)throw new Error(`CodeGen: wrong number of nodes: ${D} vs ${h} expected`);return this._nodes.length=m,this}func(h,m=e.nil,D,B){return this._blockNode(new $(h,m,D)),B&&this.code(B).endFunc(),this}endFunc(){return this._endBlockNode($)}optimize(h=1){for(;h-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(h){return this._currNode.nodes.push(h),this}_blockNode(h){this._currNode.nodes.push(h),this._nodes.push(h)}_endBlockNode(h,m){const D=this._currNode;if(D instanceof h||m&&D instanceof m)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${m?`${h.kind}/${m.kind}`:h.kind}"`)}_elseNode(h){const m=this._currNode;if(!(m instanceof g))throw new Error('CodeGen: "else" without "if"');return this._currNode=m.else=h,this}get _root(){return this._nodes[0]}get _currNode(){const h=this._nodes;return h[h.length-1]}set _currNode(h){const m=this._nodes;m[m.length-1]=h}}t.CodeGen=ye;function ue(I,h){for(const m in h)I[m]=(I[m]||0)+(h[m]||0);return I}function Y(I,h){return h instanceof e._CodeOrName?ue(I,h.names):I}function j(I,h,m){if(I instanceof e.Name)return D(I);if(!B(I))return I;return new e._Code(I._items.reduce((H,J)=>(J instanceof e.Name&&(J=D(J)),J instanceof e._Code?H.push(...J._items):H.push(J),H),[]));function D(H){const J=m[H.str];return J===void 0||h[H.str]!==1?H:(delete h[H.str],J)}function B(H){return H instanceof e._Code&&H._items.some(J=>J instanceof e.Name&&h[J.str]===1&&m[J.str]!==void 0)}}function U(I,h){for(const m in h)I[m]=(I[m]||0)-(h[m]||0)}function X(I){return typeof I=="boolean"||typeof I=="number"||I===null?!I:(0,e._)`!${P(I)}`}t.not=X;const V=w(t.operators.AND);function ee(...I){return I.reduce(V)}t.and=ee;const Z=w(t.operators.OR);function M(...I){return I.reduce(Z)}t.or=M;function w(I){return(h,m)=>h===e.nil?m:m===e.nil?h:(0,e._)`${P(h)} ${I} ${P(m)}`}function P(I){return I instanceof e.Name?I:(0,e._)`(${I})`}})(le);var me={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.getErrorPath=t.Type=t.useFunc=t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;const e=le,n=xr;function r($){const N={};for(const F of $)N[F]=!0;return N}t.toHash=r;function s($,N){return typeof N=="boolean"?N:Object.keys(N).length===0?!0:(i($,N),!o(N,$.self.RULES.all))}t.alwaysValidSchema=s;function i($,N=$.schema){const{opts:F,self:q}=$;if(!F.strictSchema||typeof N=="boolean")return;const W=q.RULES.keywords;for(const ye in N)W[ye]||L($,`unknown keyword: "${ye}"`)}t.checkUnknownRules=i;function o($,N){if(typeof $=="boolean")return!$;for(const F in $)if(N[F])return!0;return!1}t.schemaHasRules=o;function a($,N){if(typeof $=="boolean")return!$;for(const F in $)if(F!=="$ref"&&N.all[F])return!0;return!1}t.schemaHasRulesButRef=a;function u({topSchemaRef:$,schemaPath:N},F,q,W){if(!W){if(typeof F=="number"||typeof F=="boolean")return F;if(typeof F=="string")return(0,e._)`${F}`}return(0,e._)`${$}${N}${(0,e.getProperty)(q)}`}t.schemaRefOrVal=u;function l($){return p(decodeURIComponent($))}t.unescapeFragment=l;function c($){return encodeURIComponent(d($))}t.escapeFragment=c;function d($){return typeof $=="number"?`${$}`:$.replace(/~/g,"~0").replace(/\//g,"~1")}t.escapeJsonPointer=d;function p($){return $.replace(/~1/g,"/").replace(/~0/g,"~")}t.unescapeJsonPointer=p;function E($,N){if(Array.isArray($))for(const F of $)N(F);else N($)}t.eachItem=E;function v({mergeNames:$,mergeToName:N,mergeValues:F,resultToName:q}){return(W,ye,ue,Y)=>{const j=ue===void 0?ye:ue instanceof e.Name?(ye instanceof e.Name?$(W,ye,ue):N(W,ye,ue),ue):ye instanceof e.Name?(N(W,ue,ye),ye):F(ye,ue);return Y===e.Name&&!(j instanceof e.Name)?q(W,j):j}}t.mergeEvaluated={props:v({mergeNames:($,N,F)=>$.if((0,e._)`${F} !== true && ${N} !== undefined`,()=>{$.if((0,e._)`${N} === true`,()=>$.assign(F,!0),()=>$.assign(F,(0,e._)`${F} || {}`).code((0,e._)`Object.assign(${F}, ${N})`))}),mergeToName:($,N,F)=>$.if((0,e._)`${F} !== true`,()=>{N===!0?$.assign(F,!0):($.assign(F,(0,e._)`${F} || {}`),S($,F,N))}),mergeValues:($,N)=>$===!0?!0:Ue(Ue({},$),N),resultToName:C}),items:v({mergeNames:($,N,F)=>$.if((0,e._)`${F} !== true && ${N} !== undefined`,()=>$.assign(F,(0,e._)`${N} === true ? true : ${F} > ${N} ? ${F} : ${N}`)),mergeToName:($,N,F)=>$.if((0,e._)`${F} !== true`,()=>$.assign(F,N===!0?!0:(0,e._)`${F} > ${N} ? ${F} : ${N}`)),mergeValues:($,N)=>$===!0?!0:Math.max($,N),resultToName:($,N)=>$.var("items",N)})};function C($,N){if(N===!0)return $.var("props",!0);const F=$.var("props",(0,e._)`{}`);return N!==void 0&&S($,F,N),F}t.evaluatedPropsToName=C;function S($,N,F){Object.keys(F).forEach(q=>$.assign((0,e._)`${N}${(0,e.getProperty)(q)}`,!0))}t.setEvaluated=S;const g={};function T($,N){return $.scopeValue("func",{ref:N,code:g[N.code]||(g[N.code]=new n._Code(N.code))})}t.useFunc=T;var A;(function($){$[$.Num=0]="Num",$[$.Str=1]="Str"})(A=t.Type||(t.Type={}));function O($,N,F){if($ instanceof e.Name){const q=N===A.Num;return F?q?(0,e._)`"[" + ${$} + "]"`:(0,e._)`"['" + ${$} + "']"`:q?(0,e._)`"/" + ${$}`:(0,e._)`"/" + ${$}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return F?(0,e.getProperty)($).toString():"/"+d($)}t.getErrorPath=O;function L($,N,F=$.opts.strictSchema){if(!!F){if(N=`strict mode: ${N}`,F===!0)throw new Error(N);$.self.logger.warn(N)}}t.checkStrictMode=L})(me);var Rt={};Object.defineProperty(Rt,"__esModule",{value:!0});const He=le,_0={data:new He.Name("data"),valCxt:new He.Name("valCxt"),instancePath:new He.Name("instancePath"),parentData:new He.Name("parentData"),parentDataProperty:new He.Name("parentDataProperty"),rootData:new He.Name("rootData"),dynamicAnchors:new He.Name("dynamicAnchors"),vErrors:new He.Name("vErrors"),errors:new He.Name("errors"),this:new He.Name("this"),self:new He.Name("self"),scope:new He.Name("scope"),json:new He.Name("json"),jsonPos:new He.Name("jsonPos"),jsonLen:new He.Name("jsonLen"),jsonPart:new He.Name("jsonPart")};Rt.default=_0;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const e=le,n=me,r=Rt;t.keywordError={message:({keyword:S})=>(0,e.str)`must pass "${S}" keyword validation`},t.keyword$DataError={message:({keyword:S,schemaType:g})=>g?(0,e.str)`"${S}" keyword must be ${g} ($data)`:(0,e.str)`"${S}" keyword is invalid ($data)`};function s(S,g=t.keywordError,T,A){const{it:O}=S,{gen:L,compositeRule:$,allErrors:N}=O,F=d(S,g,T);(A!=null?A:$||N)?u(L,F):l(O,(0,e._)`[${F}]`)}t.reportError=s;function i(S,g=t.keywordError,T){const{it:A}=S,{gen:O,compositeRule:L,allErrors:$}=A,N=d(S,g,T);u(O,N),L||$||l(A,r.default.vErrors)}t.reportExtraError=i;function o(S,g){S.assign(r.default.errors,g),S.if((0,e._)`${r.default.vErrors} !== null`,()=>S.if(g,()=>S.assign((0,e._)`${r.default.vErrors}.length`,g),()=>S.assign(r.default.vErrors,null)))}t.resetErrorsCount=o;function a({gen:S,keyword:g,schemaValue:T,data:A,errsCount:O,it:L}){if(O===void 0)throw new Error("ajv implementation error");const $=S.name("err");S.forRange("i",O,r.default.errors,N=>{S.const($,(0,e._)`${r.default.vErrors}[${N}]`),S.if((0,e._)`${$}.instancePath === undefined`,()=>S.assign((0,e._)`${$}.instancePath`,(0,e.strConcat)(r.default.instancePath,L.errorPath))),S.assign((0,e._)`${$}.schemaPath`,(0,e.str)`${L.errSchemaPath}/${g}`),L.opts.verbose&&(S.assign((0,e._)`${$}.schema`,T),S.assign((0,e._)`${$}.data`,A))})}t.extendErrors=a;function u(S,g){const T=S.const("err",g);S.if((0,e._)`${r.default.vErrors} === null`,()=>S.assign(r.default.vErrors,(0,e._)`[${T}]`),(0,e._)`${r.default.vErrors}.push(${T})`),S.code((0,e._)`${r.default.errors}++`)}function l(S,g){const{gen:T,validateName:A,schemaEnv:O}=S;O.$async?T.throw((0,e._)`new ${S.ValidationError}(${g})`):(T.assign((0,e._)`${A}.errors`,g),T.return(!1))}const c={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")};function d(S,g,T){const{createErrors:A}=S.it;return A===!1?(0,e._)`{}`:p(S,g,T)}function p(S,g,T={}){const{gen:A,it:O}=S,L=[E(O,T),v(S,T)];return C(S,g,L),A.object(...L)}function E({errorPath:S},{instancePath:g}){const T=g?(0,e.str)`${S}${(0,n.getErrorPath)(g,n.Type.Str)}`:S;return[r.default.instancePath,(0,e.strConcat)(r.default.instancePath,T)]}function v({keyword:S,it:{errSchemaPath:g}},{schemaPath:T,parentSchema:A}){let O=A?g:(0,e.str)`${g}/${S}`;return T&&(O=(0,e.str)`${O}${(0,n.getErrorPath)(T,n.Type.Str)}`),[c.schemaPath,O]}function C(S,{params:g,message:T},A){const{keyword:O,data:L,schemaValue:$,it:N}=S,{opts:F,propertyName:q,topSchemaRef:W,schemaPath:ye}=N;A.push([c.keyword,O],[c.params,typeof g=="function"?g(S):g||(0,e._)`{}`]),F.messages&&A.push([c.message,typeof T=="function"?T(S):T]),F.verbose&&A.push([c.schema,$],[c.parentSchema,(0,e._)`${W}${ye}`],[r.default.data,L]),q&&A.push([c.propertyName,q])}})(ts);Object.defineProperty(er,"__esModule",{value:!0});er.boolOrEmptySchema=er.topBoolOrEmptySchema=void 0;const g0=ts,y0=le,v0=Rt,E0={message:"boolean schema is false"};function b0(t){const{gen:e,schema:n,validateName:r}=t;n===!1?hd(t,!1):typeof n=="object"&&n.$async===!0?e.return(v0.default.data):(e.assign((0,y0._)`${r}.errors`,null),e.return(!0))}er.topBoolOrEmptySchema=b0;function w0(t,e){const{gen:n,schema:r}=t;r===!1?(n.var(e,!1),hd(t)):n.var(e,!0)}er.boolOrEmptySchema=w0;function hd(t,e){const{gen:n,data:r}=t,s={gen:n,keyword:"false schema",data:r,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,g0.reportError)(s,E0,void 0,e)}var ns={},Tn={};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.getRules=Tn.isJSONType=void 0;const S0=["string","number","integer","boolean","null","object","array"],C0=new Set(S0);function I0(t){return typeof t=="string"&&C0.has(t)}Tn.isJSONType=I0;function $0(){const t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:Nt(Ue({},t),{integer:!0,boolean:!0,null:!0}),rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}Tn.getRules=$0;var Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});Lt.shouldUseRule=Lt.shouldUseGroup=Lt.schemaHasRulesForType=void 0;function T0({schema:t,self:e},n){const r=e.RULES.types[n];return r&&r!==!0&&fd(t,r)}Lt.schemaHasRulesForType=T0;function fd(t,e){return e.rules.some(n=>pd(t,n))}Lt.shouldUseGroup=fd;function pd(t,e){var n;return t[e.keyword]!==void 0||((n=e.definition.implements)===null||n===void 0?void 0:n.some(r=>t[r]!==void 0))}Lt.shouldUseRule=pd;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;const e=Tn,n=Lt,r=ts,s=le,i=me;var o;(function(A){A[A.Correct=0]="Correct",A[A.Wrong=1]="Wrong"})(o=t.DataType||(t.DataType={}));function a(A){const O=u(A.type);if(O.includes("null")){if(A.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!O.length&&A.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');A.nullable===!0&&O.push("null")}return O}t.getSchemaTypes=a;function u(A){const O=Array.isArray(A)?A:A?[A]:[];if(O.every(e.isJSONType))return O;throw new Error("type must be JSONType or JSONType[]: "+O.join(","))}t.getJSONTypes=u;function l(A,O){const{gen:L,data:$,opts:N}=A,F=d(O,N.coerceTypes),q=O.length>0&&!(F.length===0&&O.length===1&&(0,n.schemaHasRulesForType)(A,O[0]));if(q){const W=C(O,$,N.strictNumbers,o.Wrong);L.if(W,()=>{F.length?p(A,O,F):g(A)})}return q}t.coerceAndCheckDataType=l;const c=new Set(["string","number","integer","boolean","null"]);function d(A,O){return O?A.filter(L=>c.has(L)||O==="array"&&L==="array"):[]}function p(A,O,L){const{gen:$,data:N,opts:F}=A,q=$.let("dataType",(0,s._)`typeof ${N}`),W=$.let("coerced",(0,s._)`undefined`);F.coerceTypes==="array"&&$.if((0,s._)`${q} == 'object' && Array.isArray(${N}) && ${N}.length == 1`,()=>$.assign(N,(0,s._)`${N}[0]`).assign(q,(0,s._)`typeof ${N}`).if(C(O,N,F.strictNumbers),()=>$.assign(W,N))),$.if((0,s._)`${W} !== undefined`);for(const ue of L)(c.has(ue)||ue==="array"&&F.coerceTypes==="array")&&ye(ue);$.else(),g(A),$.endIf(),$.if((0,s._)`${W} !== undefined`,()=>{$.assign(N,W),E(A,W)});function ye(ue){switch(ue){case"string":$.elseIf((0,s._)`${q} == "number" || ${q} == "boolean"`).assign(W,(0,s._)`"" + ${N}`).elseIf((0,s._)`${N} === null`).assign(W,(0,s._)`""`);return;case"number":$.elseIf((0,s._)`${q} == "boolean" || ${N} === null
              || (${q} == "string" && ${N} && ${N} == +${N})`).assign(W,(0,s._)`+${N}`);return;case"integer":$.elseIf((0,s._)`${q} === "boolean" || ${N} === null
              || (${q} === "string" && ${N} && ${N} == +${N} && !(${N} % 1))`).assign(W,(0,s._)`+${N}`);return;case"boolean":$.elseIf((0,s._)`${N} === "false" || ${N} === 0 || ${N} === null`).assign(W,!1).elseIf((0,s._)`${N} === "true" || ${N} === 1`).assign(W,!0);return;case"null":$.elseIf((0,s._)`${N} === "" || ${N} === 0 || ${N} === false`),$.assign(W,null);return;case"array":$.elseIf((0,s._)`${q} === "string" || ${q} === "number"
              || ${q} === "boolean" || ${N} === null`).assign(W,(0,s._)`[${N}]`)}}}function E({gen:A,parentData:O,parentDataProperty:L},$){A.if((0,s._)`${O} !== undefined`,()=>A.assign((0,s._)`${O}[${L}]`,$))}function v(A,O,L,$=o.Correct){const N=$===o.Correct?s.operators.EQ:s.operators.NEQ;let F;switch(A){case"null":return(0,s._)`${O} ${N} null`;case"array":F=(0,s._)`Array.isArray(${O})`;break;case"object":F=(0,s._)`${O} && typeof ${O} == "object" && !Array.isArray(${O})`;break;case"integer":F=q((0,s._)`!(${O} % 1) && !isNaN(${O})`);break;case"number":F=q();break;default:return(0,s._)`typeof ${O} ${N} ${A}`}return $===o.Correct?F:(0,s.not)(F);function q(W=s.nil){return(0,s.and)((0,s._)`typeof ${O} == "number"`,W,L?(0,s._)`isFinite(${O})`:s.nil)}}t.checkDataType=v;function C(A,O,L,$){if(A.length===1)return v(A[0],O,L,$);let N;const F=(0,i.toHash)(A);if(F.array&&F.object){const q=(0,s._)`typeof ${O} != "object"`;N=F.null?q:(0,s._)`!${O} || ${q}`,delete F.null,delete F.array,delete F.object}else N=s.nil;F.number&&delete F.integer;for(const q in F)N=(0,s.and)(N,v(q,O,L,$));return N}t.checkDataTypes=C;const S={message:({schema:A})=>`must be ${A}`,params:({schema:A,schemaValue:O})=>typeof A=="string"?(0,s._)`{type: ${A}}`:(0,s._)`{type: ${O}}`};function g(A){const O=T(A);(0,r.reportError)(O,S)}t.reportTypeError=g;function T(A){const{gen:O,data:L,schema:$}=A,N=(0,i.schemaRefOrVal)(A,$,"type");return{gen:O,keyword:"type",data:L,schema:$.type,schemaCode:N,schemaValue:N,parentSchema:$,params:{},it:A}}})(ns);var ei={};Object.defineProperty(ei,"__esModule",{value:!0});ei.assignDefaults=void 0;const Un=le,A0=me;function R0(t,e){const{properties:n,items:r}=t.schema;if(e==="object"&&n)for(const s in n)Bl(t,s,n[s].default);else e==="array"&&Array.isArray(r)&&r.forEach((s,i)=>Bl(t,i,s.default))}ei.assignDefaults=R0;function Bl(t,e,n){const{gen:r,compositeRule:s,data:i,opts:o}=t;if(n===void 0)return;const a=(0,Un._)`${i}${(0,Un.getProperty)(e)}`;if(s){(0,A0.checkStrictMode)(t,`default is ignored for: ${a}`);return}let u=(0,Un._)`${a} === undefined`;o.useDefaults==="empty"&&(u=(0,Un._)`${u} || ${a} === null || ${a} === ""`),r.if(u,(0,Un._)`${a} = ${(0,Un.stringify)(n)}`)}var $t={},ae={};Object.defineProperty(ae,"__esModule",{value:!0});ae.validateUnion=ae.validateArray=ae.usePattern=ae.callValidateCode=ae.schemaProperties=ae.allSchemaProperties=ae.noPropertyInData=ae.propertyInData=ae.isOwnProperty=ae.hasPropFunc=ae.reportMissingProp=ae.checkMissingProp=ae.checkReportMissingProp=void 0;const $e=le,Uo=me,qt=Rt,k0=me;function N0(t,e){const{gen:n,data:r,it:s}=t;n.if(xo(n,r,e,s.opts.ownProperties),()=>{t.setParams({missingProperty:(0,$e._)`${e}`},!0),t.error()})}ae.checkReportMissingProp=N0;function D0({gen:t,data:e,it:{opts:n}},r,s){return(0,$e.or)(...r.map(i=>(0,$e.and)(xo(t,e,i,n.ownProperties),(0,$e._)`${s} = ${i}`)))}ae.checkMissingProp=D0;function P0(t,e){t.setParams({missingProperty:e},!0),t.error()}ae.reportMissingProp=P0;function md(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,$e._)`Object.prototype.hasOwnProperty`})}ae.hasPropFunc=md;function Bo(t,e,n){return(0,$e._)`${md(t)}.call(${e}, ${n})`}ae.isOwnProperty=Bo;function O0(t,e,n,r){const s=(0,$e._)`${e}${(0,$e.getProperty)(n)} !== undefined`;return r?(0,$e._)`${s} && ${Bo(t,e,n)}`:s}ae.propertyInData=O0;function xo(t,e,n,r){const s=(0,$e._)`${e}${(0,$e.getProperty)(n)} === undefined`;return r?(0,$e.or)(s,(0,$e.not)(Bo(t,e,n))):s}ae.noPropertyInData=xo;function _d(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}ae.allSchemaProperties=_d;function M0(t,e){return _d(e).filter(n=>!(0,Uo.alwaysValidSchema)(t,e[n]))}ae.schemaProperties=M0;function F0({schemaCode:t,data:e,it:{gen:n,topSchemaRef:r,schemaPath:s,errorPath:i},it:o},a,u,l){const c=l?(0,$e._)`${t}, ${e}, ${r}${s}`:e,d=[[qt.default.instancePath,(0,$e.strConcat)(qt.default.instancePath,i)],[qt.default.parentData,o.parentData],[qt.default.parentDataProperty,o.parentDataProperty],[qt.default.rootData,qt.default.rootData]];o.opts.dynamicRef&&d.push([qt.default.dynamicAnchors,qt.default.dynamicAnchors]);const p=(0,$e._)`${c}, ${n.object(...d)}`;return u!==$e.nil?(0,$e._)`${a}.call(${u}, ${p})`:(0,$e._)`${a}(${p})`}ae.callValidateCode=F0;const L0=(0,$e._)`new RegExp`;function j0({gen:t,it:{opts:e}},n){const r=e.unicodeRegExp?"u":"",{regExp:s}=e.code,i=s(n,r);return t.scopeValue("pattern",{key:i.toString(),ref:i,code:(0,$e._)`${s.code==="new RegExp"?L0:(0,k0.useFunc)(t,s)}(${n}, ${r})`})}ae.usePattern=j0;function U0(t){const{gen:e,data:n,keyword:r,it:s}=t,i=e.name("valid");if(s.allErrors){const a=e.let("valid",!0);return o(()=>e.assign(a,!1)),a}return e.var(i,!0),o(()=>e.break()),i;function o(a){const u=e.const("len",(0,$e._)`${n}.length`);e.forRange("i",0,u,l=>{t.subschema({keyword:r,dataProp:l,dataPropType:Uo.Type.Num},i),e.if((0,$e.not)(i),a)})}}ae.validateArray=U0;function B0(t){const{gen:e,schema:n,keyword:r,it:s}=t;if(!Array.isArray(n))throw new Error("ajv implementation error");if(n.some(u=>(0,Uo.alwaysValidSchema)(s,u))&&!s.opts.unevaluated)return;const o=e.let("valid",!1),a=e.name("_valid");e.block(()=>n.forEach((u,l)=>{const c=t.subschema({keyword:r,schemaProp:l,compositeRule:!0},a);e.assign(o,(0,$e._)`${o} || ${a}`),t.mergeValidEvaluated(c,a)||e.if((0,$e.not)(o))})),t.result(o,()=>t.reset(),()=>t.error(!0))}ae.validateUnion=B0;Object.defineProperty($t,"__esModule",{value:!0});$t.validateKeywordUsage=$t.validSchemaType=$t.funcKeywordCode=$t.macroKeywordCode=void 0;const Ye=le,fn=Rt,x0=ae,V0=ts;function H0(t,e){const{gen:n,keyword:r,schema:s,parentSchema:i,it:o}=t,a=e.macro.call(o.self,s,i,o),u=gd(n,r,a);o.opts.validateSchema!==!1&&o.self.validateSchema(a,!0);const l=n.name("valid");t.subschema({schema:a,schemaPath:Ye.nil,errSchemaPath:`${o.errSchemaPath}/${r}`,topSchemaRef:u,compositeRule:!0},l),t.pass(l,()=>t.error(!0))}$t.macroKeywordCode=H0;function q0(t,e){var n;const{gen:r,keyword:s,schema:i,parentSchema:o,$data:a,it:u}=t;z0(u,e);const l=!a&&e.compile?e.compile.call(u.self,i,o,u):e.validate,c=gd(r,s,l),d=r.let("valid");t.block$data(d,p),t.ok((n=e.valid)!==null&&n!==void 0?n:d);function p(){if(e.errors===!1)C(),e.modifying&&xl(t),S(()=>t.error());else{const g=e.async?E():v();e.modifying&&xl(t),S(()=>W0(t,g))}}function E(){const g=r.let("ruleErrs",null);return r.try(()=>C((0,Ye._)`await `),T=>r.assign(d,!1).if((0,Ye._)`${T} instanceof ${u.ValidationError}`,()=>r.assign(g,(0,Ye._)`${T}.errors`),()=>r.throw(T))),g}function v(){const g=(0,Ye._)`${c}.errors`;return r.assign(g,null),C(Ye.nil),g}function C(g=e.async?(0,Ye._)`await `:Ye.nil){const T=u.opts.passContext?fn.default.this:fn.default.self,A=!("compile"in e&&!a||e.schema===!1);r.assign(d,(0,Ye._)`${g}${(0,x0.callValidateCode)(t,c,T,A)}`,e.modifying)}function S(g){var T;r.if((0,Ye.not)((T=e.valid)!==null&&T!==void 0?T:d),g)}}$t.funcKeywordCode=q0;function xl(t){const{gen:e,data:n,it:r}=t;e.if(r.parentData,()=>e.assign(n,(0,Ye._)`${r.parentData}[${r.parentDataProperty}]`))}function W0(t,e){const{gen:n}=t;n.if((0,Ye._)`Array.isArray(${e})`,()=>{n.assign(fn.default.vErrors,(0,Ye._)`${fn.default.vErrors} === null ? ${e} : ${fn.default.vErrors}.concat(${e})`).assign(fn.default.errors,(0,Ye._)`${fn.default.vErrors}.length`),(0,V0.extendErrors)(t)},()=>t.error())}function z0({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function gd(t,e,n){if(n===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof n=="function"?{ref:n}:{ref:n,code:(0,Ye.stringify)(n)})}function K0(t,e,n=!1){return!e.length||e.some(r=>r==="array"?Array.isArray(t):r==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==r||n&&typeof t=="undefined")}$t.validSchemaType=K0;function G0({schema:t,opts:e,self:n,errSchemaPath:r},s,i){if(Array.isArray(s.keyword)?!s.keyword.includes(i):s.keyword!==i)throw new Error("ajv implementation error");const o=s.dependencies;if(o!=null&&o.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${i}: ${o.join(",")}`);if(s.validateSchema&&!s.validateSchema(t[i])){const u=`keyword "${i}" value is invalid at path "${r}": `+n.errorsText(s.validateSchema.errors);if(e.validateSchema==="log")n.logger.error(u);else throw new Error(u)}}$t.validateKeywordUsage=G0;var tn={};Object.defineProperty(tn,"__esModule",{value:!0});tn.extendSubschemaMode=tn.extendSubschemaData=tn.getSubschema=void 0;const Ct=le,yd=me;function Y0(t,{keyword:e,schemaProp:n,schema:r,schemaPath:s,errSchemaPath:i,topSchemaRef:o}){if(e!==void 0&&r!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){const a=t.schema[e];return n===void 0?{schema:a,schemaPath:(0,Ct._)`${t.schemaPath}${(0,Ct.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[n],schemaPath:(0,Ct._)`${t.schemaPath}${(0,Ct.getProperty)(e)}${(0,Ct.getProperty)(n)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,yd.escapeFragment)(n)}`}}if(r!==void 0){if(s===void 0||i===void 0||o===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:r,schemaPath:s,topSchemaRef:o,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')}tn.getSubschema=Y0;function J0(t,e,{dataProp:n,dataPropType:r,data:s,dataTypes:i,propertyName:o}){if(s!==void 0&&n!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:a}=e;if(n!==void 0){const{errorPath:l,dataPathArr:c,opts:d}=e,p=a.let("data",(0,Ct._)`${e.data}${(0,Ct.getProperty)(n)}`,!0);u(p),t.errorPath=(0,Ct.str)`${l}${(0,yd.getErrorPath)(n,r,d.jsPropertySyntax)}`,t.parentDataProperty=(0,Ct._)`${n}`,t.dataPathArr=[...c,t.parentDataProperty]}if(s!==void 0){const l=s instanceof Ct.Name?s:a.let("data",s,!0);u(l),o!==void 0&&(t.propertyName=o)}i&&(t.dataTypes=i);function u(l){t.data=l,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,l]}}tn.extendSubschemaData=J0;function Q0(t,{jtdDiscriminator:e,jtdMetadata:n,compositeRule:r,createErrors:s,allErrors:i}){r!==void 0&&(t.compositeRule=r),s!==void 0&&(t.createErrors=s),i!==void 0&&(t.allErrors=i),t.jtdDiscriminator=e,t.jtdMetadata=n}tn.extendSubschemaMode=Q0;var xe={},vd=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,s,i;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(s=r;s--!==0;)if(!t(e[s],n[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(i=Object.keys(e),r=i.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[s]))return!1;for(s=r;s--!==0;){var o=i[s];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n},Ed={exports:{}},Jt=Ed.exports=function(t,e,n){typeof e=="function"&&(n=e,e={}),n=e.cb||n;var r=typeof n=="function"?n:n.pre||function(){},s=n.post||function(){};Es(e,r,s,t,"",t)};Jt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Jt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Jt.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Jt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Es(t,e,n,r,s,i,o,a,u,l){if(r&&typeof r=="object"&&!Array.isArray(r)){e(r,s,i,o,a,u,l);for(var c in r){var d=r[c];if(Array.isArray(d)){if(c in Jt.arrayKeywords)for(var p=0;p<d.length;p++)Es(t,e,n,d[p],s+"/"+c+"/"+p,i,s,c,r,p)}else if(c in Jt.propsKeywords){if(d&&typeof d=="object")for(var E in d)Es(t,e,n,d[E],s+"/"+c+"/"+X0(E),i,s,c,r,E)}else(c in Jt.keywords||t.allKeys&&!(c in Jt.skipKeywords))&&Es(t,e,n,d,s+"/"+c,i,s,c,r)}n(r,s,i,o,a,u,l)}}function X0(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(xe,"__esModule",{value:!0});xe.getSchemaRefs=xe.resolveUrl=xe.normalizeId=xe._getFullPath=xe.getFullPath=xe.inlineRef=void 0;const Z0=me,eE=vd,tE=Ed.exports,nE=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function rE(t,e=!0){return typeof t=="boolean"?!0:e===!0?!Xi(t):e?bd(t)<=e:!1}xe.inlineRef=rE;const sE=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Xi(t){for(const e in t){if(sE.has(e))return!0;const n=t[e];if(Array.isArray(n)&&n.some(Xi)||typeof n=="object"&&Xi(n))return!0}return!1}function bd(t){let e=0;for(const n in t){if(n==="$ref")return 1/0;if(e++,!nE.has(n)&&(typeof t[n]=="object"&&(0,Z0.eachItem)(t[n],r=>e+=bd(r)),e===1/0))return 1/0}return e}function wd(t,e="",n){n!==!1&&(e=Yn(e));const r=t.parse(e);return Sd(t,r)}xe.getFullPath=wd;function Sd(t,e){return t.serialize(e).split("#")[0]+"#"}xe._getFullPath=Sd;const iE=/#\/?$/;function Yn(t){return t?t.replace(iE,""):""}xe.normalizeId=Yn;function oE(t,e,n){return n=Yn(n),t.resolve(e,n)}xe.resolveUrl=oE;const aE=/^[a-z_][-a-z0-9._]*$/i;function lE(t,e){if(typeof t=="boolean")return{};const{schemaId:n,uriResolver:r}=this.opts,s=Yn(t[n]||e),i={"":s},o=wd(r,s,!1),a={},u=new Set;return tE(t,{allKeys:!0},(d,p,E,v)=>{if(v===void 0)return;const C=o+p;let S=i[v];typeof d[n]=="string"&&(S=g.call(this,d[n])),T.call(this,d.$anchor),T.call(this,d.$dynamicAnchor),i[p]=S;function g(A){const O=this.opts.uriResolver.resolve;if(A=Yn(S?O(S,A):A),u.has(A))throw c(A);u.add(A);let L=this.refs[A];return typeof L=="string"&&(L=this.refs[L]),typeof L=="object"?l(d,L.schema,A):A!==Yn(C)&&(A[0]==="#"?(l(d,a[A],A),a[A]=d):this.refs[A]=C),A}function T(A){if(typeof A=="string"){if(!aE.test(A))throw new Error(`invalid anchor "${A}"`);g.call(this,`#${A}`)}}}),a;function l(d,p,E){if(p!==void 0&&!eE(d,p))throw c(E)}function c(d){return new Error(`reference "${d}" resolves to more than one schema`)}}xe.getSchemaRefs=lE;Object.defineProperty(_t,"__esModule",{value:!0});_t.getData=_t.KeywordCxt=_t.validateFunctionCode=void 0;const Cd=er,Vl=ns,Vo=Lt,Us=ns,uE=ei,Rr=$t,wi=tn,z=le,te=Rt,cE=xe,jt=me,wr=ts;function dE(t){if(Td(t)&&(Ad(t),$d(t))){pE(t);return}Id(t,()=>(0,Cd.topBoolOrEmptySchema)(t))}_t.validateFunctionCode=dE;function Id({gen:t,validateName:e,schema:n,schemaEnv:r,opts:s},i){s.code.es5?t.func(e,(0,z._)`${te.default.data}, ${te.default.valCxt}`,r.$async,()=>{t.code((0,z._)`"use strict"; ${Hl(n,s)}`),fE(t,s),t.code(i)}):t.func(e,(0,z._)`${te.default.data}, ${hE(s)}`,r.$async,()=>t.code(Hl(n,s)).code(i))}function hE(t){return(0,z._)`{${te.default.instancePath}="", ${te.default.parentData}, ${te.default.parentDataProperty}, ${te.default.rootData}=${te.default.data}${t.dynamicRef?(0,z._)`, ${te.default.dynamicAnchors}={}`:z.nil}}={}`}function fE(t,e){t.if(te.default.valCxt,()=>{t.var(te.default.instancePath,(0,z._)`${te.default.valCxt}.${te.default.instancePath}`),t.var(te.default.parentData,(0,z._)`${te.default.valCxt}.${te.default.parentData}`),t.var(te.default.parentDataProperty,(0,z._)`${te.default.valCxt}.${te.default.parentDataProperty}`),t.var(te.default.rootData,(0,z._)`${te.default.valCxt}.${te.default.rootData}`),e.dynamicRef&&t.var(te.default.dynamicAnchors,(0,z._)`${te.default.valCxt}.${te.default.dynamicAnchors}`)},()=>{t.var(te.default.instancePath,(0,z._)`""`),t.var(te.default.parentData,(0,z._)`undefined`),t.var(te.default.parentDataProperty,(0,z._)`undefined`),t.var(te.default.rootData,te.default.data),e.dynamicRef&&t.var(te.default.dynamicAnchors,(0,z._)`{}`)})}function pE(t){const{schema:e,opts:n,gen:r}=t;Id(t,()=>{n.$comment&&e.$comment&&kd(t),vE(t),r.let(te.default.vErrors,null),r.let(te.default.errors,0),n.unevaluated&&mE(t),Rd(t),wE(t)})}function mE(t){const{gen:e,validateName:n}=t;t.evaluated=e.const("evaluated",(0,z._)`${n}.evaluated`),e.if((0,z._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,z._)`${t.evaluated}.props`,(0,z._)`undefined`)),e.if((0,z._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,z._)`${t.evaluated}.items`,(0,z._)`undefined`))}function Hl(t,e){const n=typeof t=="object"&&t[e.schemaId];return n&&(e.code.source||e.code.process)?(0,z._)`/*# sourceURL=${n} */`:z.nil}function _E(t,e){if(Td(t)&&(Ad(t),$d(t))){gE(t,e);return}(0,Cd.boolOrEmptySchema)(t,e)}function $d({schema:t,self:e}){if(typeof t=="boolean")return!t;for(const n in t)if(e.RULES.all[n])return!0;return!1}function Td(t){return typeof t.schema!="boolean"}function gE(t,e){const{schema:n,gen:r,opts:s}=t;s.$comment&&n.$comment&&kd(t),EE(t),bE(t);const i=r.const("_errs",te.default.errors);Rd(t,i),r.var(e,(0,z._)`${i} === ${te.default.errors}`)}function Ad(t){(0,jt.checkUnknownRules)(t),yE(t)}function Rd(t,e){if(t.opts.jtd)return ql(t,[],!1,e);const n=(0,Vl.getSchemaTypes)(t.schema),r=(0,Vl.coerceAndCheckDataType)(t,n);ql(t,n,!r,e)}function yE(t){const{schema:e,errSchemaPath:n,opts:r,self:s}=t;e.$ref&&r.ignoreKeywordsWithRef&&(0,jt.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${n}"`)}function vE(t){const{schema:e,opts:n}=t;e.default!==void 0&&n.useDefaults&&n.strictSchema&&(0,jt.checkStrictMode)(t,"default is ignored in the schema root")}function EE(t){const e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,cE.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function bE(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function kd({gen:t,schemaEnv:e,schema:n,errSchemaPath:r,opts:s}){const i=n.$comment;if(s.$comment===!0)t.code((0,z._)`${te.default.self}.logger.log(${i})`);else if(typeof s.$comment=="function"){const o=(0,z.str)`${r}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,z._)`${te.default.self}.opts.$comment(${i}, ${o}, ${a}.schema)`)}}function wE(t){const{gen:e,schemaEnv:n,validateName:r,ValidationError:s,opts:i}=t;n.$async?e.if((0,z._)`${te.default.errors} === 0`,()=>e.return(te.default.data),()=>e.throw((0,z._)`new ${s}(${te.default.vErrors})`)):(e.assign((0,z._)`${r}.errors`,te.default.vErrors),i.unevaluated&&SE(t),e.return((0,z._)`${te.default.errors} === 0`))}function SE({gen:t,evaluated:e,props:n,items:r}){n instanceof z.Name&&t.assign((0,z._)`${e}.props`,n),r instanceof z.Name&&t.assign((0,z._)`${e}.items`,r)}function ql(t,e,n,r){const{gen:s,schema:i,data:o,allErrors:a,opts:u,self:l}=t,{RULES:c}=l;if(i.$ref&&(u.ignoreKeywordsWithRef||!(0,jt.schemaHasRulesButRef)(i,c))){s.block(()=>Dd(t,"$ref",c.all.$ref.definition));return}u.jtd||CE(t,e),s.block(()=>{for(const p of c.rules)d(p);d(c.post)});function d(p){!(0,Vo.shouldUseGroup)(i,p)||(p.type?(s.if((0,Us.checkDataType)(p.type,o,u.strictNumbers)),Wl(t,p),e.length===1&&e[0]===p.type&&n&&(s.else(),(0,Us.reportTypeError)(t)),s.endIf()):Wl(t,p),a||s.if((0,z._)`${te.default.errors} === ${r||0}`))}}function Wl(t,e){const{gen:n,schema:r,opts:{useDefaults:s}}=t;s&&(0,uE.assignDefaults)(t,e.type),n.block(()=>{for(const i of e.rules)(0,Vo.shouldUseRule)(r,i)&&Dd(t,i.keyword,i.definition,e.type)})}function CE(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(IE(t,e),t.opts.allowUnionTypes||$E(t,e),TE(t,t.dataTypes))}function IE(t,e){if(!!e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(n=>{zl(t.dataTypes,n)||Ho(t,`type "${n}" not allowed by context "${t.dataTypes.join(",")}"`)}),t.dataTypes=t.dataTypes.filter(n=>zl(e,n))}}function $E(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&Ho(t,"use allowUnionTypes to allow union type keyword")}function TE(t,e){const n=t.self.RULES.all;for(const r in n){const s=n[r];if(typeof s=="object"&&(0,Vo.shouldUseRule)(t.schema,s)){const{type:i}=s.definition;i.length&&!i.some(o=>AE(e,o))&&Ho(t,`missing type "${i.join(",")}" for keyword "${r}"`)}}}function AE(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function zl(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function Ho(t,e){e+=` at "${t.schemaEnv.baseId+t.errSchemaPath}" (strictTypes)`,(0,jt.checkStrictMode)(t,e,t.opts.strictTypes)}class Nd{constructor(e,n,r){if((0,Rr.validateKeywordUsage)(e,n,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=n.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,jt.schemaRefOrVal)(e,this.schema,r,this.$data),this.schemaType=n.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=n,this.$data)this.schemaCode=e.gen.const("vSchema",Pd(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,Rr.validSchemaType)(this.schema,n.schemaType,n.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(n.schemaType)}`);("code"in n?n.trackErrors:n.errors!==!1)&&(this.errsCount=e.gen.const("_errs",te.default.errors))}result(e,n,r){this.failResult((0,z.not)(e),n,r)}failResult(e,n,r){this.gen.if(e),r?r():this.error(),n?(this.gen.else(),n(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,n){this.failResult((0,z.not)(e),void 0,n)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:n}=this;this.fail((0,z._)`${n} !== undefined && (${(0,z.or)(this.invalid$data(),e)})`)}error(e,n,r){if(n){this.setParams(n),this._error(e,r),this.setParams({});return}this._error(e,r)}_error(e,n){(e?wr.reportExtraError:wr.reportError)(this,this.def.error,n)}$dataError(){(0,wr.reportError)(this,this.def.$dataError||wr.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,wr.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,n){n?Object.assign(this.params,e):this.params=e}block$data(e,n,r=z.nil){this.gen.block(()=>{this.check$data(e,r),n()})}check$data(e=z.nil,n=z.nil){if(!this.$data)return;const{gen:r,schemaCode:s,schemaType:i,def:o}=this;r.if((0,z.or)((0,z._)`${s} === undefined`,n)),e!==z.nil&&r.assign(e,!0),(i.length||o.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==z.nil&&r.assign(e,!1)),r.else()}invalid$data(){const{gen:e,schemaCode:n,schemaType:r,def:s,it:i}=this;return(0,z.or)(o(),a());function o(){if(r.length){if(!(n instanceof z.Name))throw new Error("ajv implementation error");const u=Array.isArray(r)?r:[r];return(0,z._)`${(0,Us.checkDataTypes)(u,n,i.opts.strictNumbers,Us.DataType.Wrong)}`}return z.nil}function a(){if(s.validateSchema){const u=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,z._)`!${u}(${n})`}return z.nil}}subschema(e,n){const r=(0,wi.getSubschema)(this.it,e);(0,wi.extendSubschemaData)(r,this.it,e),(0,wi.extendSubschemaMode)(r,e);const s=Nt(Ue(Ue({},this.it),r),{items:void 0,props:void 0});return _E(s,n),s}mergeEvaluated(e,n){const{it:r,gen:s}=this;!r.opts.unevaluated||(r.props!==!0&&e.props!==void 0&&(r.props=jt.mergeEvaluated.props(s,e.props,r.props,n)),r.items!==!0&&e.items!==void 0&&(r.items=jt.mergeEvaluated.items(s,e.items,r.items,n)))}mergeValidEvaluated(e,n){const{it:r,gen:s}=this;if(r.opts.unevaluated&&(r.props!==!0||r.items!==!0))return s.if(n,()=>this.mergeEvaluated(e,z.Name)),!0}}_t.KeywordCxt=Nd;function Dd(t,e,n,r){const s=new Nd(t,n,e);"code"in n?n.code(s,r):s.$data&&n.validate?(0,Rr.funcKeywordCode)(s,n):"macro"in n?(0,Rr.macroKeywordCode)(s,n):(n.compile||n.validate)&&(0,Rr.funcKeywordCode)(s,n)}const RE=/^\/(?:[^~]|~0|~1)*$/,kE=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Pd(t,{dataLevel:e,dataNames:n,dataPathArr:r}){let s,i;if(t==="")return te.default.rootData;if(t[0]==="/"){if(!RE.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,i=te.default.rootData}else{const l=kE.exec(t);if(!l)throw new Error(`Invalid JSON-pointer: ${t}`);const c=+l[1];if(s=l[2],s==="#"){if(c>=e)throw new Error(u("property/index",c));return r[e-c]}if(c>e)throw new Error(u("data",c));if(i=n[e-c],!s)return i}let o=i;const a=s.split("/");for(const l of a)l&&(i=(0,z._)`${i}${(0,z.getProperty)((0,jt.unescapeJsonPointer)(l))}`,o=(0,z._)`${o} && ${i}`);return o;function u(l,c){return`Cannot access ${l} ${c} levels up, current level is ${e}`}}_t.getData=Pd;var ti={};Object.defineProperty(ti,"__esModule",{value:!0});class NE extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}ti.default=NE;var ni={};Object.defineProperty(ni,"__esModule",{value:!0});const Si=xe;class DE extends Error{constructor(e,n,r,s){super(s||`can't resolve reference ${r} from id ${n}`),this.missingRef=(0,Si.resolveUrl)(e,n,r),this.missingSchema=(0,Si.normalizeId)((0,Si.getFullPath)(e,this.missingRef))}}ni.default=DE;var Ze={};Object.defineProperty(Ze,"__esModule",{value:!0});Ze.resolveSchema=Ze.getCompilingSchema=Ze.resolveRef=Ze.compileSchema=Ze.SchemaEnv=void 0;const ut=le,PE=ti,cn=Rt,ft=xe,Kl=me,OE=_t;class ri{constructor(e){var n;this.refs={},this.dynamicAnchors={};let r;typeof e.schema=="object"&&(r=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(n=e.baseId)!==null&&n!==void 0?n:(0,ft.normalizeId)(r==null?void 0:r[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=r==null?void 0:r.$async,this.refs={}}}Ze.SchemaEnv=ri;function qo(t){const e=Od.call(this,t);if(e)return e;const n=(0,ft.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:r,lines:s}=this.opts.code,{ownProperties:i}=this.opts,o=new ut.CodeGen(this.scope,{es5:r,lines:s,ownProperties:i});let a;t.$async&&(a=o.scopeValue("Error",{ref:PE.default,code:(0,ut._)`require("ajv/dist/runtime/validation_error").default`}));const u=o.scopeName("validate");t.validateName=u;const l={gen:o,allErrors:this.opts.allErrors,data:cn.default.data,parentData:cn.default.parentData,parentDataProperty:cn.default.parentDataProperty,dataNames:[cn.default.data],dataPathArr:[ut.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,ut.stringify)(t.schema)}:{ref:t.schema}),validateName:u,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:n,baseId:t.baseId||n,schemaPath:ut.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,ut._)`""`,opts:this.opts,self:this};let c;try{this._compilations.add(t),(0,OE.validateFunctionCode)(l),o.optimize(this.opts.code.optimize);const d=o.toString();c=`${o.scopeRefs(cn.default.scope)}return ${d}`,this.opts.code.process&&(c=this.opts.code.process(c,t));const E=new Function(`${cn.default.self}`,`${cn.default.scope}`,c)(this,this.scope.get());if(this.scope.value(u,{ref:E}),E.errors=null,E.schema=t.schema,E.schemaEnv=t,t.$async&&(E.$async=!0),this.opts.code.source===!0&&(E.source={validateName:u,validateCode:d,scopeValues:o._values}),this.opts.unevaluated){const{props:v,items:C}=l;E.evaluated={props:v instanceof ut.Name?void 0:v,items:C instanceof ut.Name?void 0:C,dynamicProps:v instanceof ut.Name,dynamicItems:C instanceof ut.Name},E.source&&(E.source.evaluated=(0,ut.stringify)(E.evaluated))}return t.validate=E,t}catch(d){throw delete t.validate,delete t.validateName,c&&this.logger.error("Error compiling schema, function code:",c),d}finally{this._compilations.delete(t)}}Ze.compileSchema=qo;function ME(t,e,n){var r;n=(0,ft.resolveUrl)(this.opts.uriResolver,e,n);const s=t.refs[n];if(s)return s;let i=jE.call(this,t,n);if(i===void 0){const o=(r=t.localRefs)===null||r===void 0?void 0:r[n],{schemaId:a}=this.opts;o&&(i=new ri({schema:o,schemaId:a,root:t,baseId:e}))}if(i!==void 0)return t.refs[n]=FE.call(this,i)}Ze.resolveRef=ME;function FE(t){return(0,ft.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:qo.call(this,t)}function Od(t){for(const e of this._compilations)if(LE(e,t))return e}Ze.getCompilingSchema=Od;function LE(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function jE(t,e){let n;for(;typeof(n=this.refs[e])=="string";)e=n;return n||this.schemas[e]||si.call(this,t,e)}function si(t,e){const n=this.opts.uriResolver.parse(e),r=(0,ft._getFullPath)(this.opts.uriResolver,n);let s=(0,ft.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&r===s)return Ci.call(this,n,t);const i=(0,ft.normalizeId)(r),o=this.refs[i]||this.schemas[i];if(typeof o=="string"){const a=si.call(this,t,o);return typeof(a==null?void 0:a.schema)!="object"?void 0:Ci.call(this,n,a)}if(typeof(o==null?void 0:o.schema)=="object"){if(o.validate||qo.call(this,o),i===(0,ft.normalizeId)(e)){const{schema:a}=o,{schemaId:u}=this.opts,l=a[u];return l&&(s=(0,ft.resolveUrl)(this.opts.uriResolver,s,l)),new ri({schema:a,schemaId:u,root:t,baseId:s})}return Ci.call(this,n,o)}}Ze.resolveSchema=si;const UE=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Ci(t,{baseId:e,schema:n,root:r}){var s;if(((s=t.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(const a of t.fragment.slice(1).split("/")){if(typeof n=="boolean")return;const u=n[(0,Kl.unescapeFragment)(a)];if(u===void 0)return;n=u;const l=typeof n=="object"&&n[this.opts.schemaId];!UE.has(a)&&l&&(e=(0,ft.resolveUrl)(this.opts.uriResolver,e,l))}let i;if(typeof n!="boolean"&&n.$ref&&!(0,Kl.schemaHasRulesButRef)(n,this.RULES)){const a=(0,ft.resolveUrl)(this.opts.uriResolver,e,n.$ref);i=si.call(this,r,a)}const{schemaId:o}=this.opts;if(i=i||new ri({schema:n,schemaId:o,root:r,baseId:e}),i.schema!==i.root.schema)return i}const BE="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",xE="Meta-schema for $data reference (JSON AnySchema extension proposal)",VE="object",HE=["$data"],qE={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},WE=!1;var zE={$id:BE,description:xE,type:VE,required:HE,properties:qE,additionalProperties:WE},Wo={},Zi={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(t,e){(function(n,r){r(e)})(lu,function(n){function r(){for(var _=arguments.length,f=Array(_),y=0;y<_;y++)f[y]=arguments[y];if(f.length>1){f[0]=f[0].slice(0,-1);for(var k=f.length-1,R=1;R<k;++R)f[R]=f[R].slice(1,-1);return f[k]=f[k].slice(1),f.join("")}else return f[0]}function s(_){return"(?:"+_+")"}function i(_){return _===void 0?"undefined":_===null?"null":Object.prototype.toString.call(_).split(" ").pop().split("]").shift().toLowerCase()}function o(_){return _.toUpperCase()}function a(_){return _!=null?_ instanceof Array?_:typeof _.length!="number"||_.split||_.setInterval||_.call?[_]:Array.prototype.slice.call(_):[]}function u(_,f){var y=_;if(f)for(var k in f)y[k]=f[k];return y}function l(_){var f="[A-Za-z]",y="[0-9]",k=r(y,"[A-Fa-f]"),R=s(s("%[EFef]"+k+"%"+k+k+"%"+k+k)+"|"+s("%[89A-Fa-f]"+k+"%"+k+k)+"|"+s("%"+k+k)),K="[\\:\\/\\?\\#\\[\\]\\@]",G="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",he=r(K,G),Se=_?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",De=_?"[\\uE000-\\uF8FF]":"[]",ce=r(f,y,"[\\-\\.\\_\\~]",Se);s(f+r(f,y,"[\\+\\-\\.]")+"*"),s(s(R+"|"+r(ce,G,"[\\:]"))+"*");var we=s(s("25[0-5]")+"|"+s("2[0-4]"+y)+"|"+s("1"+y+y)+"|"+s("0?[1-9]"+y)+"|0?0?"+y),Pe=s(we+"\\."+we+"\\."+we+"\\."+we),re=s(k+"{1,4}"),Ae=s(s(re+"\\:"+re)+"|"+Pe),Me=s(s(re+"\\:")+"{6}"+Ae),Re=s("\\:\\:"+s(re+"\\:")+"{5}"+Ae),Vt=s(s(re)+"?\\:\\:"+s(re+"\\:")+"{4}"+Ae),Et=s(s(s(re+"\\:")+"{0,1}"+re)+"?\\:\\:"+s(re+"\\:")+"{3}"+Ae),bt=s(s(s(re+"\\:")+"{0,2}"+re)+"?\\:\\:"+s(re+"\\:")+"{2}"+Ae),Ln=s(s(s(re+"\\:")+"{0,3}"+re)+"?\\:\\:"+re+"\\:"+Ae),ln=s(s(s(re+"\\:")+"{0,4}"+re)+"?\\:\\:"+Ae),st=s(s(s(re+"\\:")+"{0,5}"+re)+"?\\:\\:"+re),wt=s(s(s(re+"\\:")+"{0,6}"+re)+"?\\:\\:"),un=s([Me,Re,Vt,Et,bt,Ln,ln,st,wt].join("|")),kt=s(s(ce+"|"+R)+"+");s("[vV]"+k+"+\\."+r(ce,G,"[\\:]")+"+"),s(s(R+"|"+r(ce,G))+"*");var _r=s(R+"|"+r(ce,G,"[\\:\\@]"));return s(s(R+"|"+r(ce,G,"[\\@]"))+"+"),s(s(_r+"|"+r("[\\/\\?]",De))+"*"),{NOT_SCHEME:new RegExp(r("[^]",f,y,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(r("[^\\%\\:]",ce,G),"g"),NOT_HOST:new RegExp(r("[^\\%\\[\\]\\:]",ce,G),"g"),NOT_PATH:new RegExp(r("[^\\%\\/\\:\\@]",ce,G),"g"),NOT_PATH_NOSCHEME:new RegExp(r("[^\\%\\/\\@]",ce,G),"g"),NOT_QUERY:new RegExp(r("[^\\%]",ce,G,"[\\:\\@\\/\\?]",De),"g"),NOT_FRAGMENT:new RegExp(r("[^\\%]",ce,G,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(r("[^]",ce,G),"g"),UNRESERVED:new RegExp(ce,"g"),OTHER_CHARS:new RegExp(r("[^\\%]",ce,he),"g"),PCT_ENCODED:new RegExp(R,"g"),IPV4ADDRESS:new RegExp("^("+Pe+")$"),IPV6ADDRESS:new RegExp("^\\[?("+un+")"+s(s("\\%25|\\%(?!"+k+"{2})")+"("+kt+")")+"?\\]?$")}}var c=l(!1),d=l(!0),p=function(){function _(f,y){var k=[],R=!0,K=!1,G=void 0;try{for(var he=f[Symbol.iterator](),Se;!(R=(Se=he.next()).done)&&(k.push(Se.value),!(y&&k.length===y));R=!0);}catch(De){K=!0,G=De}finally{try{!R&&he.return&&he.return()}finally{if(K)throw G}}return k}return function(f,y){if(Array.isArray(f))return f;if(Symbol.iterator in Object(f))return _(f,y);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),E=function(_){if(Array.isArray(_)){for(var f=0,y=Array(_.length);f<_.length;f++)y[f]=_[f];return y}else return Array.from(_)},v=2147483647,C=36,S=1,g=26,T=38,A=700,O=72,L=128,$="-",N=/^xn--/,F=/[^\0-\x7E]/,q=/[\x2E\u3002\uFF0E\uFF61]/g,W={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ye=C-S,ue=Math.floor,Y=String.fromCharCode;function j(_){throw new RangeError(W[_])}function U(_,f){for(var y=[],k=_.length;k--;)y[k]=f(_[k]);return y}function X(_,f){var y=_.split("@"),k="";y.length>1&&(k=y[0]+"@",_=y[1]),_=_.replace(q,".");var R=_.split("."),K=U(R,f).join(".");return k+K}function V(_){for(var f=[],y=0,k=_.length;y<k;){var R=_.charCodeAt(y++);if(R>=55296&&R<=56319&&y<k){var K=_.charCodeAt(y++);(K&64512)==56320?f.push(((R&1023)<<10)+(K&1023)+65536):(f.push(R),y--)}else f.push(R)}return f}var ee=function(f){return String.fromCodePoint.apply(String,E(f))},Z=function(f){return f-48<10?f-22:f-65<26?f-65:f-97<26?f-97:C},M=function(f,y){return f+22+75*(f<26)-((y!=0)<<5)},w=function(f,y,k){var R=0;for(f=k?ue(f/A):f>>1,f+=ue(f/y);f>ye*g>>1;R+=C)f=ue(f/ye);return ue(R+(ye+1)*f/(f+T))},P=function(f){var y=[],k=f.length,R=0,K=L,G=O,he=f.lastIndexOf($);he<0&&(he=0);for(var Se=0;Se<he;++Se)f.charCodeAt(Se)>=128&&j("not-basic"),y.push(f.charCodeAt(Se));for(var De=he>0?he+1:0;De<k;){for(var ce=R,we=1,Pe=C;;Pe+=C){De>=k&&j("invalid-input");var re=Z(f.charCodeAt(De++));(re>=C||re>ue((v-R)/we))&&j("overflow"),R+=re*we;var Ae=Pe<=G?S:Pe>=G+g?g:Pe-G;if(re<Ae)break;var Me=C-Ae;we>ue(v/Me)&&j("overflow"),we*=Me}var Re=y.length+1;G=w(R-ce,Re,ce==0),ue(R/Re)>v-K&&j("overflow"),K+=ue(R/Re),R%=Re,y.splice(R++,0,K)}return String.fromCodePoint.apply(String,y)},I=function(f){var y=[];f=V(f);var k=f.length,R=L,K=0,G=O,he=!0,Se=!1,De=void 0;try{for(var ce=f[Symbol.iterator](),we;!(he=(we=ce.next()).done);he=!0){var Pe=we.value;Pe<128&&y.push(Y(Pe))}}catch(gr){Se=!0,De=gr}finally{try{!he&&ce.return&&ce.return()}finally{if(Se)throw De}}var re=y.length,Ae=re;for(re&&y.push($);Ae<k;){var Me=v,Re=!0,Vt=!1,Et=void 0;try{for(var bt=f[Symbol.iterator](),Ln;!(Re=(Ln=bt.next()).done);Re=!0){var ln=Ln.value;ln>=R&&ln<Me&&(Me=ln)}}catch(gr){Vt=!0,Et=gr}finally{try{!Re&&bt.return&&bt.return()}finally{if(Vt)throw Et}}var st=Ae+1;Me-R>ue((v-K)/st)&&j("overflow"),K+=(Me-R)*st,R=Me;var wt=!0,un=!1,kt=void 0;try{for(var _r=f[Symbol.iterator](),Na;!(wt=(Na=_r.next()).done);wt=!0){var Da=Na.value;if(Da<R&&++K>v&&j("overflow"),Da==R){for(var is=K,os=C;;os+=C){var as=os<=G?S:os>=G+g?g:os-G;if(is<as)break;var Pa=is-as,Oa=C-as;y.push(Y(M(as+Pa%Oa,0))),is=ue(Pa/Oa)}y.push(Y(M(is,0))),G=w(K,st,Ae==re),K=0,++Ae}}}catch(gr){un=!0,kt=gr}finally{try{!wt&&_r.return&&_r.return()}finally{if(un)throw kt}}++K,++R}return y.join("")},h=function(f){return X(f,function(y){return N.test(y)?P(y.slice(4).toLowerCase()):y})},m=function(f){return X(f,function(y){return F.test(y)?"xn--"+I(y):y})},D={version:"2.1.0",ucs2:{decode:V,encode:ee},decode:P,encode:I,toASCII:m,toUnicode:h},B={};function H(_){var f=_.charCodeAt(0),y=void 0;return f<16?y="%0"+f.toString(16).toUpperCase():f<128?y="%"+f.toString(16).toUpperCase():f<2048?y="%"+(f>>6|192).toString(16).toUpperCase()+"%"+(f&63|128).toString(16).toUpperCase():y="%"+(f>>12|224).toString(16).toUpperCase()+"%"+(f>>6&63|128).toString(16).toUpperCase()+"%"+(f&63|128).toString(16).toUpperCase(),y}function J(_){for(var f="",y=0,k=_.length;y<k;){var R=parseInt(_.substr(y+1,2),16);if(R<128)f+=String.fromCharCode(R),y+=3;else if(R>=194&&R<224){if(k-y>=6){var K=parseInt(_.substr(y+4,2),16);f+=String.fromCharCode((R&31)<<6|K&63)}else f+=_.substr(y,6);y+=6}else if(R>=224){if(k-y>=9){var G=parseInt(_.substr(y+4,2),16),he=parseInt(_.substr(y+7,2),16);f+=String.fromCharCode((R&15)<<12|(G&63)<<6|he&63)}else f+=_.substr(y,9);y+=9}else f+=_.substr(y,3),y+=3}return f}function ne(_,f){function y(k){var R=J(k);return R.match(f.UNRESERVED)?R:k}return _.scheme&&(_.scheme=String(_.scheme).replace(f.PCT_ENCODED,y).toLowerCase().replace(f.NOT_SCHEME,"")),_.userinfo!==void 0&&(_.userinfo=String(_.userinfo).replace(f.PCT_ENCODED,y).replace(f.NOT_USERINFO,H).replace(f.PCT_ENCODED,o)),_.host!==void 0&&(_.host=String(_.host).replace(f.PCT_ENCODED,y).toLowerCase().replace(f.NOT_HOST,H).replace(f.PCT_ENCODED,o)),_.path!==void 0&&(_.path=String(_.path).replace(f.PCT_ENCODED,y).replace(_.scheme?f.NOT_PATH:f.NOT_PATH_NOSCHEME,H).replace(f.PCT_ENCODED,o)),_.query!==void 0&&(_.query=String(_.query).replace(f.PCT_ENCODED,y).replace(f.NOT_QUERY,H).replace(f.PCT_ENCODED,o)),_.fragment!==void 0&&(_.fragment=String(_.fragment).replace(f.PCT_ENCODED,y).replace(f.NOT_FRAGMENT,H).replace(f.PCT_ENCODED,o)),_}function be(_){return _.replace(/^0*(.*)/,"$1")||"0"}function Ge(_,f){var y=_.match(f.IPV4ADDRESS)||[],k=p(y,2),R=k[1];return R?R.split(".").map(be).join("."):_}function Nn(_,f){var y=_.match(f.IPV6ADDRESS)||[],k=p(y,3),R=k[1],K=k[2];if(R){for(var G=R.toLowerCase().split("::").reverse(),he=p(G,2),Se=he[0],De=he[1],ce=De?De.split(":").map(be):[],we=Se.split(":").map(be),Pe=f.IPV4ADDRESS.test(we[we.length-1]),re=Pe?7:8,Ae=we.length-re,Me=Array(re),Re=0;Re<re;++Re)Me[Re]=ce[Re]||we[Ae+Re]||"";Pe&&(Me[re-1]=Ge(Me[re-1],f));var Vt=Me.reduce(function(st,wt,un){if(!wt||wt==="0"){var kt=st[st.length-1];kt&&kt.index+kt.length===un?kt.length++:st.push({index:un,length:1})}return st},[]),Et=Vt.sort(function(st,wt){return wt.length-st.length})[0],bt=void 0;if(Et&&Et.length>1){var Ln=Me.slice(0,Et.index),ln=Me.slice(Et.index+Et.length);bt=Ln.join(":")+"::"+ln.join(":")}else bt=Me.join(":");return K&&(bt+="%"+K),bt}else return _}var ur=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,cr="".match(/(){0}/)[1]===void 0;function tt(_){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y={},k=f.iri!==!1?d:c;f.reference==="suffix"&&(_=(f.scheme?f.scheme+":":"")+"//"+_);var R=_.match(ur);if(R){cr?(y.scheme=R[1],y.userinfo=R[3],y.host=R[4],y.port=parseInt(R[5],10),y.path=R[6]||"",y.query=R[7],y.fragment=R[8],isNaN(y.port)&&(y.port=R[5])):(y.scheme=R[1]||void 0,y.userinfo=_.indexOf("@")!==-1?R[3]:void 0,y.host=_.indexOf("//")!==-1?R[4]:void 0,y.port=parseInt(R[5],10),y.path=R[6]||"",y.query=_.indexOf("?")!==-1?R[7]:void 0,y.fragment=_.indexOf("#")!==-1?R[8]:void 0,isNaN(y.port)&&(y.port=_.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?R[4]:void 0)),y.host&&(y.host=Nn(Ge(y.host,k),k)),y.scheme===void 0&&y.userinfo===void 0&&y.host===void 0&&y.port===void 0&&!y.path&&y.query===void 0?y.reference="same-document":y.scheme===void 0?y.reference="relative":y.fragment===void 0?y.reference="absolute":y.reference="uri",f.reference&&f.reference!=="suffix"&&f.reference!==y.reference&&(y.error=y.error||"URI is not a "+f.reference+" reference.");var K=B[(f.scheme||y.scheme||"").toLowerCase()];if(!f.unicodeSupport&&(!K||!K.unicodeSupport)){if(y.host&&(f.domainHost||K&&K.domainHost))try{y.host=D.toASCII(y.host.replace(k.PCT_ENCODED,J).toLowerCase())}catch(G){y.error=y.error||"Host's domain name can not be converted to ASCII via punycode: "+G}ne(y,c)}else ne(y,k);K&&K.parse&&K.parse(y,f)}else y.error=y.error||"URI can not be parsed.";return y}function dr(_,f){var y=f.iri!==!1?d:c,k=[];return _.userinfo!==void 0&&(k.push(_.userinfo),k.push("@")),_.host!==void 0&&k.push(Nn(Ge(String(_.host),y),y).replace(y.IPV6ADDRESS,function(R,K,G){return"["+K+(G?"%25"+G:"")+"]"})),(typeof _.port=="number"||typeof _.port=="string")&&(k.push(":"),k.push(String(_.port))),k.length?k.join(""):void 0}var Dn=/^\.\.?\//,Pn=/^\/\.(\/|$)/,On=/^\/\.\.(\/|$)/,hr=/^\/?(?:.|\n)*?(?=\/|$)/;function yt(_){for(var f=[];_.length;)if(_.match(Dn))_=_.replace(Dn,"");else if(_.match(Pn))_=_.replace(Pn,"/");else if(_.match(On))_=_.replace(On,"/"),f.pop();else if(_==="."||_==="..")_="";else{var y=_.match(hr);if(y){var k=y[0];_=_.slice(k.length),f.push(k)}else throw new Error("Unexpected dot segment condition")}return f.join("")}function Qe(_){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=f.iri?d:c,k=[],R=B[(f.scheme||_.scheme||"").toLowerCase()];if(R&&R.serialize&&R.serialize(_,f),_.host&&!y.IPV6ADDRESS.test(_.host)){if(f.domainHost||R&&R.domainHost)try{_.host=f.iri?D.toUnicode(_.host):D.toASCII(_.host.replace(y.PCT_ENCODED,J).toLowerCase())}catch(he){_.error=_.error||"Host's domain name can not be converted to "+(f.iri?"Unicode":"ASCII")+" via punycode: "+he}}ne(_,y),f.reference!=="suffix"&&_.scheme&&(k.push(_.scheme),k.push(":"));var K=dr(_,f);if(K!==void 0&&(f.reference!=="suffix"&&k.push("//"),k.push(K),_.path&&_.path.charAt(0)!=="/"&&k.push("/")),_.path!==void 0){var G=_.path;!f.absolutePath&&(!R||!R.absolutePath)&&(G=yt(G)),K===void 0&&(G=G.replace(/^\/\//,"/%2F")),k.push(G)}return _.query!==void 0&&(k.push("?"),k.push(_.query)),_.fragment!==void 0&&(k.push("#"),k.push(_.fragment)),k.join("")}function Mn(_,f){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},k=arguments[3],R={};return k||(_=tt(Qe(_,y),y),f=tt(Qe(f,y),y)),y=y||{},!y.tolerant&&f.scheme?(R.scheme=f.scheme,R.userinfo=f.userinfo,R.host=f.host,R.port=f.port,R.path=yt(f.path||""),R.query=f.query):(f.userinfo!==void 0||f.host!==void 0||f.port!==void 0?(R.userinfo=f.userinfo,R.host=f.host,R.port=f.port,R.path=yt(f.path||""),R.query=f.query):(f.path?(f.path.charAt(0)==="/"?R.path=yt(f.path):((_.userinfo!==void 0||_.host!==void 0||_.port!==void 0)&&!_.path?R.path="/"+f.path:_.path?R.path=_.path.slice(0,_.path.lastIndexOf("/")+1)+f.path:R.path=f.path,R.path=yt(R.path)),R.query=f.query):(R.path=_.path,f.query!==void 0?R.query=f.query:R.query=_.query),R.userinfo=_.userinfo,R.host=_.host,R.port=_.port),R.scheme=_.scheme),R.fragment=f.fragment,R}function fr(_,f,y){var k=u({scheme:"null"},y);return Qe(Mn(tt(_,k),tt(f,k),k,!0),k)}function on(_,f){return typeof _=="string"?_=Qe(tt(_,f),f):i(_)==="object"&&(_=tt(Qe(_,f),f)),_}function pr(_,f,y){return typeof _=="string"?_=Qe(tt(_,y),y):i(_)==="object"&&(_=Qe(_,y)),typeof f=="string"?f=Qe(tt(f,y),y):i(f)==="object"&&(f=Qe(f,y)),_===f}function ss(_,f){return _&&_.toString().replace(!f||!f.iri?c.ESCAPE:d.ESCAPE,H)}function rt(_,f){return _&&_.toString().replace(!f||!f.iri?c.PCT_ENCODED:d.PCT_ENCODED,J)}var an={scheme:"http",domainHost:!0,parse:function(f,y){return f.host||(f.error=f.error||"HTTP URIs must have a host."),f},serialize:function(f,y){var k=String(f.scheme).toLowerCase()==="https";return(f.port===(k?443:80)||f.port==="")&&(f.port=void 0),f.path||(f.path="/"),f}},Sa={scheme:"https",domainHost:an.domainHost,parse:an.parse,serialize:an.serialize};function Ca(_){return typeof _.secure=="boolean"?_.secure:String(_.scheme).toLowerCase()==="wss"}var mr={scheme:"ws",domainHost:!0,parse:function(f,y){var k=f;return k.secure=Ca(k),k.resourceName=(k.path||"/")+(k.query?"?"+k.query:""),k.path=void 0,k.query=void 0,k},serialize:function(f,y){if((f.port===(Ca(f)?443:80)||f.port==="")&&(f.port=void 0),typeof f.secure=="boolean"&&(f.scheme=f.secure?"wss":"ws",f.secure=void 0),f.resourceName){var k=f.resourceName.split("?"),R=p(k,2),K=R[0],G=R[1];f.path=K&&K!=="/"?K:void 0,f.query=G,f.resourceName=void 0}return f.fragment=void 0,f}},Ia={scheme:"wss",domainHost:mr.domainHost,parse:mr.parse,serialize:mr.serialize},zd={},$a="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",vt="[0-9A-Fa-f]",Kd=s(s("%[EFef]"+vt+"%"+vt+vt+"%"+vt+vt)+"|"+s("%[89A-Fa-f]"+vt+"%"+vt+vt)+"|"+s("%"+vt+vt)),Gd="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Yd="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Jd=r(Yd,'[\\"\\\\]'),Qd="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Xd=new RegExp($a,"g"),Fn=new RegExp(Kd,"g"),Zd=new RegExp(r("[^]",Gd,"[\\.]",'[\\"]',Jd),"g"),Ta=new RegExp(r("[^]",$a,Qd),"g"),eh=Ta;function oi(_){var f=J(_);return f.match(Xd)?f:_}var Aa={scheme:"mailto",parse:function(f,y){var k=f,R=k.to=k.path?k.path.split(","):[];if(k.path=void 0,k.query){for(var K=!1,G={},he=k.query.split("&"),Se=0,De=he.length;Se<De;++Se){var ce=he[Se].split("=");switch(ce[0]){case"to":for(var we=ce[1].split(","),Pe=0,re=we.length;Pe<re;++Pe)R.push(we[Pe]);break;case"subject":k.subject=rt(ce[1],y);break;case"body":k.body=rt(ce[1],y);break;default:K=!0,G[rt(ce[0],y)]=rt(ce[1],y);break}}K&&(k.headers=G)}k.query=void 0;for(var Ae=0,Me=R.length;Ae<Me;++Ae){var Re=R[Ae].split("@");if(Re[0]=rt(Re[0]),y.unicodeSupport)Re[1]=rt(Re[1],y).toLowerCase();else try{Re[1]=D.toASCII(rt(Re[1],y).toLowerCase())}catch(Vt){k.error=k.error||"Email address's domain name can not be converted to ASCII via punycode: "+Vt}R[Ae]=Re.join("@")}return k},serialize:function(f,y){var k=f,R=a(f.to);if(R){for(var K=0,G=R.length;K<G;++K){var he=String(R[K]),Se=he.lastIndexOf("@"),De=he.slice(0,Se).replace(Fn,oi).replace(Fn,o).replace(Zd,H),ce=he.slice(Se+1);try{ce=y.iri?D.toUnicode(ce):D.toASCII(rt(ce,y).toLowerCase())}catch(Ae){k.error=k.error||"Email address's domain name can not be converted to "+(y.iri?"Unicode":"ASCII")+" via punycode: "+Ae}R[K]=De+"@"+ce}k.path=R.join(",")}var we=f.headers=f.headers||{};f.subject&&(we.subject=f.subject),f.body&&(we.body=f.body);var Pe=[];for(var re in we)we[re]!==zd[re]&&Pe.push(re.replace(Fn,oi).replace(Fn,o).replace(Ta,H)+"="+we[re].replace(Fn,oi).replace(Fn,o).replace(eh,H));return Pe.length&&(k.query=Pe.join("&")),k}},th=/^([^\:]+)\:(.*)/,Ra={scheme:"urn",parse:function(f,y){var k=f.path&&f.path.match(th),R=f;if(k){var K=y.scheme||R.scheme||"urn",G=k[1].toLowerCase(),he=k[2],Se=K+":"+(y.nid||G),De=B[Se];R.nid=G,R.nss=he,R.path=void 0,De&&(R=De.parse(R,y))}else R.error=R.error||"URN can not be parsed.";return R},serialize:function(f,y){var k=y.scheme||f.scheme||"urn",R=f.nid,K=k+":"+(y.nid||R),G=B[K];G&&(f=G.serialize(f,y));var he=f,Se=f.nss;return he.path=(R||y.nid)+":"+Se,he}},nh=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,ka={scheme:"urn:uuid",parse:function(f,y){var k=f;return k.uuid=k.nss,k.nss=void 0,!y.tolerant&&(!k.uuid||!k.uuid.match(nh))&&(k.error=k.error||"UUID is not valid."),k},serialize:function(f,y){var k=f;return k.nss=(f.uuid||"").toLowerCase(),k}};B[an.scheme]=an,B[Sa.scheme]=Sa,B[mr.scheme]=mr,B[Ia.scheme]=Ia,B[Aa.scheme]=Aa,B[Ra.scheme]=Ra,B[ka.scheme]=ka,n.SCHEMES=B,n.pctEncChar=H,n.pctDecChars=J,n.parse=tt,n.removeDotSegments=yt,n.serialize=Qe,n.resolveComponents=Mn,n.resolve=fr,n.normalize=on,n.equal=pr,n.escapeComponent=ss,n.unescapeComponent=rt,Object.defineProperty(n,"__esModule",{value:!0})})})(Zi,Zi.exports);Object.defineProperty(Wo,"__esModule",{value:!0});const Md=Zi.exports;Md.code='require("ajv/dist/runtime/uri").default';Wo.default=Md;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var e=_t;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return e.KeywordCxt}});var n=le;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return n.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return n.CodeGen}});const r=ti,s=ni,i=Tn,o=Ze,a=le,u=xe,l=ns,c=me,d=zE,p=Wo,E=(M,w)=>new RegExp(M,w);E.code="new RegExp";const v=["removeAdditional","useDefaults","coerceTypes"],C=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),S={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},g={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},T=200;function A(M){var w,P,I,h,m,D,B,H,J,ne,be,Ge,Nn,ur,cr,tt,dr,Dn,Pn,On,hr,yt,Qe,Mn,fr;const on=M.strict,pr=(w=M.code)===null||w===void 0?void 0:w.optimize,ss=pr===!0||pr===void 0?1:pr||0,rt=(I=(P=M.code)===null||P===void 0?void 0:P.regExp)!==null&&I!==void 0?I:E,an=(h=M.uriResolver)!==null&&h!==void 0?h:p.default;return{strictSchema:(D=(m=M.strictSchema)!==null&&m!==void 0?m:on)!==null&&D!==void 0?D:!0,strictNumbers:(H=(B=M.strictNumbers)!==null&&B!==void 0?B:on)!==null&&H!==void 0?H:!0,strictTypes:(ne=(J=M.strictTypes)!==null&&J!==void 0?J:on)!==null&&ne!==void 0?ne:"log",strictTuples:(Ge=(be=M.strictTuples)!==null&&be!==void 0?be:on)!==null&&Ge!==void 0?Ge:"log",strictRequired:(ur=(Nn=M.strictRequired)!==null&&Nn!==void 0?Nn:on)!==null&&ur!==void 0?ur:!1,code:M.code?Nt(Ue({},M.code),{optimize:ss,regExp:rt}):{optimize:ss,regExp:rt},loopRequired:(cr=M.loopRequired)!==null&&cr!==void 0?cr:T,loopEnum:(tt=M.loopEnum)!==null&&tt!==void 0?tt:T,meta:(dr=M.meta)!==null&&dr!==void 0?dr:!0,messages:(Dn=M.messages)!==null&&Dn!==void 0?Dn:!0,inlineRefs:(Pn=M.inlineRefs)!==null&&Pn!==void 0?Pn:!0,schemaId:(On=M.schemaId)!==null&&On!==void 0?On:"$id",addUsedSchema:(hr=M.addUsedSchema)!==null&&hr!==void 0?hr:!0,validateSchema:(yt=M.validateSchema)!==null&&yt!==void 0?yt:!0,validateFormats:(Qe=M.validateFormats)!==null&&Qe!==void 0?Qe:!0,unicodeRegExp:(Mn=M.unicodeRegExp)!==null&&Mn!==void 0?Mn:!0,int32range:(fr=M.int32range)!==null&&fr!==void 0?fr:!0,uriResolver:an}}class O{constructor(w={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,w=this.opts=Ue(Ue({},w),A(w));const{es5:P,lines:I}=this.opts.code;this.scope=new a.ValueScope({scope:{},prefixes:C,es5:P,lines:I}),this.logger=ue(w.logger);const h=w.validateFormats;w.validateFormats=!1,this.RULES=(0,i.getRules)(),L.call(this,S,w,"NOT SUPPORTED"),L.call(this,g,w,"DEPRECATED","warn"),this._metaOpts=W.call(this),w.formats&&F.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),w.keywords&&q.call(this,w.keywords),typeof w.meta=="object"&&this.addMetaSchema(w.meta),N.call(this),w.validateFormats=h}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:w,meta:P,schemaId:I}=this.opts;let h=d;I==="id"&&(h=Ue({},d),h.id=h.$id,delete h.$id),P&&w&&this.addMetaSchema(h,h[I],!1)}defaultMeta(){const{meta:w,schemaId:P}=this.opts;return this.opts.defaultMeta=typeof w=="object"?w[P]||w:void 0}validate(w,P){let I;if(typeof w=="string"){if(I=this.getSchema(w),!I)throw new Error(`no schema with key or ref "${w}"`)}else I=this.compile(w);const h=I(P);return"$async"in I||(this.errors=I.errors),h}compile(w,P){const I=this._addSchema(w,P);return I.validate||this._compileSchemaEnv(I)}compileAsync(w,P){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:I}=this.opts;return h.call(this,w,P);async function h(ne,be){await m.call(this,ne.$schema);const Ge=this._addSchema(ne,be);return Ge.validate||D.call(this,Ge)}async function m(ne){ne&&!this.getSchema(ne)&&await h.call(this,{$ref:ne},!0)}async function D(ne){try{return this._compileSchemaEnv(ne)}catch(be){if(!(be instanceof s.default))throw be;return B.call(this,be),await H.call(this,be.missingSchema),D.call(this,ne)}}function B({missingSchema:ne,missingRef:be}){if(this.refs[ne])throw new Error(`AnySchema ${ne} is loaded but ${be} cannot be resolved`)}async function H(ne){const be=await J.call(this,ne);this.refs[ne]||await m.call(this,be.$schema),this.refs[ne]||this.addSchema(be,ne,P)}async function J(ne){const be=this._loading[ne];if(be)return be;try{return await(this._loading[ne]=I(ne))}finally{delete this._loading[ne]}}}addSchema(w,P,I,h=this.opts.validateSchema){if(Array.isArray(w)){for(const D of w)this.addSchema(D,void 0,I,h);return this}let m;if(typeof w=="object"){const{schemaId:D}=this.opts;if(m=w[D],m!==void 0&&typeof m!="string")throw new Error(`schema ${D} must be string`)}return P=(0,u.normalizeId)(P||m),this._checkUnique(P),this.schemas[P]=this._addSchema(w,I,P,h,!0),this}addMetaSchema(w,P,I=this.opts.validateSchema){return this.addSchema(w,P,!0,I),this}validateSchema(w,P){if(typeof w=="boolean")return!0;let I;if(I=w.$schema,I!==void 0&&typeof I!="string")throw new Error("$schema must be a string");if(I=I||this.opts.defaultMeta||this.defaultMeta(),!I)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const h=this.validate(I,w);if(!h&&P){const m="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(m);else throw new Error(m)}return h}getSchema(w){let P;for(;typeof(P=$.call(this,w))=="string";)w=P;if(P===void 0){const{schemaId:I}=this.opts,h=new o.SchemaEnv({schema:{},schemaId:I});if(P=o.resolveSchema.call(this,h,w),!P)return;this.refs[w]=P}return P.validate||this._compileSchemaEnv(P)}removeSchema(w){if(w instanceof RegExp)return this._removeAllSchemas(this.schemas,w),this._removeAllSchemas(this.refs,w),this;switch(typeof w){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const P=$.call(this,w);return typeof P=="object"&&this._cache.delete(P.schema),delete this.schemas[w],delete this.refs[w],this}case"object":{const P=w;this._cache.delete(P);let I=w[this.opts.schemaId];return I&&(I=(0,u.normalizeId)(I),delete this.schemas[I],delete this.refs[I]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(w){for(const P of w)this.addKeyword(P);return this}addKeyword(w,P){let I;if(typeof w=="string")I=w,typeof P=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),P.keyword=I);else if(typeof w=="object"&&P===void 0){if(P=w,I=P.keyword,Array.isArray(I)&&!I.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(j.call(this,I,P),!P)return(0,c.eachItem)(I,m=>U.call(this,m)),this;V.call(this,P);const h=Nt(Ue({},P),{type:(0,l.getJSONTypes)(P.type),schemaType:(0,l.getJSONTypes)(P.schemaType)});return(0,c.eachItem)(I,h.type.length===0?m=>U.call(this,m,h):m=>h.type.forEach(D=>U.call(this,m,h,D))),this}getKeyword(w){const P=this.RULES.all[w];return typeof P=="object"?P.definition:!!P}removeKeyword(w){const{RULES:P}=this;delete P.keywords[w],delete P.all[w];for(const I of P.rules){const h=I.rules.findIndex(m=>m.keyword===w);h>=0&&I.rules.splice(h,1)}return this}addFormat(w,P){return typeof P=="string"&&(P=new RegExp(P)),this.formats[w]=P,this}errorsText(w=this.errors,{separator:P=", ",dataVar:I="data"}={}){return!w||w.length===0?"No errors":w.map(h=>`${I}${h.instancePath} ${h.message}`).reduce((h,m)=>h+P+m)}$dataMetaSchema(w,P){const I=this.RULES.all;w=JSON.parse(JSON.stringify(w));for(const h of P){const m=h.split("/").slice(1);let D=w;for(const B of m)D=D[B];for(const B in I){const H=I[B];if(typeof H!="object")continue;const{$data:J}=H.definition,ne=D[B];J&&ne&&(D[B]=Z(ne))}}return w}_removeAllSchemas(w,P){for(const I in w){const h=w[I];(!P||P.test(I))&&(typeof h=="string"?delete w[I]:h&&!h.meta&&(this._cache.delete(h.schema),delete w[I]))}}_addSchema(w,P,I,h=this.opts.validateSchema,m=this.opts.addUsedSchema){let D;const{schemaId:B}=this.opts;if(typeof w=="object")D=w[B];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof w!="boolean")throw new Error("schema must be object or boolean")}let H=this._cache.get(w);if(H!==void 0)return H;I=(0,u.normalizeId)(D||I);const J=u.getSchemaRefs.call(this,w,I);return H=new o.SchemaEnv({schema:w,schemaId:B,meta:P,baseId:I,localRefs:J}),this._cache.set(H.schema,H),m&&!I.startsWith("#")&&(I&&this._checkUnique(I),this.refs[I]=H),h&&this.validateSchema(w,!0),H}_checkUnique(w){if(this.schemas[w]||this.refs[w])throw new Error(`schema with key or id "${w}" already exists`)}_compileSchemaEnv(w){if(w.meta?this._compileMetaSchema(w):o.compileSchema.call(this,w),!w.validate)throw new Error("ajv implementation error");return w.validate}_compileMetaSchema(w){const P=this.opts;this.opts=this._metaOpts;try{o.compileSchema.call(this,w)}finally{this.opts=P}}}t.default=O,O.ValidationError=r.default,O.MissingRefError=s.default;function L(M,w,P,I="error"){for(const h in M){const m=h;m in w&&this.logger[I](`${P}: option ${h}. ${M[m]}`)}}function $(M){return M=(0,u.normalizeId)(M),this.schemas[M]||this.refs[M]}function N(){const M=this.opts.schemas;if(!!M)if(Array.isArray(M))this.addSchema(M);else for(const w in M)this.addSchema(M[w],w)}function F(){for(const M in this.opts.formats){const w=this.opts.formats[M];w&&this.addFormat(M,w)}}function q(M){if(Array.isArray(M)){this.addVocabulary(M);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const w in M){const P=M[w];P.keyword||(P.keyword=w),this.addKeyword(P)}}function W(){const M=Ue({},this.opts);for(const w of v)delete M[w];return M}const ye={log(){},warn(){},error(){}};function ue(M){if(M===!1)return ye;if(M===void 0)return console;if(M.log&&M.warn&&M.error)return M;throw new Error("logger must implement log, warn and error methods")}const Y=/^[a-z_$][a-z0-9_$:-]*$/i;function j(M,w){const{RULES:P}=this;if((0,c.eachItem)(M,I=>{if(P.keywords[I])throw new Error(`Keyword ${I} is already defined`);if(!Y.test(I))throw new Error(`Keyword ${I} has invalid name`)}),!!w&&w.$data&&!("code"in w||"validate"in w))throw new Error('$data keyword must have "code" or "validate" function')}function U(M,w,P){var I;const h=w==null?void 0:w.post;if(P&&h)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:m}=this;let D=h?m.post:m.rules.find(({type:H})=>H===P);if(D||(D={type:P,rules:[]},m.rules.push(D)),m.keywords[M]=!0,!w)return;const B={keyword:M,definition:Nt(Ue({},w),{type:(0,l.getJSONTypes)(w.type),schemaType:(0,l.getJSONTypes)(w.schemaType)})};w.before?X.call(this,D,B,w.before):D.rules.push(B),m.all[M]=B,(I=w.implements)===null||I===void 0||I.forEach(H=>this.addKeyword(H))}function X(M,w,P){const I=M.rules.findIndex(h=>h.keyword===P);I>=0?M.rules.splice(I,0,w):(M.rules.push(w),this.logger.warn(`rule ${P} is not defined`))}function V(M){let{metaSchema:w}=M;w!==void 0&&(M.$data&&this.opts.$data&&(w=Z(w)),M.validateSchema=this.compile(w,!0))}const ee={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Z(M){return{anyOf:[M,ee]}}})(dd);var zo={},Ko={},Go={};Object.defineProperty(Go,"__esModule",{value:!0});const KE={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Go.default=KE;var An={};Object.defineProperty(An,"__esModule",{value:!0});An.callRef=An.getValidate=void 0;const GE=ni,Gl=ae,Xe=le,Bn=Rt,Yl=Ze,ds=me,YE={keyword:"$ref",schemaType:"string",code(t){const{gen:e,schema:n,it:r}=t,{baseId:s,schemaEnv:i,validateName:o,opts:a,self:u}=r,{root:l}=i;if((n==="#"||n==="#/")&&s===l.baseId)return d();const c=Yl.resolveRef.call(u,l,s,n);if(c===void 0)throw new GE.default(r.opts.uriResolver,s,n);if(c instanceof Yl.SchemaEnv)return p(c);return E(c);function d(){if(i===l)return bs(t,o,i,i.$async);const v=e.scopeValue("root",{ref:l});return bs(t,(0,Xe._)`${v}.validate`,l,l.$async)}function p(v){const C=Fd(t,v);bs(t,C,v,v.$async)}function E(v){const C=e.scopeValue("schema",a.code.source===!0?{ref:v,code:(0,Xe.stringify)(v)}:{ref:v}),S=e.name("valid"),g=t.subschema({schema:v,dataTypes:[],schemaPath:Xe.nil,topSchemaRef:C,errSchemaPath:n},S);t.mergeEvaluated(g),t.ok(S)}}};function Fd(t,e){const{gen:n}=t;return e.validate?n.scopeValue("validate",{ref:e.validate}):(0,Xe._)`${n.scopeValue("wrapper",{ref:e})}.validate`}An.getValidate=Fd;function bs(t,e,n,r){const{gen:s,it:i}=t,{allErrors:o,schemaEnv:a,opts:u}=i,l=u.passContext?Bn.default.this:Xe.nil;r?c():d();function c(){if(!a.$async)throw new Error("async schema referenced by sync schema");const v=s.let("valid");s.try(()=>{s.code((0,Xe._)`await ${(0,Gl.callValidateCode)(t,e,l)}`),E(e),o||s.assign(v,!0)},C=>{s.if((0,Xe._)`!(${C} instanceof ${i.ValidationError})`,()=>s.throw(C)),p(C),o||s.assign(v,!1)}),t.ok(v)}function d(){t.result((0,Gl.callValidateCode)(t,e,l),()=>E(e),()=>p(e))}function p(v){const C=(0,Xe._)`${v}.errors`;s.assign(Bn.default.vErrors,(0,Xe._)`${Bn.default.vErrors} === null ? ${C} : ${Bn.default.vErrors}.concat(${C})`),s.assign(Bn.default.errors,(0,Xe._)`${Bn.default.vErrors}.length`)}function E(v){var C;if(!i.opts.unevaluated)return;const S=(C=n==null?void 0:n.validate)===null||C===void 0?void 0:C.evaluated;if(i.props!==!0)if(S&&!S.dynamicProps)S.props!==void 0&&(i.props=ds.mergeEvaluated.props(s,S.props,i.props));else{const g=s.var("props",(0,Xe._)`${v}.evaluated.props`);i.props=ds.mergeEvaluated.props(s,g,i.props,Xe.Name)}if(i.items!==!0)if(S&&!S.dynamicItems)S.items!==void 0&&(i.items=ds.mergeEvaluated.items(s,S.items,i.items));else{const g=s.var("items",(0,Xe._)`${v}.evaluated.items`);i.items=ds.mergeEvaluated.items(s,g,i.items,Xe.Name)}}}An.callRef=bs;An.default=YE;Object.defineProperty(Ko,"__esModule",{value:!0});const JE=Go,QE=An,XE=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",JE.default,QE.default];Ko.default=XE;var Yo={},Jo={};Object.defineProperty(Jo,"__esModule",{value:!0});const Bs=le,Wt=Bs.operators,xs={maximum:{okStr:"<=",ok:Wt.LTE,fail:Wt.GT},minimum:{okStr:">=",ok:Wt.GTE,fail:Wt.LT},exclusiveMaximum:{okStr:"<",ok:Wt.LT,fail:Wt.GTE},exclusiveMinimum:{okStr:">",ok:Wt.GT,fail:Wt.LTE}},ZE={message:({keyword:t,schemaCode:e})=>(0,Bs.str)`must be ${xs[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Bs._)`{comparison: ${xs[t].okStr}, limit: ${e}}`},eb={keyword:Object.keys(xs),type:"number",schemaType:"number",$data:!0,error:ZE,code(t){const{keyword:e,data:n,schemaCode:r}=t;t.fail$data((0,Bs._)`${n} ${xs[e].fail} ${r} || isNaN(${n})`)}};Jo.default=eb;var Qo={};Object.defineProperty(Qo,"__esModule",{value:!0});const kr=le,tb={message:({schemaCode:t})=>(0,kr.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,kr._)`{multipleOf: ${t}}`},nb={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:tb,code(t){const{gen:e,data:n,schemaCode:r,it:s}=t,i=s.opts.multipleOfPrecision,o=e.let("res"),a=i?(0,kr._)`Math.abs(Math.round(${o}) - ${o}) > 1e-${i}`:(0,kr._)`${o} !== parseInt(${o})`;t.fail$data((0,kr._)`(${r} === 0 || (${o} = ${n}/${r}, ${a}))`)}};Qo.default=nb;var Xo={},Zo={};Object.defineProperty(Zo,"__esModule",{value:!0});function Ld(t){const e=t.length;let n=0,r=0,s;for(;r<e;)n++,s=t.charCodeAt(r++),s>=55296&&s<=56319&&r<e&&(s=t.charCodeAt(r),(s&64512)===56320&&r++);return n}Zo.default=Ld;Ld.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(Xo,"__esModule",{value:!0});const pn=le,rb=me,sb=Zo,ib={message({keyword:t,schemaCode:e}){const n=t==="maxLength"?"more":"fewer";return(0,pn.str)`must NOT have ${n} than ${e} characters`},params:({schemaCode:t})=>(0,pn._)`{limit: ${t}}`},ob={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:ib,code(t){const{keyword:e,data:n,schemaCode:r,it:s}=t,i=e==="maxLength"?pn.operators.GT:pn.operators.LT,o=s.opts.unicode===!1?(0,pn._)`${n}.length`:(0,pn._)`${(0,rb.useFunc)(t.gen,sb.default)}(${n})`;t.fail$data((0,pn._)`${o} ${i} ${r}`)}};Xo.default=ob;var ea={};Object.defineProperty(ea,"__esModule",{value:!0});const ab=ae,Vs=le,lb={message:({schemaCode:t})=>(0,Vs.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,Vs._)`{pattern: ${t}}`},ub={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:lb,code(t){const{data:e,$data:n,schema:r,schemaCode:s,it:i}=t,o=i.opts.unicodeRegExp?"u":"",a=n?(0,Vs._)`(new RegExp(${s}, ${o}))`:(0,ab.usePattern)(t,r);t.fail$data((0,Vs._)`!${a}.test(${e})`)}};ea.default=ub;var ta={};Object.defineProperty(ta,"__esModule",{value:!0});const Nr=le,cb={message({keyword:t,schemaCode:e}){const n=t==="maxProperties"?"more":"fewer";return(0,Nr.str)`must NOT have ${n} than ${e} properties`},params:({schemaCode:t})=>(0,Nr._)`{limit: ${t}}`},db={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:cb,code(t){const{keyword:e,data:n,schemaCode:r}=t,s=e==="maxProperties"?Nr.operators.GT:Nr.operators.LT;t.fail$data((0,Nr._)`Object.keys(${n}).length ${s} ${r}`)}};ta.default=db;var na={};Object.defineProperty(na,"__esModule",{value:!0});const Sr=ae,Dr=le,hb=me,fb={message:({params:{missingProperty:t}})=>(0,Dr.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,Dr._)`{missingProperty: ${t}}`},pb={keyword:"required",type:"object",schemaType:"array",$data:!0,error:fb,code(t){const{gen:e,schema:n,schemaCode:r,data:s,$data:i,it:o}=t,{opts:a}=o;if(!i&&n.length===0)return;const u=n.length>=a.loopRequired;if(o.allErrors?l():c(),a.strictRequired){const E=t.parentSchema.properties,{definedProperties:v}=t.it;for(const C of n)if((E==null?void 0:E[C])===void 0&&!v.has(C)){const S=o.schemaEnv.baseId+o.errSchemaPath,g=`required property "${C}" is not defined at "${S}" (strictRequired)`;(0,hb.checkStrictMode)(o,g,o.opts.strictRequired)}}function l(){if(u||i)t.block$data(Dr.nil,d);else for(const E of n)(0,Sr.checkReportMissingProp)(t,E)}function c(){const E=e.let("missing");if(u||i){const v=e.let("valid",!0);t.block$data(v,()=>p(E,v)),t.ok(v)}else e.if((0,Sr.checkMissingProp)(t,n,E)),(0,Sr.reportMissingProp)(t,E),e.else()}function d(){e.forOf("prop",r,E=>{t.setParams({missingProperty:E}),e.if((0,Sr.noPropertyInData)(e,s,E,a.ownProperties),()=>t.error())})}function p(E,v){t.setParams({missingProperty:E}),e.forOf(E,r,()=>{e.assign(v,(0,Sr.propertyInData)(e,s,E,a.ownProperties)),e.if((0,Dr.not)(v),()=>{t.error(),e.break()})},Dr.nil)}}};na.default=pb;var ra={};Object.defineProperty(ra,"__esModule",{value:!0});const Pr=le,mb={message({keyword:t,schemaCode:e}){const n=t==="maxItems"?"more":"fewer";return(0,Pr.str)`must NOT have ${n} than ${e} items`},params:({schemaCode:t})=>(0,Pr._)`{limit: ${t}}`},_b={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:mb,code(t){const{keyword:e,data:n,schemaCode:r}=t,s=e==="maxItems"?Pr.operators.GT:Pr.operators.LT;t.fail$data((0,Pr._)`${n}.length ${s} ${r}`)}};ra.default=_b;var sa={},rs={};Object.defineProperty(rs,"__esModule",{value:!0});const jd=vd;jd.code='require("ajv/dist/runtime/equal").default';rs.default=jd;Object.defineProperty(sa,"__esModule",{value:!0});const Ii=ns,Be=le,gb=me,yb=rs,vb={message:({params:{i:t,j:e}})=>(0,Be.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Be._)`{i: ${t}, j: ${e}}`},Eb={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:vb,code(t){const{gen:e,data:n,$data:r,schema:s,parentSchema:i,schemaCode:o,it:a}=t;if(!r&&!s)return;const u=e.let("valid"),l=i.items?(0,Ii.getSchemaTypes)(i.items):[];t.block$data(u,c,(0,Be._)`${o} === false`),t.ok(u);function c(){const v=e.let("i",(0,Be._)`${n}.length`),C=e.let("j");t.setParams({i:v,j:C}),e.assign(u,!0),e.if((0,Be._)`${v} > 1`,()=>(d()?p:E)(v,C))}function d(){return l.length>0&&!l.some(v=>v==="object"||v==="array")}function p(v,C){const S=e.name("item"),g=(0,Ii.checkDataTypes)(l,S,a.opts.strictNumbers,Ii.DataType.Wrong),T=e.const("indices",(0,Be._)`{}`);e.for((0,Be._)`;${v}--;`,()=>{e.let(S,(0,Be._)`${n}[${v}]`),e.if(g,(0,Be._)`continue`),l.length>1&&e.if((0,Be._)`typeof ${S} == "string"`,(0,Be._)`${S} += "_"`),e.if((0,Be._)`typeof ${T}[${S}] == "number"`,()=>{e.assign(C,(0,Be._)`${T}[${S}]`),t.error(),e.assign(u,!1).break()}).code((0,Be._)`${T}[${S}] = ${v}`)})}function E(v,C){const S=(0,gb.useFunc)(e,yb.default),g=e.name("outer");e.label(g).for((0,Be._)`;${v}--;`,()=>e.for((0,Be._)`${C} = ${v}; ${C}--;`,()=>e.if((0,Be._)`${S}(${n}[${v}], ${n}[${C}])`,()=>{t.error(),e.assign(u,!1).break(g)})))}}};sa.default=Eb;var ia={};Object.defineProperty(ia,"__esModule",{value:!0});const eo=le,bb=me,wb=rs,Sb={message:"must be equal to constant",params:({schemaCode:t})=>(0,eo._)`{allowedValue: ${t}}`},Cb={keyword:"const",$data:!0,error:Sb,code(t){const{gen:e,data:n,$data:r,schemaCode:s,schema:i}=t;r||i&&typeof i=="object"?t.fail$data((0,eo._)`!${(0,bb.useFunc)(e,wb.default)}(${n}, ${s})`):t.fail((0,eo._)`${i} !== ${n}`)}};ia.default=Cb;var oa={};Object.defineProperty(oa,"__esModule",{value:!0});const Cr=le,Ib=me,$b=rs,Tb={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,Cr._)`{allowedValues: ${t}}`},Ab={keyword:"enum",schemaType:"array",$data:!0,error:Tb,code(t){const{gen:e,data:n,$data:r,schema:s,schemaCode:i,it:o}=t;if(!r&&s.length===0)throw new Error("enum must have non-empty array");const a=s.length>=o.opts.loopEnum;let u;const l=()=>u!=null?u:u=(0,Ib.useFunc)(e,$b.default);let c;if(a||r)c=e.let("valid"),t.block$data(c,d);else{if(!Array.isArray(s))throw new Error("ajv implementation error");const E=e.const("vSchema",i);c=(0,Cr.or)(...s.map((v,C)=>p(E,C)))}t.pass(c);function d(){e.assign(c,!1),e.forOf("v",i,E=>e.if((0,Cr._)`${l()}(${n}, ${E})`,()=>e.assign(c,!0).break()))}function p(E,v){const C=s[v];return typeof C=="object"&&C!==null?(0,Cr._)`${l()}(${n}, ${E}[${v}])`:(0,Cr._)`${n} === ${C}`}}};oa.default=Ab;Object.defineProperty(Yo,"__esModule",{value:!0});const Rb=Jo,kb=Qo,Nb=Xo,Db=ea,Pb=ta,Ob=na,Mb=ra,Fb=sa,Lb=ia,jb=oa,Ub=[Rb.default,kb.default,Nb.default,Db.default,Pb.default,Ob.default,Mb.default,Fb.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Lb.default,jb.default];Yo.default=Ub;var aa={},ar={};Object.defineProperty(ar,"__esModule",{value:!0});ar.validateAdditionalItems=void 0;const mn=le,to=me,Bb={message:({params:{len:t}})=>(0,mn.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,mn._)`{limit: ${t}}`},xb={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Bb,code(t){const{parentSchema:e,it:n}=t,{items:r}=e;if(!Array.isArray(r)){(0,to.checkStrictMode)(n,'"additionalItems" is ignored when "items" is not an array of schemas');return}Ud(t,r)}};function Ud(t,e){const{gen:n,schema:r,data:s,keyword:i,it:o}=t;o.items=!0;const a=n.const("len",(0,mn._)`${s}.length`);if(r===!1)t.setParams({len:e.length}),t.pass((0,mn._)`${a} <= ${e.length}`);else if(typeof r=="object"&&!(0,to.alwaysValidSchema)(o,r)){const l=n.var("valid",(0,mn._)`${a} <= ${e.length}`);n.if((0,mn.not)(l),()=>u(l)),t.ok(l)}function u(l){n.forRange("i",e.length,a,c=>{t.subschema({keyword:i,dataProp:c,dataPropType:to.Type.Num},l),o.allErrors||n.if((0,mn.not)(l),()=>n.break())})}}ar.validateAdditionalItems=Ud;ar.default=xb;var la={},lr={};Object.defineProperty(lr,"__esModule",{value:!0});lr.validateTuple=void 0;const Jl=le,ws=me,Vb=ae,Hb={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){const{schema:e,it:n}=t;if(Array.isArray(e))return Bd(t,"additionalItems",e);n.items=!0,!(0,ws.alwaysValidSchema)(n,e)&&t.ok((0,Vb.validateArray)(t))}};function Bd(t,e,n=t.schema){const{gen:r,parentSchema:s,data:i,keyword:o,it:a}=t;c(s),a.opts.unevaluated&&n.length&&a.items!==!0&&(a.items=ws.mergeEvaluated.items(r,n.length,a.items));const u=r.name("valid"),l=r.const("len",(0,Jl._)`${i}.length`);n.forEach((d,p)=>{(0,ws.alwaysValidSchema)(a,d)||(r.if((0,Jl._)`${l} > ${p}`,()=>t.subschema({keyword:o,schemaProp:p,dataProp:p},u)),t.ok(u))});function c(d){const{opts:p,errSchemaPath:E}=a,v=n.length,C=v===d.minItems&&(v===d.maxItems||d[e]===!1);if(p.strictTuples&&!C){const S=`"${o}" is ${v}-tuple, but minItems or maxItems/${e} are not specified or different at path "${E}"`;(0,ws.checkStrictMode)(a,S,p.strictTuples)}}}lr.validateTuple=Bd;lr.default=Hb;Object.defineProperty(la,"__esModule",{value:!0});const qb=lr,Wb={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,qb.validateTuple)(t,"items")};la.default=Wb;var ua={};Object.defineProperty(ua,"__esModule",{value:!0});const Ql=le,zb=me,Kb=ae,Gb=ar,Yb={message:({params:{len:t}})=>(0,Ql.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Ql._)`{limit: ${t}}`},Jb={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:Yb,code(t){const{schema:e,parentSchema:n,it:r}=t,{prefixItems:s}=n;r.items=!0,!(0,zb.alwaysValidSchema)(r,e)&&(s?(0,Gb.validateAdditionalItems)(t,s):t.ok((0,Kb.validateArray)(t)))}};ua.default=Jb;var ca={};Object.defineProperty(ca,"__esModule",{value:!0});const it=le,hs=me,Qb={message:({params:{min:t,max:e}})=>e===void 0?(0,it.str)`must contain at least ${t} valid item(s)`:(0,it.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,it._)`{minContains: ${t}}`:(0,it._)`{minContains: ${t}, maxContains: ${e}}`},Xb={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:Qb,code(t){const{gen:e,schema:n,parentSchema:r,data:s,it:i}=t;let o,a;const{minContains:u,maxContains:l}=r;i.opts.next?(o=u===void 0?1:u,a=l):o=1;const c=e.const("len",(0,it._)`${s}.length`);if(t.setParams({min:o,max:a}),a===void 0&&o===0){(0,hs.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&o>a){(0,hs.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,hs.alwaysValidSchema)(i,n)){let C=(0,it._)`${c} >= ${o}`;a!==void 0&&(C=(0,it._)`${C} && ${c} <= ${a}`),t.pass(C);return}i.items=!0;const d=e.name("valid");a===void 0&&o===1?E(d,()=>e.if(d,()=>e.break())):o===0?(e.let(d,!0),a!==void 0&&e.if((0,it._)`${s}.length > 0`,p)):(e.let(d,!1),p()),t.result(d,()=>t.reset());function p(){const C=e.name("_valid"),S=e.let("count",0);E(C,()=>e.if(C,()=>v(S)))}function E(C,S){e.forRange("i",0,c,g=>{t.subschema({keyword:"contains",dataProp:g,dataPropType:hs.Type.Num,compositeRule:!0},C),S()})}function v(C){e.code((0,it._)`${C}++`),a===void 0?e.if((0,it._)`${C} >= ${o}`,()=>e.assign(d,!0).break()):(e.if((0,it._)`${C} > ${a}`,()=>e.assign(d,!1).break()),o===1?e.assign(d,!0):e.if((0,it._)`${C} >= ${o}`,()=>e.assign(d,!0)))}}};ca.default=Xb;var xd={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const e=le,n=me,r=ae;t.error={message:({params:{property:u,depsCount:l,deps:c}})=>{const d=l===1?"property":"properties";return(0,e.str)`must have ${d} ${c} when property ${u} is present`},params:({params:{property:u,depsCount:l,deps:c,missingProperty:d}})=>(0,e._)`{property: ${u},
    missingProperty: ${d},
    depsCount: ${l},
    deps: ${c}}`};const s={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(u){const[l,c]=i(u);o(u,l),a(u,c)}};function i({schema:u}){const l={},c={};for(const d in u){if(d==="__proto__")continue;const p=Array.isArray(u[d])?l:c;p[d]=u[d]}return[l,c]}function o(u,l=u.schema){const{gen:c,data:d,it:p}=u;if(Object.keys(l).length===0)return;const E=c.let("missing");for(const v in l){const C=l[v];if(C.length===0)continue;const S=(0,r.propertyInData)(c,d,v,p.opts.ownProperties);u.setParams({property:v,depsCount:C.length,deps:C.join(", ")}),p.allErrors?c.if(S,()=>{for(const g of C)(0,r.checkReportMissingProp)(u,g)}):(c.if((0,e._)`${S} && (${(0,r.checkMissingProp)(u,C,E)})`),(0,r.reportMissingProp)(u,E),c.else())}}t.validatePropertyDeps=o;function a(u,l=u.schema){const{gen:c,data:d,keyword:p,it:E}=u,v=c.name("valid");for(const C in l)(0,n.alwaysValidSchema)(E,l[C])||(c.if((0,r.propertyInData)(c,d,C,E.opts.ownProperties),()=>{const S=u.subschema({keyword:p,schemaProp:C},v);u.mergeValidEvaluated(S,v)},()=>c.var(v,!0)),u.ok(v))}t.validateSchemaDeps=a,t.default=s})(xd);var da={};Object.defineProperty(da,"__esModule",{value:!0});const Vd=le,Zb=me,ew={message:"property name must be valid",params:({params:t})=>(0,Vd._)`{propertyName: ${t.propertyName}}`},tw={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:ew,code(t){const{gen:e,schema:n,data:r,it:s}=t;if((0,Zb.alwaysValidSchema)(s,n))return;const i=e.name("valid");e.forIn("key",r,o=>{t.setParams({propertyName:o}),t.subschema({keyword:"propertyNames",data:o,dataTypes:["string"],propertyName:o,compositeRule:!0},i),e.if((0,Vd.not)(i),()=>{t.error(!0),s.allErrors||e.break()})}),t.ok(i)}};da.default=tw;var ii={};Object.defineProperty(ii,"__esModule",{value:!0});const fs=ae,ct=le,nw=Rt,ps=me,rw={message:"must NOT have additional properties",params:({params:t})=>(0,ct._)`{additionalProperty: ${t.additionalProperty}}`},sw={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:rw,code(t){const{gen:e,schema:n,parentSchema:r,data:s,errsCount:i,it:o}=t;if(!i)throw new Error("ajv implementation error");const{allErrors:a,opts:u}=o;if(o.props=!0,u.removeAdditional!=="all"&&(0,ps.alwaysValidSchema)(o,n))return;const l=(0,fs.allSchemaProperties)(r.properties),c=(0,fs.allSchemaProperties)(r.patternProperties);d(),t.ok((0,ct._)`${i} === ${nw.default.errors}`);function d(){e.forIn("key",s,S=>{!l.length&&!c.length?v(S):e.if(p(S),()=>v(S))})}function p(S){let g;if(l.length>8){const T=(0,ps.schemaRefOrVal)(o,r.properties,"properties");g=(0,fs.isOwnProperty)(e,T,S)}else l.length?g=(0,ct.or)(...l.map(T=>(0,ct._)`${S} === ${T}`)):g=ct.nil;return c.length&&(g=(0,ct.or)(g,...c.map(T=>(0,ct._)`${(0,fs.usePattern)(t,T)}.test(${S})`))),(0,ct.not)(g)}function E(S){e.code((0,ct._)`delete ${s}[${S}]`)}function v(S){if(u.removeAdditional==="all"||u.removeAdditional&&n===!1){E(S);return}if(n===!1){t.setParams({additionalProperty:S}),t.error(),a||e.break();return}if(typeof n=="object"&&!(0,ps.alwaysValidSchema)(o,n)){const g=e.name("valid");u.removeAdditional==="failing"?(C(S,g,!1),e.if((0,ct.not)(g),()=>{t.reset(),E(S)})):(C(S,g),a||e.if((0,ct.not)(g),()=>e.break()))}}function C(S,g,T){const A={keyword:"additionalProperties",dataProp:S,dataPropType:ps.Type.Str};T===!1&&Object.assign(A,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(A,g)}}};ii.default=sw;var ha={};Object.defineProperty(ha,"__esModule",{value:!0});const iw=_t,Xl=ae,$i=me,Zl=ii,ow={keyword:"properties",type:"object",schemaType:"object",code(t){const{gen:e,schema:n,parentSchema:r,data:s,it:i}=t;i.opts.removeAdditional==="all"&&r.additionalProperties===void 0&&Zl.default.code(new iw.KeywordCxt(i,Zl.default,"additionalProperties"));const o=(0,Xl.allSchemaProperties)(n);for(const d of o)i.definedProperties.add(d);i.opts.unevaluated&&o.length&&i.props!==!0&&(i.props=$i.mergeEvaluated.props(e,(0,$i.toHash)(o),i.props));const a=o.filter(d=>!(0,$i.alwaysValidSchema)(i,n[d]));if(a.length===0)return;const u=e.name("valid");for(const d of a)l(d)?c(d):(e.if((0,Xl.propertyInData)(e,s,d,i.opts.ownProperties)),c(d),i.allErrors||e.else().var(u,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(u);function l(d){return i.opts.useDefaults&&!i.compositeRule&&n[d].default!==void 0}function c(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},u)}}};ha.default=ow;var fa={};Object.defineProperty(fa,"__esModule",{value:!0});const eu=ae,ms=le,tu=me,nu=me,aw={keyword:"patternProperties",type:"object",schemaType:"object",code(t){const{gen:e,schema:n,data:r,parentSchema:s,it:i}=t,{opts:o}=i,a=(0,eu.allSchemaProperties)(n),u=a.filter(C=>(0,tu.alwaysValidSchema)(i,n[C]));if(a.length===0||u.length===a.length&&(!i.opts.unevaluated||i.props===!0))return;const l=o.strictSchema&&!o.allowMatchingProperties&&s.properties,c=e.name("valid");i.props!==!0&&!(i.props instanceof ms.Name)&&(i.props=(0,nu.evaluatedPropsToName)(e,i.props));const{props:d}=i;p();function p(){for(const C of a)l&&E(C),i.allErrors?v(C):(e.var(c,!0),v(C),e.if(c))}function E(C){for(const S in l)new RegExp(C).test(S)&&(0,tu.checkStrictMode)(i,`property ${S} matches pattern ${C} (use allowMatchingProperties)`)}function v(C){e.forIn("key",r,S=>{e.if((0,ms._)`${(0,eu.usePattern)(t,C)}.test(${S})`,()=>{const g=u.includes(C);g||t.subschema({keyword:"patternProperties",schemaProp:C,dataProp:S,dataPropType:nu.Type.Str},c),i.opts.unevaluated&&d!==!0?e.assign((0,ms._)`${d}[${S}]`,!0):!g&&!i.allErrors&&e.if((0,ms.not)(c),()=>e.break())})})}}};fa.default=aw;var pa={};Object.defineProperty(pa,"__esModule",{value:!0});const lw=me,uw={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){const{gen:e,schema:n,it:r}=t;if((0,lw.alwaysValidSchema)(r,n)){t.fail();return}const s=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),t.failResult(s,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};pa.default=uw;var ma={};Object.defineProperty(ma,"__esModule",{value:!0});const cw=ae,dw={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:cw.validateUnion,error:{message:"must match a schema in anyOf"}};ma.default=dw;var _a={};Object.defineProperty(_a,"__esModule",{value:!0});const Ss=le,hw=me,fw={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,Ss._)`{passingSchemas: ${t.passing}}`},pw={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:fw,code(t){const{gen:e,schema:n,parentSchema:r,it:s}=t;if(!Array.isArray(n))throw new Error("ajv implementation error");if(s.opts.discriminator&&r.discriminator)return;const i=n,o=e.let("valid",!1),a=e.let("passing",null),u=e.name("_valid");t.setParams({passing:a}),e.block(l),t.result(o,()=>t.reset(),()=>t.error(!0));function l(){i.forEach((c,d)=>{let p;(0,hw.alwaysValidSchema)(s,c)?e.var(u,!0):p=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},u),d>0&&e.if((0,Ss._)`${u} && ${o}`).assign(o,!1).assign(a,(0,Ss._)`[${a}, ${d}]`).else(),e.if(u,()=>{e.assign(o,!0),e.assign(a,d),p&&t.mergeEvaluated(p,Ss.Name)})})}}};_a.default=pw;var ga={};Object.defineProperty(ga,"__esModule",{value:!0});const mw=me,_w={keyword:"allOf",schemaType:"array",code(t){const{gen:e,schema:n,it:r}=t;if(!Array.isArray(n))throw new Error("ajv implementation error");const s=e.name("valid");n.forEach((i,o)=>{if((0,mw.alwaysValidSchema)(r,i))return;const a=t.subschema({keyword:"allOf",schemaProp:o},s);t.ok(s),t.mergeEvaluated(a)})}};ga.default=_w;var ya={};Object.defineProperty(ya,"__esModule",{value:!0});const Hs=le,Hd=me,gw={message:({params:t})=>(0,Hs.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,Hs._)`{failingKeyword: ${t.ifClause}}`},yw={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:gw,code(t){const{gen:e,parentSchema:n,it:r}=t;n.then===void 0&&n.else===void 0&&(0,Hd.checkStrictMode)(r,'"if" without "then" and "else" is ignored');const s=ru(r,"then"),i=ru(r,"else");if(!s&&!i)return;const o=e.let("valid",!0),a=e.name("_valid");if(u(),t.reset(),s&&i){const c=e.let("ifClause");t.setParams({ifClause:c}),e.if(a,l("then",c),l("else",c))}else s?e.if(a,l("then")):e.if((0,Hs.not)(a),l("else"));t.pass(o,()=>t.error(!0));function u(){const c=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(c)}function l(c,d){return()=>{const p=t.subschema({keyword:c},a);e.assign(o,a),t.mergeValidEvaluated(p,o),d?e.assign(d,(0,Hs._)`${c}`):t.setParams({ifClause:c})}}}};function ru(t,e){const n=t.schema[e];return n!==void 0&&!(0,Hd.alwaysValidSchema)(t,n)}ya.default=yw;var va={};Object.defineProperty(va,"__esModule",{value:!0});const vw=me,Ew={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:n}){e.if===void 0&&(0,vw.checkStrictMode)(n,`"${t}" without "if" is ignored`)}};va.default=Ew;Object.defineProperty(aa,"__esModule",{value:!0});const bw=ar,ww=la,Sw=lr,Cw=ua,Iw=ca,$w=xd,Tw=da,Aw=ii,Rw=ha,kw=fa,Nw=pa,Dw=ma,Pw=_a,Ow=ga,Mw=ya,Fw=va;function Lw(t=!1){const e=[Nw.default,Dw.default,Pw.default,Ow.default,Mw.default,Fw.default,Tw.default,Aw.default,$w.default,Rw.default,kw.default];return t?e.push(ww.default,Cw.default):e.push(bw.default,Sw.default),e.push(Iw.default),e}aa.default=Lw;var Ea={},ba={};Object.defineProperty(ba,"__esModule",{value:!0});const Oe=le,jw={message:({schemaCode:t})=>(0,Oe.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,Oe._)`{format: ${t}}`},Uw={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:jw,code(t,e){const{gen:n,data:r,$data:s,schema:i,schemaCode:o,it:a}=t,{opts:u,errSchemaPath:l,schemaEnv:c,self:d}=a;if(!u.validateFormats)return;s?p():E();function p(){const v=n.scopeValue("formats",{ref:d.formats,code:u.code.formats}),C=n.const("fDef",(0,Oe._)`${v}[${o}]`),S=n.let("fType"),g=n.let("format");n.if((0,Oe._)`typeof ${C} == "object" && !(${C} instanceof RegExp)`,()=>n.assign(S,(0,Oe._)`${C}.type || "string"`).assign(g,(0,Oe._)`${C}.validate`),()=>n.assign(S,(0,Oe._)`"string"`).assign(g,C)),t.fail$data((0,Oe.or)(T(),A()));function T(){return u.strictSchema===!1?Oe.nil:(0,Oe._)`${o} && !${g}`}function A(){const O=c.$async?(0,Oe._)`(${C}.async ? await ${g}(${r}) : ${g}(${r}))`:(0,Oe._)`${g}(${r})`,L=(0,Oe._)`(typeof ${g} == "function" ? ${O} : ${g}.test(${r}))`;return(0,Oe._)`${g} && ${g} !== true && ${S} === ${e} && !${L}`}}function E(){const v=d.formats[i];if(!v){T();return}if(v===!0)return;const[C,S,g]=A(v);C===e&&t.pass(O());function T(){if(u.strictSchema===!1){d.logger.warn(L());return}throw new Error(L());function L(){return`unknown format "${i}" ignored in schema at path "${l}"`}}function A(L){const $=L instanceof RegExp?(0,Oe.regexpCode)(L):u.code.formats?(0,Oe._)`${u.code.formats}${(0,Oe.getProperty)(i)}`:void 0,N=n.scopeValue("formats",{key:i,ref:L,code:$});return typeof L=="object"&&!(L instanceof RegExp)?[L.type||"string",L.validate,(0,Oe._)`${N}.validate`]:["string",L,N]}function O(){if(typeof v=="object"&&!(v instanceof RegExp)&&v.async){if(!c.$async)throw new Error("async format in sync schema");return(0,Oe._)`await ${g}(${r})`}return typeof S=="function"?(0,Oe._)`${g}(${r})`:(0,Oe._)`${g}.test(${r})`}}}};ba.default=Uw;Object.defineProperty(Ea,"__esModule",{value:!0});const Bw=ba,xw=[Bw.default];Ea.default=xw;var tr={};Object.defineProperty(tr,"__esModule",{value:!0});tr.contentVocabulary=tr.metadataVocabulary=void 0;tr.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];tr.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(zo,"__esModule",{value:!0});const Vw=Ko,Hw=Yo,qw=aa,Ww=Ea,su=tr,zw=[Vw.default,Hw.default,(0,qw.default)(),Ww.default,su.metadataVocabulary,su.contentVocabulary];zo.default=zw;var wa={},qd={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DiscrError=void 0,function(e){e.Tag="tag",e.Mapping="mapping"}(t.DiscrError||(t.DiscrError={}))})(qd);Object.defineProperty(wa,"__esModule",{value:!0});const xn=le,no=qd,iu=Ze,Kw=me,Gw={message:({params:{discrError:t,tagName:e}})=>t===no.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:n}})=>(0,xn._)`{error: ${t}, tag: ${n}, tagValue: ${e}}`},Yw={keyword:"discriminator",type:"object",schemaType:"object",error:Gw,code(t){const{gen:e,data:n,schema:r,parentSchema:s,it:i}=t,{oneOf:o}=s;if(!i.opts.discriminator)throw new Error("discriminator: requires discriminator option");const a=r.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(r.mapping)throw new Error("discriminator: mapping is not supported");if(!o)throw new Error("discriminator: requires oneOf keyword");const u=e.let("valid",!1),l=e.const("tag",(0,xn._)`${n}${(0,xn.getProperty)(a)}`);e.if((0,xn._)`typeof ${l} == "string"`,()=>c(),()=>t.error(!1,{discrError:no.DiscrError.Tag,tag:l,tagName:a})),t.ok(u);function c(){const E=p();e.if(!1);for(const v in E)e.elseIf((0,xn._)`${l} === ${v}`),e.assign(u,d(E[v]));e.else(),t.error(!1,{discrError:no.DiscrError.Mapping,tag:l,tagName:a}),e.endIf()}function d(E){const v=e.name("valid"),C=t.subschema({keyword:"oneOf",schemaProp:E},v);return t.mergeEvaluated(C,xn.Name),v}function p(){var E;const v={},C=g(s);let S=!0;for(let O=0;O<o.length;O++){let L=o[O];(L==null?void 0:L.$ref)&&!(0,Kw.schemaHasRulesButRef)(L,i.self.RULES)&&(L=iu.resolveRef.call(i.self,i.schemaEnv.root,i.baseId,L==null?void 0:L.$ref),L instanceof iu.SchemaEnv&&(L=L.schema));const $=(E=L==null?void 0:L.properties)===null||E===void 0?void 0:E[a];if(typeof $!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);S=S&&(C||g(L)),T($,O)}if(!S)throw new Error(`discriminator: "${a}" must be required`);return v;function g({required:O}){return Array.isArray(O)&&O.includes(a)}function T(O,L){if(O.const)A(O.const,L);else if(O.enum)for(const $ of O.enum)A($,L);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function A(O,L){if(typeof O!="string"||O in v)throw new Error(`discriminator: "${a}" values must be unique strings`);v[O]=L}}}};wa.default=Yw;const Jw="http://json-schema.org/draft-07/schema#",Qw="http://json-schema.org/draft-07/schema#",Xw="Core schema meta-schema",Zw={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},eS=["object","boolean"],tS={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}};var nS={$schema:Jw,$id:Qw,title:Xw,definitions:Zw,type:eS,properties:tS,default:!0};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;const n=dd,r=zo,s=wa,i=nS,o=["/properties"],a="http://json-schema.org/draft-07/schema";class u extends n.default{_addVocabularies(){super._addVocabularies(),r.default.forEach(p=>this.addVocabulary(p)),this.opts.discriminator&&this.addKeyword(s.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const p=this.opts.$data?this.$dataMetaSchema(i,o):i;this.addMetaSchema(p,a,!1),this.refs["http://json-schema.org/schema"]=a}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(a)?a:void 0)}}t.exports=e=u,Object.defineProperty(e,"__esModule",{value:!0}),e.default=u;var l=_t;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return l.KeywordCxt}});var c=le;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return c._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return c.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return c.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return c.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return c.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return c.CodeGen}})})(Ji,Ji.exports);var rS=gh(Ji.exports);const sS={apiKey:"AIzaSyAol1ODwjgfiVeR0NaKHaR_sXsT-w6MK8c",authDomain:"early-intervention.firebaseapp.com",databaseURL:"https://early-intervention-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"early-intervention",storageBucket:"early-intervention.appspot.com",messagingSenderId:"381334006605",appId:"1:381334006605:web:4c91e366ddc604c3102504",measurementId:"G-91ED17B6NQ"};Nm(sS);const iS=Ng();g_(iS).then(t=>{}).catch(t=>{t.code,t.message,console.log(t.code+":"+t.message)});new rS;let Ti=null;async function Wd(){return Ti||(Ti=await(await fetch("https://next-early-intervention.vercel.app/api/setting")).json()),Ti}function oS(t){return fetch("https://next-early-intervention.vercel.app/api/registration_date?date="+t).then(function(e){return e.json()}).then(function(e){return e})}async function aS(t){return await fetch("https://next-early-intervention.vercel.app/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}const lS=b("h5",null,"6.\u9001\u51FA\u5831\u540D\u8CC7\u6599",-1),uS=oe(" \u8ACB\u78BA\u8A8D\u4EE5\u4E0B\u8CC7\u8A0A\uFF0C\u78BA\u8A8D\u597D\u5F8C\u6309\u4E0B\u9001\u51FA\u5373\u53EF\u5831\u540D\u3002 "),cS=b("td",null,"\u5152\u7AE5\u59D3\u540D",-1),dS=b("td",null,"\u5152\u7AE5\u5E74\u9F61",-1),hS=b("td",null,"\u5152\u7AE5\u8EAB\u5206\u8B49\u865F",-1),fS=b("td",null,"\u5BB6\u9577\u96FB\u8A71",-1),pS=b("td",null,"\u5BB6\u9577\u95DC\u4FC2",-1),mS=b("td",null,"\u5C31\u8A3A\u554F\u984C",-1),_S=b("td",null,"\u4E0A\u6B21\u8A55\u4F30",-1),gS=b("td",null,"\u4E0A\u6B21\u8A55\u4F30\u65E5\u671F",-1),yS=b("td",null,"\u4E0A\u6B21\u5EFA\u8B70\u8A55\u4F30\u65E5\u671F",-1),vS=b("tr",null,[b("td",{colspan:"2"},"\u5099\u8A3B\uFF1A")],-1),ES={colspan:"2"},bS=gt({__name:"EndPage",props:{jsondata:null},setup(t){const e=t,n=ot(e.jsondata.registrationDate);e.jsondata.registrationDate;const r=n.year()-1911+n.format("\u5E74 MM\u6708 DD\u65E5"),s=_e("\u9001\u51FA"),i=_e("");function o(l){s.value=="\u9001\u51FA"&&(s.value="\u9001\u51FA\u4E2D",a(e.jsondata))}function a(l){l.userRelationshipOther||(l.userRelationshipOther=""),l.questionsAbouts||(l.questionsAbouts=""),l.previousAssessment||(l.previousAssessment=""),l.lastEvaluate||(l.lastEvaluate=""),l.SuggestEvaluate||(l.SuggestEvaluate=""),l.comment=i.value,aS(l).then(async c=>{if(c.status!=200){alert(JSON.stringify(await c.json())),s.value="\u932F\u8AA4\uFF0C\u5831\u540D\u5931\u6557";return}const d=`\u5831\u540D\u5B8C\u6210\u3002\u9810\u8A08\u770B\u8A3A\u65E5\u671F\u70BA ${r}\uFF0C\u7D93\u7CFB\u7D71\u5831\u540D\u6210\u529F\u4E0D\u7B49\u65BC\u639B\u865F\u6210\u529F\uFF0C\u7D93\u672C\u9662\u78BA\u8A8D\u8EAB\u4EFD\u8CC7\u683C\u7B26\u5408\u8A55\u4F30\u8CC7\u683C\u5F8C\uFF0C\u6703\u518D\u4EE5\u96FB\u8A71\u901A\u77E5\u3002
    
\u672A\u63A5\u5230\u96FB\u8A71\u901A\u77E5\u5373\u4E0D\u7B26\u5408\u770B\u8A3A\u8CC7\u683C\uFF0C\u8ACB\u52FF\u64C5\u81EA\u524D\u4F86\u770B\u8A3A\uFF0C\u4EE5\u514D\u767D\u8DD1\u4E00\u8D9F\u3002`;s.value="\u6210\u529F",alert(d),window.location.reload()})}function u(l){return l>360?Math.floor(l/360)+"\u6B72"+Math.floor(l%360/30)+"\u500B\u6708":Math.floor(l%360/30)+"\u500B\u6708"}return(l,c)=>(Q(),ie("table",null,[lS,uS,b("tr",null,[cS,b("td",null,ke(e.jsondata.childName),1)]),b("tr",null,[dS,b("td",null,ke(u(e.jsondata.kidday)),1)]),b("tr",null,[hS,b("td",null,ke(e.jsondata.identityNumber),1)]),b("tr",null,[fS,b("td",null,ke(e.jsondata.phoneNumber),1)]),b("tr",null,[pS,b("td",null,ke(e.jsondata.userRelationship||e.jsondata.userRelationshipOther),1)]),b("tr",null,[mS,b("td",null,ke(e.jsondata.questionsAbouts),1)]),b("tr",null,[_S,b("td",null,ke(e.jsondata.previousAssessment),1)]),b("tr",null,[gS,b("td",null,ke(e.jsondata.lastEvaluate),1)]),b("tr",null,[yS,b("td",null,ke(e.jsondata.SuggestEvaluate),1)]),vS,b("tr",null,[b("td",ES,[Dt(b("textarea",{class:"form-control",rows:"3",style:{width:"100%"},"onUpdate:modelValue":c[0]||(c[0]=d=>i.value=d)},null,512),[[ro,i.value]])])]),b("button",{type:"button",class:"btn btn-primary",onClick:o},ke(s.value),1)]))}});const wS=["onSubmit"],SS=b("h1",null,"\u5152\u7AE5\u767C\u5C55\u8A55\u4F30\u5831\u540D\u7CFB\u7D71",-1),CS=oe(" \u6B63\u78BA\u5E74\u9F61\u8A08\u7B97\u65B9\u5F0F\uFF1A"),IS=b("br",null,null,-1),$S=oe(" \u300C\u5BE6\u8DB3\u5E74\u9F61\u300D\uFF1A\u300C\u65BD\u6E2C\u65E5\u671F - \u51FA\u751F\u65E5\u671F = \u5BE6\u8DB3\u5E74\u9F61\u300D"),TS=b("br",null,null,-1),AS=oe(" \uFF0A\u65E9\u7522\u5152\u4E8C\u6B72\u524D\u5EFA\u8B70\u4EE5\u9810\u7522\u671F\u4EE3\u66FF\u51FA\u751F\u65E5\u671F\u8A08\u7B97"),RS=b("br",null,null,-1),kS={class:"kidBirthdayFrom"},NS=oe(" \u8ACB\u9078\u64C7\u60A8\u7684\u5BF6\u8C9D\u51FA\u751F\u65E5\u671F\u9032\u884C\u6AA2\u6E2C\uFF1A"),DS=b("br",null,null,-1),PS={class:"form-label"},OS=b("br",null,null,-1),MS={key:0,class:"col-md-12"},FS=b("div",{class:"alert alert-warning"},[oe(" \u5E74\u9F61\u4E0D\u7B26\u5408\u672C\u9662\u770B\u8A3A\u689D\u4EF6\uFF0C\u82E5\u4ECD\u9700\u8981\u672C\u9662\u5C31\u8A3A\uFF0C\u5EFA\u8B70\u8F49\u8A3A\u81F3\u4EE5\u4E0B\u79D1\u5225\uFF1A"),b("br"),oe(" \u52D5\u4F5C\u3001\u8A9E\u8A00\u985E\u767C\u5C55\u554F\u984C \u2192 \u8ACB\u639B "),b("a",{href:"https://register.vghtc.gov.tw/register/listDoctor.jsp?init=init&section=REHA"},"\u5FA9\u5065\u79D1"),b("br"),oe(" \u8A8D\u77E5\u3001\u4EBA\u969B\u3001\u60C5\u7DD2\u3001\u5C08\u6CE8\u529B\u3001\u904E\u52D5\u7B49 \u2192 \u8ACB\u639B"),b("a",{href:"https://register.vghtc.gov.tw/register/listDoctor.jsp?init=init&section=PSYC"},"\u5152\u7AE5\u5FC3\u667A\u79D1")],-1),LS=[FS],jS={key:1,class:"btn btn-primary",type:"submit"},US=b("br",null,null,-1),BS=gt({__name:"UserFrom0",props:{disabled:{type:Boolean}},emits:["kidBirthdayChange","submit"],setup(t,{emit:e}){const n=_e(ot("2022-07-01").add(-106,"day")),r=_e(ot("2016-01-01").add(-106,"day"));_e(r.value.format("YYYY\u5E74MM\u6708DD\u65E5")),_e(n.value.format("YYYY\u5E74MM\u6708DD\u65E5")),_e(r.value.format("YYYY\u5E74MM\u6708DD\u65E5")),_e(n.value.format("YYYY\u5E74MM\u6708DD\u65E5")),_e(n.value.format("YYYY\u5E74MM\u6708DD\u65E5"));const s=_e(ot().format("YYYY-MM-DD")),i=ai(()=>Math.floor(ot().diff(s.value)/(1e3*60*60*24))),o=ai(()=>ot(s.value)),a=ai(()=>(i.value>360?Math.floor(i.value/360)+"\u5E74":"")+(i.value>30?Math.floor(i.value%360/30)+"\u500B\u6708":"")+(i.value>0?i.value%360%30+"\u5929":"")),u=_e(null);function l(c){e("kidBirthdayChange",o.value),u.value=o.value.isBefore(n.value)&&o.value.isAfter(r.value),e("submit",Object.assign({},Hr(c),{kidday:i.value}),u.value)}return(c,d)=>(Q(),ie(Je,null,[b("form",{id:"from",onSubmit:Vr(l,["prevent"])},[SS,CS,IS,$S,TS,AS,RS,b("div",kS,[NS,DS,b("label",PS,[Dt(b("input",{type:"date",class:"form-control",name:"kidBirthday","onUpdate:modelValue":d[0]||(d[0]=p=>s.value=p),required:""},null,512),[[ro,s.value]])]),OS,oe(" \u8A66\u7B97\u7D50\u679C\uFF1A"+ke(Qt(a)),1)]),u.value===!1?(Q(),ie("div",MS,LS)):Ne("",!0),u.value?Ne("",!0):(Q(),ie("button",jS,"\u78BA\u8A8D"))],40,wS),US],64))}});const xS={key:0,class:"text-center"},VS=b("div",{class:"spinner-border",role:"status"},[b("span",{class:"visually-hidden"},"Loading...")],-1),HS=[VS],qS={key:1,class:"tablebox"},WS={key:1,style:{"white-space":"nowrap",color:"red"}},zS=b("br",null,null,-1),ou=gt({__name:"RegistrationTime",props:{dateStr:null,special:{type:Boolean}},emits:["submit"],setup(t,{emit:e}){const n=t,r=ot(n.dateStr),s=n.dateStr,i=r.year()-1911+r.format(".MM.DD"),o=_e(0),a=_e(-1),u=_e(!0),l=au(()=>o.value>=a.value);Promise.all([Wd(),oS(s)]).then(([d,p])=>{p||(p={}),p=Object.fromEntries(Object.entries(p).filter(([C,S])=>S.doctorAppointment!=="\u8CC7\u683C\u4E0D\u7B26"));let E=Object.values(p).filter(C=>C.kidday<360*3).length,v=Object.keys(p).length-E;n.special?(o.value=v+E,a.value=d.quota+d.specialQuota):(o.value=v+Math.max(E-d.specialQuota,0),a.value=d.quota),u.value=!1});function c(){e("submit",n.dateStr)}return(d,p)=>(Q(),ie(Je,null,[u.value?(Q(),ie("div",xS,HS)):Ne("",!0),u.value?Ne("",!0):(Q(),ie("tr",qS,[b("td",null,[Qt(l)?Ne("",!0):(Q(),ie("a",{key:0,class:"red",onclick:c,style:{"white-space":"nowrap"}},"\u3010\u5831\u540D\u3011")),Qt(l)?(Q(),ie("a",WS,"\u5831\u540D\u984D\u6EFF")):Ne("",!0)]),b("td",null,[oe(ke(i)),zS,oe("\u5DF2\u639B\u4EBA\u6578\uFF1A"+ke(o.value+"/"+a.value),1)])]))],64))}});const KS=b("h5",null,"\u9078\u64C7\u770B\u8A3A\u65E5\u671F",-1),GS={class:"table table-sm"},YS={class:"weekhead"},JS=b("th",null,[oe("\u661F\u671F/"),b("br"),oe("\u5348\u5225")],-1),QS={class:"weekbody"},XS=b("th",{class:"weekside"},[oe("\u4E0A\u5348"),b("br"),oe("08:30"),b("br"),oe("~"),b("br"),oe("12:00")],-1),ZS=b("th",{class:"weekside"},[oe("\u4E0B\u5348"),b("br"),oe("13:30"),b("br"),oe("~"),b("br"),oe("17:00")],-1),eC=b("br",null,null,-1),tC=gt({__name:"RegistrationFrom",props:{jsondata:null},emits:["submit"],setup(t,{emit:e}){const r=_e(t.jsondata.kidday<360*3),s=["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],i=_e([[[],[],[],[],[],[],[]],[[],[],[],[],[],[],[]]]);Wd().then(u=>{console.log(u),o(u.dayofweek,u.minday,u.maxday)});function o(u,l,c){let d=ot().add(l,"day");for(let p=l;p<c;p++)d.day()==u&&i.value[0][u].push(d),d=d.add(1,"day")}function a(u){e("submit",{registrationDate:u},!0)}return(u,l)=>(Q(),ie(Je,null,[KS,b("table",GS,[b("thead",YS,[b("tr",null,[JS,(Q(!0),ie(Je,null,dt(s.slice(1),c=>(Q(),ie("th",null,"\u661F\u671F"+ke(c),1))),256)),b("th",null,"\u661F\u671F"+ke(s[0]),1)])]),b("tbody",QS,[b("tr",null,[XS,(Q(!0),ie(Je,null,dt(i.value[0].slice(1),(c,d,p)=>(Q(),ie("td",null,[(Q(!0),ie(Je,null,dt(c,E=>(Q(),St(ou,{dateStr:E.format("YYYY-MM-DD"),onSubmit:a,special:r.value},null,8,["dateStr","special"]))),256))]))),256)),(Q(!0),ie(Je,null,dt([i.value[0][0]],(c,d,p)=>(Q(),ie("td",null,[(Q(!0),ie(Je,null,dt(c,E=>(Q(),St(ou,{dateStr:E.format("YYYY-MM-DD"),onSubmit:a,special:r.value},null,8,["dateStr","special"]))),256))]))),256))]),b("tr",null,[ZS,(Q(),ie(Je,null,dt(s,c=>b("td")),64))])])]),eC],64))}}),nC=b("br",null,null,-1),rC=b("br",null,null,-1),oC=gt({__name:"UserView",setup(t){const e=_e(-1),n=_e("");function r(a){n.value=a.format("YYYY-MM-DD")}const s=_e(""),i={};function o(a,u){if(!!u){if(e.value==1&&(!a.questionsAbouts||a.questionsAbouts.split("|").length<=1)){fh.push("SuggestReferral");return}e.value+=1;for(const l of Object.keys(a))i[l]=a[l];s.value=JSON.stringify(i,null,2)}}return(a,u)=>(Q(),ie("div",null,[nC,hh(_h),e.value==-10?(Q(),St(_p,{key:0})):Ne("",!0),e.value==-1?(Q(),St(BS,{key:1,disabled:e.value!=-1,onSubmit:o,onKidBirthdayChange:r},null,8,["disabled"])):Ne("",!0),e.value==0?(Q(),St(tC,{key:2,onSubmit:o,jsondata:Qt(i)},null,8,["jsondata"])):Ne("",!0),e.value==1?(Q(),St(qh,{key:3,disabled:e.value!=1,onSubmit:o},null,8,["disabled"])):Ne("",!0),e.value==2?(Q(),St(Cf,{key:4,disabled:e.value!=2,onSubmit:o},null,8,["disabled"])):Ne("",!0),e.value==3?(Q(),St(xf,{key:5,disabled:e.value!=3,onSubmit:o},null,8,["disabled"])):Ne("",!0),e.value==4?(Q(),St(lp,{key:6,disabled:e.value!=4,onSubmit:o,"kid-birthday":n.value},null,8,["disabled","kid-birthday"])):Ne("",!0),e.value==5?(Q(),St(bS,{key:7,jsondata:Qt(i)},null,8,["jsondata"])):Ne("",!0),rC]))}});export{oC as default};
//# sourceMappingURL=UserView.868601b9.js.map
